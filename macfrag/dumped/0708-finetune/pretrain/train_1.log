INFO - 07/08/25 17:44:44 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 17:44:44 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/tara/group-graph-testing/group-graph/dataset/class_task/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/tara/group-graph-testing/group-graph/dataset/class_task/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 17:44:44 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 17:44:44 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 17:44:44 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 17:44:44 - 0:00:00 - Loading data
INFO - 07/08/25 18:27:46 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 18:27:46 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 18:27:46 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 18:27:46 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 18:27:46 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 18:27:46 - 0:00:00 - Loading data
DEBUG - 07/08/25 18:27:47 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 18:27:47 - 0:00:00 - Building model 0
INFO - 07/08/25 18:41:43 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 18:41:43 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 18:41:43 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 18:41:43 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 18:41:43 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 18:41:43 - 0:00:00 - Loading data
DEBUG - 07/08/25 18:41:43 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 18:41:43 - 0:00:00 - Building model 0
INFO - 07/08/25 18:46:33 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 18:46:33 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 18:46:33 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 18:46:33 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 18:46:33 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 18:46:33 - 0:00:00 - Loading data
DEBUG - 07/08/25 18:46:34 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 18:46:34 - 0:00:00 - Building model 0
DEBUG - 07/08/25 18:46:35 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 18:46:35 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 18:46:35 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 18:46:35 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 18:46:35 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 18:46:35 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 18:46:35 - 0:00:02 - Epoch 0
INFO - 07/08/25 18:47:54 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 18:47:54 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 18:47:54 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 18:47:54 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 18:47:54 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 18:47:54 - 0:00:00 - Loading data
DEBUG - 07/08/25 18:47:55 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 18:47:55 - 0:00:00 - Building model 0
DEBUG - 07/08/25 18:47:56 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 18:47:56 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 18:47:56 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 18:47:56 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 18:47:56 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 18:47:56 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 18:47:56 - 0:00:02 - Epoch 0
INFO - 07/08/25 18:49:01 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 18:49:01 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 18:49:01 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 18:49:01 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 18:49:01 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 18:49:01 - 0:00:00 - Loading data
DEBUG - 07/08/25 18:49:01 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 18:49:01 - 0:00:00 - Building model 0
INFO - 07/08/25 18:49:23 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 18:49:23 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 18:49:23 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 18:49:23 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 18:49:23 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 18:49:23 - 0:00:00 - Loading data
DEBUG - 07/08/25 18:49:23 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 18:49:23 - 0:00:00 - Building model 0
INFO - 07/08/25 18:52:31 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 18:52:31 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 18:52:31 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 18:52:31 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 18:52:31 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 18:52:31 - 0:00:00 - Loading data
DEBUG - 07/08/25 18:52:32 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 18:52:32 - 0:00:00 - Building model 0
DEBUG - 07/08/25 18:52:33 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 18:52:33 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 18:52:33 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 18:52:33 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 18:52:33 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 18:52:33 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 18:52:33 - 0:00:02 - Epoch 0
INFO - 07/08/25 18:53:25 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 18:53:25 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 18:53:25 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 18:53:25 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 18:53:25 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 18:53:25 - 0:00:00 - Loading data
DEBUG - 07/08/25 18:53:25 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 18:53:25 - 0:00:00 - Building model 0
DEBUG - 07/08/25 18:53:26 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 18:53:26 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 18:53:26 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 18:53:26 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 18:53:26 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 18:53:26 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 18:53:26 - 0:00:02 - Epoch 0
INFO - 07/08/25 18:53:51 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 18:53:51 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 101
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 18:53:51 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 18:53:51 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 18:53:51 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 18:53:51 - 0:00:00 - Loading data
DEBUG - 07/08/25 18:53:51 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 18:53:51 - 0:00:00 - Building model 0
DEBUG - 07/08/25 18:53:53 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 18:53:53 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 18:53:53 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 18:53:53 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 18:53:53 - 0:00:02 - Number of M2 parameters = 3,362,551
DEBUG - 07/08/25 18:53:53 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 18:53:53 - 0:00:02 - Epoch 0
INFO - 07/08/25 18:57:22 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 18:57:22 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 101
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 18:57:22 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 18:57:22 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 18:57:22 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 18:57:22 - 0:00:00 - Loading data
DEBUG - 07/08/25 18:57:22 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 18:57:22 - 0:00:00 - Building model 0
DEBUG - 07/08/25 18:57:24 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 18:57:24 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 18:57:24 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 18:57:24 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 18:57:24 - 0:00:02 - Number of M2 parameters = 3,362,551
DEBUG - 07/08/25 18:57:24 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 18:57:24 - 0:00:02 - Epoch 0
INFO - 07/08/25 18:59:42 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 18:59:42 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 101
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 18:59:42 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 18:59:42 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 18:59:42 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 18:59:42 - 0:00:00 - Loading data
DEBUG - 07/08/25 18:59:42 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 18:59:42 - 0:00:00 - Building model 0
DEBUG - 07/08/25 18:59:43 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 18:59:43 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 18:59:43 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 18:59:43 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 18:59:43 - 0:00:02 - Number of M2 parameters = 3,362,551
DEBUG - 07/08/25 18:59:43 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 18:59:43 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:04:26 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:04:26 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 101
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:04:26 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:04:26 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:04:26 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:04:26 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:04:27 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:04:27 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:04:28 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:04:28 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:04:28 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:04:28 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:04:28 - 0:00:02 - Number of M2 parameters = 3,362,551
DEBUG - 07/08/25 19:04:28 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:04:28 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:04:59 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:04:59 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 101
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:04:59 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:04:59 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:04:59 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:04:59 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:05:00 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:05:00 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:05:01 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:05:01 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:05:01 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:05:01 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:05:01 - 0:00:02 - Number of M2 parameters = 3,362,551
DEBUG - 07/08/25 19:05:01 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:05:01 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:05:42 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:05:42 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 101
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:05:42 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:05:42 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:05:42 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:05:42 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:05:42 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:05:42 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:05:43 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:05:43 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:05:43 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:05:43 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:05:43 - 0:00:02 - Number of M2 parameters = 3,362,551
DEBUG - 07/08/25 19:05:43 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:05:43 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:06:11 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:06:11 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 101
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:06:11 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:06:11 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:06:11 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:06:11 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:06:12 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:06:12 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:06:13 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:06:13 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:06:13 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:06:13 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:06:13 - 0:00:02 - Number of M2 parameters = 3,362,551
DEBUG - 07/08/25 19:06:13 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:06:13 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:06:19 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:06:19 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 101
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:06:19 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:06:19 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:06:19 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:06:19 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:06:19 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:06:19 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:06:21 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:06:21 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:06:21 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:06:21 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:06:21 - 0:00:02 - Number of M2 parameters = 3,362,551
DEBUG - 07/08/25 19:06:21 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:06:21 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:07:44 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:07:44 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 101
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:07:44 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:07:44 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:07:44 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:07:44 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:07:44 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:07:44 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:07:46 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:07:46 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:07:46 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:07:46 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:07:46 - 0:00:02 - Number of M2 parameters = 3,362,551
DEBUG - 07/08/25 19:07:46 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:07:46 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:09:42 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:09:42 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:09:42 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:09:42 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:09:42 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:09:42 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:09:43 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:09:43 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:09:44 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:09:44 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:09:44 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:09:44 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:09:44 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 19:09:44 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:09:44 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:10:55 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:10:55 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:10:55 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:10:55 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:10:55 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:10:55 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:10:55 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:10:55 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:10:56 - 0:00:01 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:10:56 - 0:00:01 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:10:56 - 0:00:01 - Moving model to cuda
DEBUG - 07/08/25 19:10:56 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:10:56 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 19:10:56 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:10:56 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:11:33 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:11:33 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:11:33 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:11:33 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:11:33 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:11:33 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:11:34 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:11:34 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:11:35 - 0:00:01 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:11:35 - 0:00:01 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:11:35 - 0:00:01 - Moving model to cuda
DEBUG - 07/08/25 19:11:35 - 0:00:01 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:11:35 - 0:00:01 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 19:11:35 - 0:00:01 - Moving model to cuda
DEBUG - 07/08/25 19:11:35 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:12:03 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:12:03 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 101
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:12:03 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:12:03 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:12:03 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:12:03 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:12:03 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:12:03 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:12:04 - 0:00:01 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:12:04 - 0:00:01 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:12:04 - 0:00:01 - Moving model to cuda
DEBUG - 07/08/25 19:12:04 - 0:00:01 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:12:04 - 0:00:01 - Number of M2 parameters = 3,362,551
DEBUG - 07/08/25 19:12:04 - 0:00:01 - Moving model to cuda
DEBUG - 07/08/25 19:12:04 - 0:00:01 - Epoch 0
INFO - 07/08/25 19:13:40 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:13:40 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 101
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:13:40 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:13:40 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:13:40 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:13:40 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:13:40 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:13:40 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:13:41 - 0:00:01 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:13:41 - 0:00:01 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:13:41 - 0:00:01 - Moving model to cuda
DEBUG - 07/08/25 19:13:41 - 0:00:01 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:13:41 - 0:00:01 - Number of M2 parameters = 3,362,551
DEBUG - 07/08/25 19:13:41 - 0:00:01 - Moving model to cuda
DEBUG - 07/08/25 19:13:41 - 0:00:01 - Epoch 0
INFO - 07/08/25 19:15:49 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:15:49 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 73
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 73
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:15:49 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:15:49 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:15:49 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:15:49 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:15:49 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:15:49 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:15:51 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:15:51 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:15:51 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:15:51 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=73, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:15:51 - 0:00:02 - Number of M2 parameters = 3,320,551
DEBUG - 07/08/25 19:15:51 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:15:51 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:18:46 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:18:46 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 73
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 73
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:18:46 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:18:46 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:18:46 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:18:46 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:18:46 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:18:46 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:18:47 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:18:47 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:18:47 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:18:47 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=73, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:18:47 - 0:00:02 - Number of M2 parameters = 3,320,551
DEBUG - 07/08/25 19:18:47 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:18:47 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:22:50 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:22:50 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 73
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 73
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:22:50 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:22:50 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:22:50 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:22:50 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:22:50 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:22:50 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:22:52 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:22:52 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:22:52 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:22:52 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=73, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:22:52 - 0:00:02 - Number of M2 parameters = 3,320,551
DEBUG - 07/08/25 19:22:52 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:22:52 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:23:02 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:23:02 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 73
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 73
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:23:02 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:23:02 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:23:02 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:23:02 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:23:02 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:23:02 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:23:04 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:23:04 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:23:04 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:23:04 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=73, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:23:04 - 0:00:02 - Number of M2 parameters = 3,320,551
DEBUG - 07/08/25 19:23:04 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:23:04 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:23:49 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:23:49 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 73
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 101
                                     fg_edge_dim: 73
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:23:49 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:23:49 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:23:49 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:23:49 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:23:49 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:23:49 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:23:50 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:23:50 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:23:50 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:23:50 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=73, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:23:50 - 0:00:02 - Number of M2 parameters = 3,328,951
DEBUG - 07/08/25 19:23:50 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:23:50 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:27:04 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:27:04 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 73
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 101
                                     fg_edge_dim: 73
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:27:04 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:27:04 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:27:04 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:27:04 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:27:04 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:27:04 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:27:06 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:27:06 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:27:06 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:27:06 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=73, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:27:06 - 0:00:02 - Number of M2 parameters = 3,328,951
DEBUG - 07/08/25 19:27:06 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:27:06 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:28:32 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:28:32 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 73
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 101
                                     fg_edge_dim: 73
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:28:32 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:28:32 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:28:32 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:28:32 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:28:32 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:28:32 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:28:33 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:28:33 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:28:33 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:28:33 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=73, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:28:33 - 0:00:02 - Number of M2 parameters = 3,328,951
DEBUG - 07/08/25 19:28:33 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:28:33 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:29:34 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:29:34 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 73
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:29:34 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:29:34 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:29:34 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:29:34 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:29:35 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:29:35 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:29:36 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:29:36 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:29:36 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:29:36 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=73, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:29:36 - 0:00:02 - Number of M2 parameters = 3,328,951
DEBUG - 07/08/25 19:29:36 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:29:36 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:29:57 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:29:57 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 73
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 73
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:29:57 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:29:57 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:29:57 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:29:57 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:29:57 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:29:57 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:29:58 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:29:58 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:29:58 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:29:58 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=73, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:29:58 - 0:00:02 - Number of M2 parameters = 3,320,551
DEBUG - 07/08/25 19:29:58 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:29:58 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:30:43 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:30:43 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 73
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 73
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:30:43 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:30:43 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:30:43 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:30:43 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:30:43 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:30:43 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:30:45 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:30:45 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:30:45 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:30:45 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=73, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:30:45 - 0:00:02 - Number of M2 parameters = 3,320,551
DEBUG - 07/08/25 19:30:45 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:30:45 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:31:20 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:31:20 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 73
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 73
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:31:20 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:31:20 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:31:20 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:31:20 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:31:21 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:31:21 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:31:22 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:31:22 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:31:22 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:31:22 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=73, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:31:22 - 0:00:02 - Number of M2 parameters = 3,320,551
DEBUG - 07/08/25 19:31:22 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:31:22 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:35:17 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:35:17 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 73
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:35:17 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:35:17 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:35:17 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:35:17 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:35:18 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:35:18 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:35:19 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:35:19 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:35:19 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:35:19 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:35:19 - 0:00:02 - Number of M2 parameters = 3,345,751
DEBUG - 07/08/25 19:35:19 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:35:19 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:35:39 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:35:39 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 73
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 101
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:35:39 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:35:39 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:35:39 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:35:39 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:35:39 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:35:39 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:35:40 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:35:40 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:35:40 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:35:40 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:35:40 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 19:35:40 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:35:40 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:36:11 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:36:11 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:36:11 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:36:11 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:36:11 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:36:11 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:36:11 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:36:11 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:36:12 - 0:00:01 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:36:12 - 0:00:01 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:36:12 - 0:00:01 - Moving model to cuda
DEBUG - 07/08/25 19:36:12 - 0:00:01 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:36:12 - 0:00:01 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 19:36:12 - 0:00:01 - Moving model to cuda
DEBUG - 07/08/25 19:36:12 - 0:00:01 - Epoch 0
INFO - 07/08/25 19:37:10 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:37:10 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:37:10 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:37:10 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:37:10 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:37:10 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:37:10 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:37:10 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:37:12 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:37:12 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:37:12 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:37:12 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:37:12 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 19:37:12 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:37:12 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:39:35 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:39:35 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:39:35 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:39:35 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:39:35 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:39:35 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:39:35 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:39:35 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:39:36 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:39:36 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:39:36 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:39:36 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:39:36 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 19:39:36 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:39:36 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:42:21 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:42:21 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:42:21 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:42:21 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:42:21 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:42:21 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:42:21 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:42:21 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:42:22 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:42:22 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:42:22 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:42:22 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:42:22 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 19:42:22 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:42:22 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:43:32 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:43:32 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:43:32 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:43:32 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:43:32 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:43:32 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:43:32 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:43:32 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:43:33 - 0:00:01 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:43:33 - 0:00:01 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:43:33 - 0:00:01 - Moving model to cuda
DEBUG - 07/08/25 19:43:33 - 0:00:01 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:43:33 - 0:00:01 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 19:43:33 - 0:00:01 - Moving model to cuda
DEBUG - 07/08/25 19:43:33 - 0:00:01 - Epoch 0
INFO - 07/08/25 19:44:59 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:44:59 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:44:59 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:44:59 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:44:59 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:44:59 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:44:59 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:44:59 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:45:00 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:45:00 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:45:00 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:45:00 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:45:00 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 19:45:00 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:45:00 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:47:09 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:47:09 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:47:09 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:47:09 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:47:09 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:47:09 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:47:09 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:47:09 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:47:10 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:47:10 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:47:10 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:47:10 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:47:10 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 19:47:10 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:47:10 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:48:00 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:48:00 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:48:00 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:48:00 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:48:00 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:48:00 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:48:00 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:48:00 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:48:01 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:48:01 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:48:01 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:48:01 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:48:01 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 19:48:01 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:48:01 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:51:31 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:51:31 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:51:31 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:51:31 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:51:31 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:51:31 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:51:31 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:51:31 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:51:32 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:51:32 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:51:32 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:51:32 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:51:32 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 19:51:32 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:51:32 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:52:17 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:52:17 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:52:17 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:52:17 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:52:17 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:52:17 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:52:17 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:52:17 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:52:19 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:52:19 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:52:19 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:52:19 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:52:19 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 19:52:19 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:52:19 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:53:28 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:53:28 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:53:28 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:53:28 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:53:28 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:53:28 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:53:28 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:53:28 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:53:29 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:53:29 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:53:29 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:53:29 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:53:29 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 19:53:29 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:53:29 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:55:18 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:55:18 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:55:18 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:55:18 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:55:18 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:55:18 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:55:18 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:55:18 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:55:19 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:55:19 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:55:19 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:55:19 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:55:19 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 19:55:19 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:55:19 - 0:00:02 - Epoch 0
INFO - 07/08/25 19:59:50 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 19:59:50 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 19:59:50 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 19:59:50 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 19:59:50 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 19:59:50 - 0:00:00 - Loading data
DEBUG - 07/08/25 19:59:51 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 19:59:51 - 0:00:00 - Building model 0
DEBUG - 07/08/25 19:59:52 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:59:52 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 19:59:52 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:59:52 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 19:59:52 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 19:59:52 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 19:59:52 - 0:00:02 - Epoch 0
INFO - 07/08/25 20:02:52 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 20:02:52 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 20:02:52 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 20:02:52 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 20:02:52 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 20:02:52 - 0:00:00 - Loading data
DEBUG - 07/08/25 20:02:52 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 20:02:52 - 0:00:00 - Building model 0
DEBUG - 07/08/25 20:02:53 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 20:02:53 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 20:02:53 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 20:02:53 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 20:02:53 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 20:02:53 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 20:02:53 - 0:00:02 - Epoch 0
INFO - 07/08/25 20:06:20 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 20:06:20 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 20:06:20 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 20:06:20 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 20:06:20 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 20:06:20 - 0:00:00 - Loading data
DEBUG - 07/08/25 20:06:21 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 20:06:21 - 0:00:00 - Building model 0
DEBUG - 07/08/25 20:06:22 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 20:06:22 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 20:06:22 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 20:06:22 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 20:06:22 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 20:06:22 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 20:06:22 - 0:00:02 - Epoch 0
INFO - 07/08/25 20:08:15 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 20:08:15 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 20:08:15 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 20:08:15 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 20:08:15 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 20:08:15 - 0:00:00 - Loading data
DEBUG - 07/08/25 20:08:15 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 20:08:15 - 0:00:00 - Building model 0
DEBUG - 07/08/25 20:08:16 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 20:08:16 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 20:08:16 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 20:08:16 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 20:08:16 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 20:08:16 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 20:08:16 - 0:00:02 - Epoch 0
INFO - 07/08/25 20:09:29 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 20:09:29 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 20:09:29 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 20:09:29 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 20:09:29 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 20:09:29 - 0:00:00 - Loading data
DEBUG - 07/08/25 20:09:29 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 20:09:29 - 0:00:00 - Building model 0
DEBUG - 07/08/25 20:09:31 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 20:09:31 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 20:09:31 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 20:09:31 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 20:09:31 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 20:09:31 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 20:09:31 - 0:00:02 - Epoch 0
INFO - 07/08/25 20:09:53 - 0:00:24 - Epoch 1/200 | Step 27 |  Avg Test Loss: 3.3678 | Test ROC-AUC: 0.7087
DEBUG - 07/08/25 20:09:53 - 0:00:24 - Epoch 1
INFO - 07/08/25 20:10:14 - 0:00:45 - Epoch 2/200 | Step 54 |  Avg Test Loss: 2.5838 | Test ROC-AUC: 0.5959
DEBUG - 07/08/25 20:10:14 - 0:00:45 - Epoch 2
INFO - 07/08/25 20:10:35 - 0:01:06 - Epoch 3/200 | Step 81 |  Avg Test Loss: 2.1688 | Test ROC-AUC: 0.6904
DEBUG - 07/08/25 20:10:35 - 0:01:06 - Epoch 3
INFO - 07/08/25 20:10:55 - 0:01:26 - Epoch 4/200 | Step 108 |  Avg Test Loss: 1.9368 | Test ROC-AUC: 0.6965
DEBUG - 07/08/25 20:10:55 - 0:01:26 - Epoch 4
INFO - 07/08/25 20:11:15 - 0:01:46 - Epoch 5/200 | Step 135 |  Avg Test Loss: 1.8089 | Test ROC-AUC: 0.7422
DEBUG - 07/08/25 20:11:15 - 0:01:46 - Epoch 5
INFO - 07/08/25 20:11:35 - 0:02:06 - Epoch 6/200 | Step 162 |  Avg Test Loss: 1.7479 | Test ROC-AUC: 0.7702
DEBUG - 07/08/25 20:11:35 - 0:02:06 - Epoch 6
INFO - 07/08/25 20:12:29 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 20:12:29 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 20:12:29 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 20:12:29 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 20:12:29 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 20:12:29 - 0:00:00 - Loading data
DEBUG - 07/08/25 20:12:29 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 20:12:29 - 0:00:00 - Building model 0
DEBUG - 07/08/25 20:12:30 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 20:12:30 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 20:12:30 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 20:12:30 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 20:12:30 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 20:12:30 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 20:12:30 - 0:00:02 - Epoch 0
INFO - 07/08/25 20:13:06 - 0:00:00 - ============ Initialized logger ============
INFO - 07/08/25 20:13:06 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 50
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 300
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 300
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/08/25 20:13:06 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/08/25 20:13:06 - 0:00:00 - The experiment will be stored in dumped/0708-finetune/pretrain
                                     
INFO - 07/08/25 20:13:06 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/08/25 20:13:06 - 0:00:00 - Loading data
DEBUG - 07/08/25 20:13:06 - 0:00:00 - Total size = 1513
DEBUG - 07/08/25 20:13:06 - 0:00:00 - Building model 0
DEBUG - 07/08/25 20:13:07 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=600, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=300, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=600, out_features=300, bias=True)
                                            (empty_fusion_proj): Linear(in_features=300, out_features=600, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 20:13:07 - 0:00:02 - Number of M1 parameters = 1,592,854
DEBUG - 07/08/25 20:13:07 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 20:13:07 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=300, out_features=150, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=150, out_features=300, bias=True)
                                        )
                                      )
DEBUG - 07/08/25 20:13:07 - 0:00:02 - Number of M2 parameters = 3,354,151
DEBUG - 07/08/25 20:13:07 - 0:00:02 - Moving model to cuda
DEBUG - 07/08/25 20:13:07 - 0:00:02 - Epoch 0
INFO - 07/08/25 20:13:30 - 0:00:24 - Epoch 1/200 | Step 27 |  Avg Test Loss: 3.3678 | Test ROC-AUC: 0.7087
DEBUG - 07/08/25 20:13:30 - 0:00:24 - Epoch 1
INFO - 07/08/25 20:13:51 - 0:00:45 - Epoch 2/200 | Step 54 |  Avg Test Loss: 2.5838 | Test ROC-AUC: 0.5956
DEBUG - 07/08/25 20:13:51 - 0:00:45 - Epoch 2
INFO - 07/08/25 20:14:11 - 0:01:06 - Epoch 3/200 | Step 81 |  Avg Test Loss: 2.1688 | Test ROC-AUC: 0.6904
DEBUG - 07/08/25 20:14:11 - 0:01:06 - Epoch 3
INFO - 07/08/25 20:14:32 - 0:01:26 - Epoch 4/200 | Step 108 |  Avg Test Loss: 1.9368 | Test ROC-AUC: 0.6965
DEBUG - 07/08/25 20:14:32 - 0:01:26 - Epoch 4
INFO - 07/08/25 20:14:53 - 0:01:47 - Epoch 5/200 | Step 135 |  Avg Test Loss: 1.8089 | Test ROC-AUC: 0.7413
DEBUG - 07/08/25 20:14:53 - 0:01:47 - Epoch 5
INFO - 07/08/25 20:15:13 - 0:02:08 - Epoch 6/200 | Step 162 |  Avg Test Loss: 1.7479 | Test ROC-AUC: 0.7693
DEBUG - 07/08/25 20:15:13 - 0:02:08 - Epoch 6
INFO - 07/08/25 20:15:34 - 0:02:28 - Epoch 7/200 | Step 189 |  Avg Test Loss: 1.7001 | Test ROC-AUC: 0.7739
DEBUG - 07/08/25 20:15:34 - 0:02:28 - Epoch 7
INFO - 07/08/25 20:15:54 - 0:02:49 - Epoch 8/200 | Step 216 |  Avg Test Loss: 1.6523 | Test ROC-AUC: 0.7837
DEBUG - 07/08/25 20:15:55 - 0:02:49 - Epoch 8
INFO - 07/08/25 20:16:15 - 0:03:09 - Epoch 9/200 | Step 243 |  Avg Test Loss: 1.6083 | Test ROC-AUC: 0.8006
DEBUG - 07/08/25 20:16:15 - 0:03:09 - Epoch 9
INFO - 07/08/25 20:16:35 - 0:03:30 - Epoch 10/200 | Step 270 |  Avg Test Loss: 1.5602 | Test ROC-AUC: 0.8052
DEBUG - 07/08/25 20:16:35 - 0:03:30 - Epoch 10
INFO - 07/08/25 20:16:57 - 0:03:51 - Epoch 11/200 | Step 297 |  Avg Test Loss: 1.5321 | Test ROC-AUC: 0.8196
DEBUG - 07/08/25 20:16:57 - 0:03:51 - Epoch 11
INFO - 07/08/25 20:17:17 - 0:04:12 - Epoch 12/200 | Step 324 |  Avg Test Loss: 1.4726 | Test ROC-AUC: 0.8174
DEBUG - 07/08/25 20:17:17 - 0:04:12 - Epoch 12
INFO - 07/08/25 20:17:38 - 0:04:32 - Epoch 13/200 | Step 351 |  Avg Test Loss: 1.4184 | Test ROC-AUC: 0.8237
DEBUG - 07/08/25 20:17:38 - 0:04:32 - Epoch 13
INFO - 07/08/25 20:17:59 - 0:04:54 - Epoch 14/200 | Step 378 |  Avg Test Loss: 1.3867 | Test ROC-AUC: 0.8259
DEBUG - 07/08/25 20:17:59 - 0:04:54 - Epoch 14
INFO - 07/08/25 20:18:20 - 0:05:14 - Epoch 15/200 | Step 405 |  Avg Test Loss: 1.3407 | Test ROC-AUC: 0.8369
DEBUG - 07/08/25 20:18:20 - 0:05:14 - Epoch 15
INFO - 07/08/25 20:18:41 - 0:05:35 - Epoch 16/200 | Step 432 |  Avg Test Loss: 1.2891 | Test ROC-AUC: 0.8339
DEBUG - 07/08/25 20:18:41 - 0:05:35 - Epoch 16
INFO - 07/08/25 20:19:02 - 0:05:56 - Epoch 17/200 | Step 459 |  Avg Test Loss: 1.2276 | Test ROC-AUC: 0.8367
DEBUG - 07/08/25 20:19:02 - 0:05:56 - Epoch 17
INFO - 07/08/25 20:19:22 - 0:06:17 - Epoch 18/200 | Step 486 |  Avg Test Loss: 1.1935 | Test ROC-AUC: 0.8352
DEBUG - 07/08/25 20:19:22 - 0:06:17 - Epoch 18
INFO - 07/08/25 20:19:43 - 0:06:37 - Epoch 19/200 | Step 513 |  Avg Test Loss: 1.1511 | Test ROC-AUC: 0.8387
DEBUG - 07/08/25 20:19:43 - 0:06:37 - Epoch 19
INFO - 07/08/25 20:20:04 - 0:06:58 - Epoch 20/200 | Step 540 |  Avg Test Loss: 1.0914 | Test ROC-AUC: 0.8363
DEBUG - 07/08/25 20:20:04 - 0:06:58 - Epoch 20
INFO - 07/08/25 20:20:24 - 0:07:19 - Epoch 21/200 | Step 567 |  Avg Test Loss: 1.0511 | Test ROC-AUC: 0.8328
DEBUG - 07/08/25 20:20:24 - 0:07:19 - Epoch 21
INFO - 07/08/25 20:20:45 - 0:07:39 - Epoch 22/200 | Step 594 |  Avg Test Loss: 1.0168 | Test ROC-AUC: 0.8369
DEBUG - 07/08/25 20:20:45 - 0:07:39 - Epoch 22
INFO - 07/08/25 20:21:06 - 0:08:00 - Epoch 23/200 | Step 621 |  Avg Test Loss: 0.9788 | Test ROC-AUC: 0.8330
DEBUG - 07/08/25 20:21:06 - 0:08:00 - Epoch 23
INFO - 07/08/25 20:21:27 - 0:08:21 - Epoch 24/200 | Step 648 |  Avg Test Loss: 0.9534 | Test ROC-AUC: 0.8406
DEBUG - 07/08/25 20:21:27 - 0:08:21 - Epoch 24
INFO - 07/08/25 20:21:47 - 0:08:42 - Epoch 25/200 | Step 675 |  Avg Test Loss: 0.9298 | Test ROC-AUC: 0.8383
DEBUG - 07/08/25 20:21:47 - 0:08:42 - Epoch 25
INFO - 07/08/25 20:22:09 - 0:09:03 - Epoch 26/200 | Step 702 |  Avg Test Loss: 0.9246 | Test ROC-AUC: 0.8313
DEBUG - 07/08/25 20:22:09 - 0:09:03 - Epoch 26
INFO - 07/08/25 20:22:29 - 0:09:24 - Epoch 27/200 | Step 729 |  Avg Test Loss: 0.8734 | Test ROC-AUC: 0.8378
DEBUG - 07/08/25 20:22:29 - 0:09:24 - Epoch 27
INFO - 07/08/25 20:22:50 - 0:09:44 - Epoch 28/200 | Step 756 |  Avg Test Loss: 0.8943 | Test ROC-AUC: 0.8426
DEBUG - 07/08/25 20:22:50 - 0:09:44 - Epoch 28
INFO - 07/08/25 20:23:10 - 0:10:05 - Epoch 29/200 | Step 783 |  Avg Test Loss: 0.8320 | Test ROC-AUC: 0.8369
DEBUG - 07/08/25 20:23:10 - 0:10:05 - Epoch 29
INFO - 07/08/25 20:23:31 - 0:10:26 - Epoch 30/200 | Step 810 |  Avg Test Loss: 0.8331 | Test ROC-AUC: 0.8413
DEBUG - 07/08/25 20:23:31 - 0:10:26 - Epoch 30
INFO - 07/08/25 20:23:52 - 0:10:47 - Epoch 31/200 | Step 837 |  Avg Test Loss: 0.8027 | Test ROC-AUC: 0.8443
DEBUG - 07/08/25 20:23:52 - 0:10:47 - Epoch 31
INFO - 07/08/25 20:24:13 - 0:11:07 - Epoch 32/200 | Step 864 |  Avg Test Loss: 0.8027 | Test ROC-AUC: 0.8435
DEBUG - 07/08/25 20:24:13 - 0:11:07 - Epoch 32
INFO - 07/08/25 20:24:34 - 0:11:28 - Epoch 33/200 | Step 891 |  Avg Test Loss: 0.7740 | Test ROC-AUC: 0.8435
DEBUG - 07/08/25 20:24:34 - 0:11:28 - Epoch 33
INFO - 07/08/25 20:24:55 - 0:11:50 - Epoch 34/200 | Step 918 |  Avg Test Loss: 0.7586 | Test ROC-AUC: 0.8448
DEBUG - 07/08/25 20:24:55 - 0:11:50 - Epoch 34
INFO - 07/08/25 20:25:16 - 0:12:10 - Epoch 35/200 | Step 945 |  Avg Test Loss: 0.7503 | Test ROC-AUC: 0.8469
DEBUG - 07/08/25 20:25:16 - 0:12:10 - Epoch 35
INFO - 07/08/25 20:25:37 - 0:12:31 - Epoch 36/200 | Step 972 |  Avg Test Loss: 0.7247 | Test ROC-AUC: 0.8457
DEBUG - 07/08/25 20:25:37 - 0:12:31 - Epoch 36
INFO - 07/08/25 20:25:58 - 0:12:52 - Epoch 37/200 | Step 999 |  Avg Test Loss: 0.7257 | Test ROC-AUC: 0.8511
DEBUG - 07/08/25 20:25:58 - 0:12:52 - Epoch 37
INFO - 07/08/25 20:26:18 - 0:13:13 - Epoch 38/200 | Step 1026 |  Avg Test Loss: 0.7090 | Test ROC-AUC: 0.8509
DEBUG - 07/08/25 20:26:18 - 0:13:13 - Epoch 38
INFO - 07/08/25 20:26:39 - 0:13:33 - Epoch 39/200 | Step 1053 |  Avg Test Loss: 0.6858 | Test ROC-AUC: 0.8509
DEBUG - 07/08/25 20:26:39 - 0:13:34 - Epoch 39
INFO - 07/08/25 20:27:00 - 0:13:54 - Epoch 40/200 | Step 1080 |  Avg Test Loss: 0.6792 | Test ROC-AUC: 0.8554
DEBUG - 07/08/25 20:27:00 - 0:13:54 - Epoch 40
INFO - 07/08/25 20:27:21 - 0:14:15 - Epoch 41/200 | Step 1107 |  Avg Test Loss: 0.6976 | Test ROC-AUC: 0.8548
DEBUG - 07/08/25 20:27:21 - 0:14:15 - Epoch 41
INFO - 07/08/25 20:27:41 - 0:14:36 - Epoch 42/200 | Step 1134 |  Avg Test Loss: 0.6657 | Test ROC-AUC: 0.8569
DEBUG - 07/08/25 20:27:41 - 0:14:36 - Epoch 42
INFO - 07/08/25 20:28:02 - 0:14:57 - Epoch 43/200 | Step 1161 |  Avg Test Loss: 0.6642 | Test ROC-AUC: 0.8550
DEBUG - 07/08/25 20:28:02 - 0:14:57 - Epoch 43
INFO - 07/08/25 20:28:23 - 0:15:18 - Epoch 44/200 | Step 1188 |  Avg Test Loss: 0.6620 | Test ROC-AUC: 0.8569
DEBUG - 07/08/25 20:28:23 - 0:15:18 - Epoch 44
INFO - 07/08/25 20:28:44 - 0:15:38 - Epoch 45/200 | Step 1215 |  Avg Test Loss: 0.6341 | Test ROC-AUC: 0.8557
DEBUG - 07/08/25 20:28:44 - 0:15:38 - Epoch 45
INFO - 07/08/25 20:29:05 - 0:15:59 - Epoch 46/200 | Step 1242 |  Avg Test Loss: 0.6287 | Test ROC-AUC: 0.8559
DEBUG - 07/08/25 20:29:05 - 0:15:59 - Epoch 46
INFO - 07/08/25 20:29:26 - 0:16:20 - Epoch 47/200 | Step 1269 |  Avg Test Loss: 0.6158 | Test ROC-AUC: 0.8606
DEBUG - 07/08/25 20:29:26 - 0:16:20 - Epoch 47
INFO - 07/08/25 20:29:47 - 0:16:41 - Epoch 48/200 | Step 1296 |  Avg Test Loss: 0.5999 | Test ROC-AUC: 0.8606
DEBUG - 07/08/25 20:29:47 - 0:16:41 - Epoch 48
INFO - 07/08/25 20:30:07 - 0:17:01 - Epoch 49/200 | Step 1323 |  Avg Test Loss: 0.6269 | Test ROC-AUC: 0.8683
DEBUG - 07/08/25 20:30:07 - 0:17:01 - Epoch 49
INFO - 07/08/25 20:30:27 - 0:17:22 - Epoch 50/200 | Step 1350 |  Avg Test Loss: 0.6113 | Test ROC-AUC: 0.8711
DEBUG - 07/08/25 20:30:27 - 0:17:22 - Epoch 50
INFO - 07/08/25 20:30:47 - 0:17:42 - Epoch 51/200 | Step 1377 |  Avg Test Loss: 0.5946 | Test ROC-AUC: 0.8667
DEBUG - 07/08/25 20:30:47 - 0:17:42 - Epoch 51
INFO - 07/08/25 20:31:08 - 0:18:02 - Epoch 52/200 | Step 1404 |  Avg Test Loss: 0.6170 | Test ROC-AUC: 0.8680
DEBUG - 07/08/25 20:31:08 - 0:18:02 - Epoch 52
INFO - 07/08/25 20:31:29 - 0:18:23 - Epoch 53/200 | Step 1431 |  Avg Test Loss: 0.6021 | Test ROC-AUC: 0.8691
DEBUG - 07/08/25 20:31:29 - 0:18:24 - Epoch 53
INFO - 07/08/25 20:31:50 - 0:18:44 - Epoch 54/200 | Step 1458 |  Avg Test Loss: 0.6122 | Test ROC-AUC: 0.8700
DEBUG - 07/08/25 20:31:50 - 0:18:44 - Epoch 54
INFO - 07/08/25 20:32:10 - 0:19:05 - Epoch 55/200 | Step 1485 |  Avg Test Loss: 0.5741 | Test ROC-AUC: 0.8757
DEBUG - 07/08/25 20:32:10 - 0:19:05 - Epoch 55
INFO - 07/08/25 20:32:31 - 0:19:25 - Epoch 56/200 | Step 1512 |  Avg Test Loss: 0.6530 | Test ROC-AUC: 0.8713
DEBUG - 07/08/25 20:32:31 - 0:19:25 - Epoch 56
INFO - 07/08/25 20:32:52 - 0:19:46 - Epoch 57/200 | Step 1539 |  Avg Test Loss: 0.5711 | Test ROC-AUC: 0.8693
DEBUG - 07/08/25 20:32:52 - 0:19:46 - Epoch 57
INFO - 07/08/25 20:33:13 - 0:20:07 - Epoch 58/200 | Step 1566 |  Avg Test Loss: 0.5577 | Test ROC-AUC: 0.8739
DEBUG - 07/08/25 20:33:13 - 0:20:07 - Epoch 58
INFO - 07/08/25 20:33:34 - 0:20:28 - Epoch 59/200 | Step 1593 |  Avg Test Loss: 0.5535 | Test ROC-AUC: 0.8698
DEBUG - 07/08/25 20:33:34 - 0:20:28 - Epoch 59
INFO - 07/08/25 20:33:55 - 0:20:49 - Epoch 60/200 | Step 1620 |  Avg Test Loss: 0.5478 | Test ROC-AUC: 0.8720
DEBUG - 07/08/25 20:33:55 - 0:20:49 - Epoch 60
INFO - 07/08/25 20:34:15 - 0:21:10 - Epoch 61/200 | Step 1647 |  Avg Test Loss: 0.5446 | Test ROC-AUC: 0.8735
DEBUG - 07/08/25 20:34:15 - 0:21:10 - Epoch 61
INFO - 07/08/25 20:34:36 - 0:21:30 - Epoch 62/200 | Step 1674 |  Avg Test Loss: 0.5339 | Test ROC-AUC: 0.8737
DEBUG - 07/08/25 20:34:36 - 0:21:30 - Epoch 62
INFO - 07/08/25 20:34:57 - 0:21:51 - Epoch 63/200 | Step 1701 |  Avg Test Loss: 0.5417 | Test ROC-AUC: 0.8756
DEBUG - 07/08/25 20:34:57 - 0:21:51 - Epoch 63
INFO - 07/08/25 20:35:18 - 0:22:12 - Epoch 64/200 | Step 1728 |  Avg Test Loss: 0.5468 | Test ROC-AUC: 0.8726
DEBUG - 07/08/25 20:35:18 - 0:22:12 - Epoch 64
INFO - 07/08/25 20:35:38 - 0:22:32 - Epoch 65/200 | Step 1755 |  Avg Test Loss: 0.5189 | Test ROC-AUC: 0.8781
DEBUG - 07/08/25 20:35:38 - 0:22:32 - Epoch 65
INFO - 07/08/25 20:35:59 - 0:22:53 - Epoch 66/200 | Step 1782 |  Avg Test Loss: 0.5094 | Test ROC-AUC: 0.8746
DEBUG - 07/08/25 20:35:59 - 0:22:53 - Epoch 66
INFO - 07/08/25 20:36:20 - 0:23:14 - Epoch 67/200 | Step 1809 |  Avg Test Loss: 0.5185 | Test ROC-AUC: 0.8778
DEBUG - 07/08/25 20:36:20 - 0:23:14 - Epoch 67
INFO - 07/08/25 20:36:41 - 0:23:35 - Epoch 68/200 | Step 1836 |  Avg Test Loss: 0.5737 | Test ROC-AUC: 0.8744
DEBUG - 07/08/25 20:36:41 - 0:23:35 - Epoch 68
INFO - 07/08/25 20:37:02 - 0:23:56 - Epoch 69/200 | Step 1863 |  Avg Test Loss: 0.5371 | Test ROC-AUC: 0.8752
DEBUG - 07/08/25 20:37:02 - 0:23:56 - Epoch 69
INFO - 07/08/25 20:37:22 - 0:24:17 - Epoch 70/200 | Step 1890 |  Avg Test Loss: 0.5178 | Test ROC-AUC: 0.8806
DEBUG - 07/08/25 20:37:22 - 0:24:17 - Epoch 70
INFO - 07/08/25 20:37:43 - 0:24:37 - Epoch 71/200 | Step 1917 |  Avg Test Loss: 0.5207 | Test ROC-AUC: 0.8798
DEBUG - 07/08/25 20:37:43 - 0:24:37 - Epoch 71
INFO - 07/08/25 20:38:03 - 0:24:58 - Epoch 72/200 | Step 1944 |  Avg Test Loss: 0.5360 | Test ROC-AUC: 0.8809
DEBUG - 07/08/25 20:38:03 - 0:24:58 - Epoch 72
INFO - 07/08/25 20:38:24 - 0:25:19 - Epoch 73/200 | Step 1971 |  Avg Test Loss: 0.5487 | Test ROC-AUC: 0.8831
DEBUG - 07/08/25 20:38:24 - 0:25:19 - Epoch 73
INFO - 07/08/25 20:38:45 - 0:25:39 - Epoch 74/200 | Step 1998 |  Avg Test Loss: 0.4966 | Test ROC-AUC: 0.8806
DEBUG - 07/08/25 20:38:45 - 0:25:39 - Epoch 74
INFO - 07/08/25 20:39:05 - 0:26:00 - Epoch 75/200 | Step 2025 |  Avg Test Loss: 0.5016 | Test ROC-AUC: 0.8794
DEBUG - 07/08/25 20:39:06 - 0:26:00 - Epoch 75
INFO - 07/08/25 20:39:26 - 0:26:20 - Epoch 76/200 | Step 2052 |  Avg Test Loss: 0.5115 | Test ROC-AUC: 0.8780
DEBUG - 07/08/25 20:39:26 - 0:26:20 - Epoch 76
INFO - 07/08/25 20:39:46 - 0:26:40 - Epoch 77/200 | Step 2079 |  Avg Test Loss: 0.5021 | Test ROC-AUC: 0.8774
DEBUG - 07/08/25 20:39:46 - 0:26:40 - Epoch 77
INFO - 07/08/25 20:40:06 - 0:27:00 - Epoch 78/200 | Step 2106 |  Avg Test Loss: 0.4820 | Test ROC-AUC: 0.8807
DEBUG - 07/08/25 20:40:06 - 0:27:00 - Epoch 78
INFO - 07/08/25 20:40:26 - 0:27:21 - Epoch 79/200 | Step 2133 |  Avg Test Loss: 0.5059 | Test ROC-AUC: 0.8802
DEBUG - 07/08/25 20:40:26 - 0:27:21 - Epoch 79
INFO - 07/08/25 20:40:47 - 0:27:41 - Epoch 80/200 | Step 2160 |  Avg Test Loss: 0.5024 | Test ROC-AUC: 0.8813
DEBUG - 07/08/25 20:40:47 - 0:27:41 - Epoch 80
INFO - 07/08/25 20:41:07 - 0:28:02 - Epoch 81/200 | Step 2187 |  Avg Test Loss: 0.4951 | Test ROC-AUC: 0.8861
DEBUG - 07/08/25 20:41:07 - 0:28:02 - Epoch 81
INFO - 07/08/25 20:41:28 - 0:28:22 - Epoch 82/200 | Step 2214 |  Avg Test Loss: 0.4941 | Test ROC-AUC: 0.8861
DEBUG - 07/08/25 20:41:28 - 0:28:22 - Epoch 82
INFO - 07/08/25 20:41:49 - 0:28:43 - Epoch 83/200 | Step 2241 |  Avg Test Loss: 0.4979 | Test ROC-AUC: 0.8854
DEBUG - 07/08/25 20:41:49 - 0:28:43 - Epoch 83
INFO - 07/08/25 20:42:10 - 0:29:04 - Epoch 84/200 | Step 2268 |  Avg Test Loss: 0.4864 | Test ROC-AUC: 0.8872
DEBUG - 07/08/25 20:42:10 - 0:29:04 - Epoch 84
INFO - 07/08/25 20:42:30 - 0:29:25 - Epoch 85/200 | Step 2295 |  Avg Test Loss: 0.4640 | Test ROC-AUC: 0.8874
DEBUG - 07/08/25 20:42:30 - 0:29:25 - Epoch 85
INFO - 07/08/25 20:42:51 - 0:29:46 - Epoch 86/200 | Step 2322 |  Avg Test Loss: 0.4833 | Test ROC-AUC: 0.8869
DEBUG - 07/08/25 20:42:51 - 0:29:46 - Epoch 86
INFO - 07/08/25 20:43:12 - 0:30:06 - Epoch 87/200 | Step 2349 |  Avg Test Loss: 0.5162 | Test ROC-AUC: 0.8852
DEBUG - 07/08/25 20:43:12 - 0:30:06 - Epoch 87
INFO - 07/08/25 20:43:33 - 0:30:27 - Epoch 88/200 | Step 2376 |  Avg Test Loss: 0.4774 | Test ROC-AUC: 0.8863
DEBUG - 07/08/25 20:43:33 - 0:30:27 - Epoch 88
INFO - 07/08/25 20:43:54 - 0:30:48 - Epoch 89/200 | Step 2403 |  Avg Test Loss: 0.4926 | Test ROC-AUC: 0.8806
DEBUG - 07/08/25 20:43:54 - 0:30:48 - Epoch 89
INFO - 07/08/25 20:44:15 - 0:31:09 - Epoch 90/200 | Step 2430 |  Avg Test Loss: 0.4707 | Test ROC-AUC: 0.8852
DEBUG - 07/08/25 20:44:15 - 0:31:09 - Epoch 90
INFO - 07/08/25 20:44:35 - 0:31:29 - Epoch 91/200 | Step 2457 |  Avg Test Loss: 0.4811 | Test ROC-AUC: 0.8831
DEBUG - 07/08/25 20:44:35 - 0:31:29 - Epoch 91
INFO - 07/08/25 20:44:56 - 0:31:50 - Epoch 92/200 | Step 2484 |  Avg Test Loss: 0.4634 | Test ROC-AUC: 0.8887
DEBUG - 07/08/25 20:44:56 - 0:31:50 - Epoch 92
INFO - 07/08/25 20:45:17 - 0:32:11 - Epoch 93/200 | Step 2511 |  Avg Test Loss: 0.4864 | Test ROC-AUC: 0.8870
DEBUG - 07/08/25 20:45:17 - 0:32:11 - Epoch 93
INFO - 07/08/25 20:45:37 - 0:32:32 - Epoch 94/200 | Step 2538 |  Avg Test Loss: 0.4770 | Test ROC-AUC: 0.8846
DEBUG - 07/08/25 20:45:37 - 0:32:32 - Epoch 94
INFO - 07/08/25 20:45:58 - 0:32:52 - Epoch 95/200 | Step 2565 |  Avg Test Loss: 0.4948 | Test ROC-AUC: 0.8896
DEBUG - 07/08/25 20:45:58 - 0:32:52 - Epoch 95
INFO - 07/08/25 20:46:19 - 0:33:13 - Epoch 96/200 | Step 2592 |  Avg Test Loss: 0.4631 | Test ROC-AUC: 0.8891
DEBUG - 07/08/25 20:46:19 - 0:33:13 - Epoch 96
INFO - 07/08/25 20:46:40 - 0:33:34 - Epoch 97/200 | Step 2619 |  Avg Test Loss: 0.4637 | Test ROC-AUC: 0.8902
DEBUG - 07/08/25 20:46:40 - 0:33:34 - Epoch 97
INFO - 07/08/25 20:47:01 - 0:33:55 - Epoch 98/200 | Step 2646 |  Avg Test Loss: 0.4524 | Test ROC-AUC: 0.8898
DEBUG - 07/08/25 20:47:01 - 0:33:55 - Epoch 98
INFO - 07/08/25 20:47:21 - 0:34:16 - Epoch 99/200 | Step 2673 |  Avg Test Loss: 0.5571 | Test ROC-AUC: 0.8856
DEBUG - 07/08/25 20:47:21 - 0:34:16 - Epoch 99
INFO - 07/08/25 20:47:42 - 0:34:36 - Epoch 100/200 | Step 2700 |  Avg Test Loss: 0.4697 | Test ROC-AUC: 0.8857
DEBUG - 07/08/25 20:47:42 - 0:34:36 - Epoch 100
INFO - 07/08/25 20:48:03 - 0:34:57 - Epoch 101/200 | Step 2727 |  Avg Test Loss: 0.4449 | Test ROC-AUC: 0.8935
DEBUG - 07/08/25 20:48:03 - 0:34:57 - Epoch 101
INFO - 07/08/25 20:48:23 - 0:35:18 - Epoch 102/200 | Step 2754 |  Avg Test Loss: 0.5085 | Test ROC-AUC: 0.8878
DEBUG - 07/08/25 20:48:23 - 0:35:18 - Epoch 102
INFO - 07/08/25 20:48:44 - 0:35:38 - Epoch 103/200 | Step 2781 |  Avg Test Loss: 0.4882 | Test ROC-AUC: 0.8907
DEBUG - 07/08/25 20:48:44 - 0:35:38 - Epoch 103
INFO - 07/08/25 20:49:04 - 0:35:58 - Epoch 104/200 | Step 2808 |  Avg Test Loss: 0.4810 | Test ROC-AUC: 0.8889
DEBUG - 07/08/25 20:49:04 - 0:35:58 - Epoch 104
INFO - 07/08/25 20:49:24 - 0:36:19 - Epoch 105/200 | Step 2835 |  Avg Test Loss: 0.4407 | Test ROC-AUC: 0.8928
DEBUG - 07/08/25 20:49:25 - 0:36:19 - Epoch 105
INFO - 07/08/25 20:49:45 - 0:36:39 - Epoch 106/200 | Step 2862 |  Avg Test Loss: 0.4409 | Test ROC-AUC: 0.8920
DEBUG - 07/08/25 20:49:45 - 0:36:39 - Epoch 106
INFO - 07/08/25 20:50:05 - 0:37:00 - Epoch 107/200 | Step 2889 |  Avg Test Loss: 0.4417 | Test ROC-AUC: 0.8900
DEBUG - 07/08/25 20:50:06 - 0:37:00 - Epoch 107
INFO - 07/08/25 20:50:27 - 0:37:21 - Epoch 108/200 | Step 2916 |  Avg Test Loss: 0.4435 | Test ROC-AUC: 0.8922
DEBUG - 07/08/25 20:50:27 - 0:37:21 - Epoch 108
INFO - 07/08/25 20:50:47 - 0:37:42 - Epoch 109/200 | Step 2943 |  Avg Test Loss: 0.5068 | Test ROC-AUC: 0.8926
DEBUG - 07/08/25 20:50:47 - 0:37:42 - Epoch 109
INFO - 07/08/25 20:51:08 - 0:38:03 - Epoch 110/200 | Step 2970 |  Avg Test Loss: 0.4456 | Test ROC-AUC: 0.8944
DEBUG - 07/08/25 20:51:09 - 0:38:03 - Epoch 110
INFO - 07/08/25 20:51:29 - 0:38:24 - Epoch 111/200 | Step 2997 |  Avg Test Loss: 0.4641 | Test ROC-AUC: 0.8896
DEBUG - 07/08/25 20:51:29 - 0:38:24 - Epoch 111
INFO - 07/08/25 20:51:50 - 0:38:45 - Epoch 112/200 | Step 3024 |  Avg Test Loss: 0.4350 | Test ROC-AUC: 0.8980
DEBUG - 07/08/25 20:51:50 - 0:38:45 - Epoch 112
INFO - 07/08/25 20:52:12 - 0:39:06 - Epoch 113/200 | Step 3051 |  Avg Test Loss: 0.4811 | Test ROC-AUC: 0.8906
DEBUG - 07/08/25 20:52:12 - 0:39:06 - Epoch 113
INFO - 07/08/25 20:52:32 - 0:39:27 - Epoch 114/200 | Step 3078 |  Avg Test Loss: 0.4498 | Test ROC-AUC: 0.8937
DEBUG - 07/08/25 20:52:32 - 0:39:27 - Epoch 114
INFO - 07/08/25 20:52:53 - 0:39:48 - Epoch 115/200 | Step 3105 |  Avg Test Loss: 0.4416 | Test ROC-AUC: 0.8930
DEBUG - 07/08/25 20:52:53 - 0:39:48 - Epoch 115
INFO - 07/08/25 20:53:14 - 0:40:08 - Epoch 116/200 | Step 3132 |  Avg Test Loss: 0.4252 | Test ROC-AUC: 0.8963
DEBUG - 07/08/25 20:53:14 - 0:40:08 - Epoch 116
INFO - 07/08/25 20:53:34 - 0:40:29 - Epoch 117/200 | Step 3159 |  Avg Test Loss: 0.4208 | Test ROC-AUC: 0.8980
DEBUG - 07/08/25 20:53:34 - 0:40:29 - Epoch 117
INFO - 07/08/25 20:53:55 - 0:40:49 - Epoch 118/200 | Step 3186 |  Avg Test Loss: 0.4306 | Test ROC-AUC: 0.9011
DEBUG - 07/08/25 20:53:55 - 0:40:49 - Epoch 118
INFO - 07/08/25 20:54:16 - 0:41:10 - Epoch 119/200 | Step 3213 |  Avg Test Loss: 0.4406 | Test ROC-AUC: 0.8950
DEBUG - 07/08/25 20:54:16 - 0:41:10 - Epoch 119
INFO - 07/08/25 20:54:36 - 0:41:31 - Epoch 120/200 | Step 3240 |  Avg Test Loss: 0.4534 | Test ROC-AUC: 0.8950
DEBUG - 07/08/25 20:54:36 - 0:41:31 - Epoch 120
INFO - 07/08/25 20:54:57 - 0:41:51 - Epoch 121/200 | Step 3267 |  Avg Test Loss: 0.4275 | Test ROC-AUC: 0.9011
DEBUG - 07/08/25 20:54:57 - 0:41:51 - Epoch 121
INFO - 07/08/25 20:55:17 - 0:42:11 - Epoch 122/200 | Step 3294 |  Avg Test Loss: 0.4242 | Test ROC-AUC: 0.8959
DEBUG - 07/08/25 20:55:17 - 0:42:11 - Epoch 122
INFO - 07/08/25 20:55:37 - 0:42:32 - Epoch 123/200 | Step 3321 |  Avg Test Loss: 0.4362 | Test ROC-AUC: 0.8952
DEBUG - 07/08/25 20:55:37 - 0:42:32 - Epoch 123
INFO - 07/08/25 20:55:58 - 0:42:52 - Epoch 124/200 | Step 3348 |  Avg Test Loss: 0.4315 | Test ROC-AUC: 0.8972
DEBUG - 07/08/25 20:55:58 - 0:42:52 - Epoch 124
INFO - 07/08/25 20:56:18 - 0:43:12 - Epoch 125/200 | Step 3375 |  Avg Test Loss: 0.4149 | Test ROC-AUC: 0.9011
DEBUG - 07/08/25 20:56:18 - 0:43:12 - Epoch 125
INFO - 07/08/25 20:56:38 - 0:43:33 - Epoch 126/200 | Step 3402 |  Avg Test Loss: 0.4196 | Test ROC-AUC: 0.8993
DEBUG - 07/08/25 20:56:38 - 0:43:33 - Epoch 126
INFO - 07/08/25 20:56:59 - 0:43:53 - Epoch 127/200 | Step 3429 |  Avg Test Loss: 0.4347 | Test ROC-AUC: 0.9002
DEBUG - 07/08/25 20:56:59 - 0:43:54 - Epoch 127
INFO - 07/08/25 20:57:20 - 0:44:14 - Epoch 128/200 | Step 3456 |  Avg Test Loss: 0.4200 | Test ROC-AUC: 0.8985
DEBUG - 07/08/25 20:57:20 - 0:44:14 - Epoch 128
INFO - 07/08/25 20:57:41 - 0:44:35 - Epoch 129/200 | Step 3483 |  Avg Test Loss: 0.4397 | Test ROC-AUC: 0.9052
DEBUG - 07/08/25 20:57:41 - 0:44:35 - Epoch 129
INFO - 07/08/25 20:58:01 - 0:44:56 - Epoch 130/200 | Step 3510 |  Avg Test Loss: 0.4118 | Test ROC-AUC: 0.9004
DEBUG - 07/08/25 20:58:01 - 0:44:56 - Epoch 130
INFO - 07/08/25 20:58:22 - 0:45:16 - Epoch 131/200 | Step 3537 |  Avg Test Loss: 0.4551 | Test ROC-AUC: 0.9013
DEBUG - 07/08/25 20:58:22 - 0:45:16 - Epoch 131
INFO - 07/08/25 20:58:42 - 0:45:37 - Epoch 132/200 | Step 3564 |  Avg Test Loss: 0.4451 | Test ROC-AUC: 0.9015
DEBUG - 07/08/25 20:58:42 - 0:45:37 - Epoch 132
INFO - 07/08/25 20:59:03 - 0:45:57 - Epoch 133/200 | Step 3591 |  Avg Test Loss: 0.4191 | Test ROC-AUC: 0.9017
DEBUG - 07/08/25 20:59:03 - 0:45:57 - Epoch 133
INFO - 07/08/25 20:59:24 - 0:46:18 - Epoch 134/200 | Step 3618 |  Avg Test Loss: 0.4037 | Test ROC-AUC: 0.8983
DEBUG - 07/08/25 20:59:24 - 0:46:18 - Epoch 134
INFO - 07/08/25 20:59:44 - 0:46:39 - Epoch 135/200 | Step 3645 |  Avg Test Loss: 0.4259 | Test ROC-AUC: 0.8989
DEBUG - 07/08/25 20:59:44 - 0:46:39 - Epoch 135
INFO - 07/08/25 21:00:05 - 0:46:59 - Epoch 136/200 | Step 3672 |  Avg Test Loss: 0.4187 | Test ROC-AUC: 0.9026
DEBUG - 07/08/25 21:00:05 - 0:46:59 - Epoch 136
INFO - 07/08/25 21:00:25 - 0:47:20 - Epoch 137/200 | Step 3699 |  Avg Test Loss: 0.4264 | Test ROC-AUC: 0.9030
DEBUG - 07/08/25 21:00:25 - 0:47:20 - Epoch 137
INFO - 07/08/25 21:00:46 - 0:47:40 - Epoch 138/200 | Step 3726 |  Avg Test Loss: 0.4296 | Test ROC-AUC: 0.8994
DEBUG - 07/08/25 21:00:46 - 0:47:40 - Epoch 138
INFO - 07/08/25 21:01:06 - 0:48:01 - Epoch 139/200 | Step 3753 |  Avg Test Loss: 0.4609 | Test ROC-AUC: 0.9026
DEBUG - 07/08/25 21:01:06 - 0:48:01 - Epoch 139
INFO - 07/08/25 21:01:27 - 0:48:22 - Epoch 140/200 | Step 3780 |  Avg Test Loss: 0.4321 | Test ROC-AUC: 0.8965
DEBUG - 07/08/25 21:01:27 - 0:48:22 - Epoch 140
INFO - 07/08/25 21:01:48 - 0:48:42 - Epoch 141/200 | Step 3807 |  Avg Test Loss: 0.4160 | Test ROC-AUC: 0.9069
DEBUG - 07/08/25 21:01:48 - 0:48:42 - Epoch 141
INFO - 07/08/25 21:02:08 - 0:49:02 - Epoch 142/200 | Step 3834 |  Avg Test Loss: 0.4159 | Test ROC-AUC: 0.8996
DEBUG - 07/08/25 21:02:08 - 0:49:02 - Epoch 142
INFO - 07/08/25 21:02:29 - 0:49:23 - Epoch 143/200 | Step 3861 |  Avg Test Loss: 0.4175 | Test ROC-AUC: 0.9031
DEBUG - 07/08/25 21:02:29 - 0:49:23 - Epoch 143
INFO - 07/08/25 21:02:49 - 0:49:44 - Epoch 144/200 | Step 3888 |  Avg Test Loss: 0.4237 | Test ROC-AUC: 0.8972
DEBUG - 07/08/25 21:02:49 - 0:49:44 - Epoch 144
INFO - 07/08/25 21:03:10 - 0:50:04 - Epoch 145/200 | Step 3915 |  Avg Test Loss: 0.4406 | Test ROC-AUC: 0.9046
DEBUG - 07/08/25 21:03:10 - 0:50:04 - Epoch 145
INFO - 07/08/25 21:03:31 - 0:50:25 - Epoch 146/200 | Step 3942 |  Avg Test Loss: 0.4174 | Test ROC-AUC: 0.9037
DEBUG - 07/08/25 21:03:31 - 0:50:25 - Epoch 146
INFO - 07/08/25 21:03:51 - 0:50:46 - Epoch 147/200 | Step 3969 |  Avg Test Loss: 0.4061 | Test ROC-AUC: 0.9078
DEBUG - 07/08/25 21:03:51 - 0:50:46 - Epoch 147
INFO - 07/08/25 21:04:12 - 0:51:06 - Epoch 148/200 | Step 3996 |  Avg Test Loss: 0.4093 | Test ROC-AUC: 0.9072
DEBUG - 07/08/25 21:04:12 - 0:51:06 - Epoch 148
INFO - 07/08/25 21:04:32 - 0:51:27 - Epoch 149/200 | Step 4023 |  Avg Test Loss: 0.4236 | Test ROC-AUC: 0.9046
DEBUG - 07/08/25 21:04:33 - 0:51:27 - Epoch 149
INFO - 07/08/25 21:04:53 - 0:51:48 - Epoch 150/200 | Step 4050 |  Avg Test Loss: 0.4139 | Test ROC-AUC: 0.9046
DEBUG - 07/08/25 21:04:53 - 0:51:48 - Epoch 150
INFO - 07/08/25 21:05:14 - 0:52:09 - Epoch 151/200 | Step 4077 |  Avg Test Loss: 0.3977 | Test ROC-AUC: 0.9089
DEBUG - 07/08/25 21:05:14 - 0:52:09 - Epoch 151
INFO - 07/08/25 21:05:35 - 0:52:29 - Epoch 152/200 | Step 4104 |  Avg Test Loss: 0.4266 | Test ROC-AUC: 0.9026
DEBUG - 07/08/25 21:05:35 - 0:52:29 - Epoch 152
INFO - 07/08/25 21:05:56 - 0:52:50 - Epoch 153/200 | Step 4131 |  Avg Test Loss: 0.4470 | Test ROC-AUC: 0.9004
DEBUG - 07/08/25 21:05:56 - 0:52:50 - Epoch 153
INFO - 07/08/25 21:06:16 - 0:53:11 - Epoch 154/200 | Step 4158 |  Avg Test Loss: 0.4198 | Test ROC-AUC: 0.9007
DEBUG - 07/08/25 21:06:16 - 0:53:11 - Epoch 154
INFO - 07/08/25 21:06:37 - 0:53:31 - Epoch 155/200 | Step 4185 |  Avg Test Loss: 0.4143 | Test ROC-AUC: 0.9085
DEBUG - 07/08/25 21:06:37 - 0:53:31 - Epoch 155
INFO - 07/08/25 21:06:57 - 0:53:52 - Epoch 156/200 | Step 4212 |  Avg Test Loss: 0.4183 | Test ROC-AUC: 0.9039
DEBUG - 07/08/25 21:06:57 - 0:53:52 - Epoch 156
INFO - 07/08/25 21:07:17 - 0:54:12 - Epoch 157/200 | Step 4239 |  Avg Test Loss: 0.3855 | Test ROC-AUC: 0.9102
DEBUG - 07/08/25 21:07:17 - 0:54:12 - Epoch 157
INFO - 07/08/25 21:07:37 - 0:54:32 - Epoch 158/200 | Step 4266 |  Avg Test Loss: 0.4014 | Test ROC-AUC: 0.9067
DEBUG - 07/08/25 21:07:37 - 0:54:32 - Epoch 158
INFO - 07/08/25 21:07:58 - 0:54:52 - Epoch 159/200 | Step 4293 |  Avg Test Loss: 0.3981 | Test ROC-AUC: 0.9074
DEBUG - 07/08/25 21:07:58 - 0:54:52 - Epoch 159
INFO - 07/08/25 21:08:18 - 0:55:12 - Epoch 160/200 | Step 4320 |  Avg Test Loss: 0.3951 | Test ROC-AUC: 0.9106
DEBUG - 07/08/25 21:08:18 - 0:55:12 - Epoch 160
INFO - 07/08/25 21:08:38 - 0:55:32 - Epoch 161/200 | Step 4347 |  Avg Test Loss: 0.3878 | Test ROC-AUC: 0.9124
DEBUG - 07/08/25 21:08:38 - 0:55:32 - Epoch 161
INFO - 07/08/25 21:08:58 - 0:55:52 - Epoch 162/200 | Step 4374 |  Avg Test Loss: 0.3991 | Test ROC-AUC: 0.9144
DEBUG - 07/08/25 21:08:58 - 0:55:52 - Epoch 162
INFO - 07/08/25 21:09:18 - 0:56:12 - Epoch 163/200 | Step 4401 |  Avg Test Loss: 0.3886 | Test ROC-AUC: 0.9085
DEBUG - 07/08/25 21:09:18 - 0:56:12 - Epoch 163
INFO - 07/08/25 21:09:38 - 0:56:32 - Epoch 164/200 | Step 4428 |  Avg Test Loss: 0.3868 | Test ROC-AUC: 0.9146
DEBUG - 07/08/25 21:09:38 - 0:56:32 - Epoch 164
INFO - 07/08/25 21:09:58 - 0:56:52 - Epoch 165/200 | Step 4455 |  Avg Test Loss: 0.3886 | Test ROC-AUC: 0.9141
DEBUG - 07/08/25 21:09:58 - 0:56:52 - Epoch 165
INFO - 07/08/25 21:10:18 - 0:57:12 - Epoch 166/200 | Step 4482 |  Avg Test Loss: 0.3903 | Test ROC-AUC: 0.9100
DEBUG - 07/08/25 21:10:18 - 0:57:12 - Epoch 166
INFO - 07/08/25 21:10:38 - 0:57:32 - Epoch 167/200 | Step 4509 |  Avg Test Loss: 0.3944 | Test ROC-AUC: 0.9091
DEBUG - 07/08/25 21:10:38 - 0:57:32 - Epoch 167
INFO - 07/08/25 21:10:58 - 0:57:53 - Epoch 168/200 | Step 4536 |  Avg Test Loss: 0.3802 | Test ROC-AUC: 0.9085
DEBUG - 07/08/25 21:10:58 - 0:57:53 - Epoch 168
INFO - 07/08/25 21:11:18 - 0:58:12 - Epoch 169/200 | Step 4563 |  Avg Test Loss: 0.3811 | Test ROC-AUC: 0.9094
DEBUG - 07/08/25 21:11:18 - 0:58:13 - Epoch 169
INFO - 07/08/25 21:11:38 - 0:58:32 - Epoch 170/200 | Step 4590 |  Avg Test Loss: 0.4043 | Test ROC-AUC: 0.9106
DEBUG - 07/08/25 21:11:38 - 0:58:32 - Epoch 170
INFO - 07/08/25 21:11:58 - 0:58:52 - Epoch 171/200 | Step 4617 |  Avg Test Loss: 0.3971 | Test ROC-AUC: 0.9167
DEBUG - 07/08/25 21:11:58 - 0:58:52 - Epoch 171
INFO - 07/08/25 21:12:18 - 0:59:12 - Epoch 172/200 | Step 4644 |  Avg Test Loss: 0.3946 | Test ROC-AUC: 0.9139
DEBUG - 07/08/25 21:12:18 - 0:59:12 - Epoch 172
INFO - 07/08/25 21:12:38 - 0:59:32 - Epoch 173/200 | Step 4671 |  Avg Test Loss: 0.3788 | Test ROC-AUC: 0.9089
DEBUG - 07/08/25 21:12:38 - 0:59:32 - Epoch 173
INFO - 07/08/25 21:12:58 - 0:59:52 - Epoch 174/200 | Step 4698 |  Avg Test Loss: 0.3854 | Test ROC-AUC: 0.9130
DEBUG - 07/08/25 21:12:58 - 0:59:52 - Epoch 174
INFO - 07/08/25 21:13:18 - 1:00:12 - Epoch 175/200 | Step 4725 |  Avg Test Loss: 0.4277 | Test ROC-AUC: 0.9117
DEBUG - 07/08/25 21:13:18 - 1:00:12 - Epoch 175
INFO - 07/08/25 21:13:38 - 1:00:32 - Epoch 176/200 | Step 4752 |  Avg Test Loss: 0.3808 | Test ROC-AUC: 0.9072
DEBUG - 07/08/25 21:13:38 - 1:00:32 - Epoch 176
INFO - 07/08/25 21:13:58 - 1:00:52 - Epoch 177/200 | Step 4779 |  Avg Test Loss: 0.4030 | Test ROC-AUC: 0.9076
DEBUG - 07/08/25 21:13:58 - 1:00:52 - Epoch 177
INFO - 07/08/25 21:14:18 - 1:01:12 - Epoch 178/200 | Step 4806 |  Avg Test Loss: 0.4051 | Test ROC-AUC: 0.9081
DEBUG - 07/08/25 21:14:18 - 1:01:12 - Epoch 178
INFO - 07/08/25 21:14:38 - 1:01:32 - Epoch 179/200 | Step 4833 |  Avg Test Loss: 0.4159 | Test ROC-AUC: 0.9113
DEBUG - 07/08/25 21:14:38 - 1:01:32 - Epoch 179
INFO - 07/08/25 21:14:58 - 1:01:52 - Epoch 180/200 | Step 4860 |  Avg Test Loss: 0.3923 | Test ROC-AUC: 0.9113
DEBUG - 07/08/25 21:14:58 - 1:01:52 - Epoch 180
INFO - 07/08/25 21:15:18 - 1:02:12 - Epoch 181/200 | Step 4887 |  Avg Test Loss: 0.3910 | Test ROC-AUC: 0.9128
DEBUG - 07/08/25 21:15:18 - 1:02:12 - Epoch 181
INFO - 07/08/25 21:15:38 - 1:02:32 - Epoch 182/200 | Step 4914 |  Avg Test Loss: 0.3837 | Test ROC-AUC: 0.9089
DEBUG - 07/08/25 21:15:38 - 1:02:32 - Epoch 182
INFO - 07/08/25 21:15:58 - 1:02:52 - Epoch 183/200 | Step 4941 |  Avg Test Loss: 0.3974 | Test ROC-AUC: 0.9137
DEBUG - 07/08/25 21:15:58 - 1:02:52 - Epoch 183
INFO - 07/08/25 21:16:18 - 1:03:12 - Epoch 184/200 | Step 4968 |  Avg Test Loss: 0.3903 | Test ROC-AUC: 0.9126
DEBUG - 07/08/25 21:16:18 - 1:03:12 - Epoch 184
INFO - 07/08/25 21:16:38 - 1:03:32 - Epoch 185/200 | Step 4995 |  Avg Test Loss: 0.3774 | Test ROC-AUC: 0.9152
DEBUG - 07/08/25 21:16:38 - 1:03:32 - Epoch 185
INFO - 07/08/25 21:16:58 - 1:03:52 - Epoch 186/200 | Step 5022 |  Avg Test Loss: 0.3728 | Test ROC-AUC: 0.9148
DEBUG - 07/08/25 21:16:58 - 1:03:52 - Epoch 186
INFO - 07/08/25 21:17:18 - 1:04:12 - Epoch 187/200 | Step 5049 |  Avg Test Loss: 0.4200 | Test ROC-AUC: 0.9144
DEBUG - 07/08/25 21:17:18 - 1:04:12 - Epoch 187
INFO - 07/08/25 21:17:38 - 1:04:32 - Epoch 188/200 | Step 5076 |  Avg Test Loss: 0.4270 | Test ROC-AUC: 0.9200
DEBUG - 07/08/25 21:17:38 - 1:04:32 - Epoch 188
INFO - 07/08/25 21:17:58 - 1:04:52 - Epoch 189/200 | Step 5103 |  Avg Test Loss: 0.4002 | Test ROC-AUC: 0.9169
DEBUG - 07/08/25 21:17:58 - 1:04:52 - Epoch 189
INFO - 07/08/25 21:18:18 - 1:05:12 - Epoch 190/200 | Step 5130 |  Avg Test Loss: 0.3744 | Test ROC-AUC: 0.9137
DEBUG - 07/08/25 21:18:18 - 1:05:12 - Epoch 190
INFO - 07/08/25 21:18:38 - 1:05:32 - Epoch 191/200 | Step 5157 |  Avg Test Loss: 0.3675 | Test ROC-AUC: 0.9163
DEBUG - 07/08/25 21:18:38 - 1:05:32 - Epoch 191
INFO - 07/08/25 21:18:58 - 1:05:52 - Epoch 192/200 | Step 5184 |  Avg Test Loss: 0.3946 | Test ROC-AUC: 0.9180
DEBUG - 07/08/25 21:18:58 - 1:05:52 - Epoch 192
INFO - 07/08/25 21:19:18 - 1:06:12 - Epoch 193/200 | Step 5211 |  Avg Test Loss: 0.3719 | Test ROC-AUC: 0.9146
DEBUG - 07/08/25 21:19:18 - 1:06:12 - Epoch 193
INFO - 07/08/25 21:19:38 - 1:06:32 - Epoch 194/200 | Step 5238 |  Avg Test Loss: 0.3676 | Test ROC-AUC: 0.9154
DEBUG - 07/08/25 21:19:38 - 1:06:32 - Epoch 194
INFO - 07/08/25 21:19:58 - 1:06:52 - Epoch 195/200 | Step 5265 |  Avg Test Loss: 0.4002 | Test ROC-AUC: 0.9085
DEBUG - 07/08/25 21:19:58 - 1:06:52 - Epoch 195
INFO - 07/08/25 21:20:18 - 1:07:12 - Epoch 196/200 | Step 5292 |  Avg Test Loss: 0.3827 | Test ROC-AUC: 0.9128
DEBUG - 07/08/25 21:20:18 - 1:07:12 - Epoch 196
INFO - 07/08/25 21:20:38 - 1:07:32 - Epoch 197/200 | Step 5319 |  Avg Test Loss: 0.3996 | Test ROC-AUC: 0.9100
DEBUG - 07/08/25 21:20:38 - 1:07:32 - Epoch 197
INFO - 07/08/25 21:20:58 - 1:07:52 - Epoch 198/200 | Step 5346 |  Avg Test Loss: 0.4229 | Test ROC-AUC: 0.9135
DEBUG - 07/08/25 21:20:58 - 1:07:52 - Epoch 198
INFO - 07/08/25 21:21:18 - 1:08:12 - Epoch 199/200 | Step 5373 |  Avg Test Loss: 0.3654 | Test ROC-AUC: 0.9120
DEBUG - 07/08/25 21:21:18 - 1:08:12 - Epoch 199
INFO - 07/08/25 21:21:38 - 1:08:32 - Epoch 200/200 | Step 5400 |  Avg Test Loss: 0.3735 | Test ROC-AUC: 0.9096
