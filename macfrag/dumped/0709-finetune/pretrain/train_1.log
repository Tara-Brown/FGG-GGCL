INFO - 07/09/25 12:23:19 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 12:23:19 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/clintox/clintox.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 300
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/clintox
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 12:23:19 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 12:23:19 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 12:23:19 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 12:23:19 - 0:00:00 - Loading data
DEBUG - 07/09/25 12:23:19 - 0:00:00 - Total size = 1478
DEBUG - 07/09/25 12:23:19 - 0:00:00 - Building model 0
DEBUG - 07/09/25 12:23:21 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 12:23:21 - 0:00:03 - Number of M1 parameters = 4,254,754
DEBUG - 07/09/25 12:23:21 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 12:23:21 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 75, heads=4)
                                              (1-2): 2 x GATConv(300, 75, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 75, heads=4)
                                                (1-2): 2 x GATConv(300, 75, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=300, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=300, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=300, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=300, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): BatchNorm1d(600, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=300, out_features=600, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=600, out_features=300, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=300, out_features=300, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=300, out_features=300, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=300, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=300, out_features=300, bias=True)
                                              (key): Linear(in_features=300, out_features=300, bias=True)
                                              (value): Linear(in_features=300, out_features=300, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 12:23:21 - 0:00:03 - Number of M2 parameters = 3,514,451
DEBUG - 07/09/25 12:23:21 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 12:23:21 - 0:00:03 - Epoch 0
INFO - 07/09/25 12:25:12 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 12:25:12 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/clintox/clintox.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/clintox
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 12:25:12 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 12:25:12 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 12:25:12 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 12:25:12 - 0:00:00 - Loading data
DEBUG - 07/09/25 12:25:12 - 0:00:00 - Total size = 1478
DEBUG - 07/09/25 12:25:12 - 0:00:00 - Building model 0
DEBUG - 07/09/25 12:25:15 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 12:25:15 - 0:00:03 - Number of M1 parameters = 4,254,754
DEBUG - 07/09/25 12:25:15 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 12:25:15 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 12:25:15 - 0:00:03 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 12:25:15 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 12:25:15 - 0:00:03 - Epoch 0
INFO - 07/09/25 12:25:48 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 12:25:48 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 12:25:48 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 12:25:48 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 12:25:48 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 12:25:48 - 0:00:00 - Loading data
DEBUG - 07/09/25 12:25:49 - 0:00:00 - Total size = 1513
DEBUG - 07/09/25 12:25:49 - 0:00:00 - Building model 0
DEBUG - 07/09/25 12:25:50 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 12:25:50 - 0:00:02 - Number of M1 parameters = 4,254,754
DEBUG - 07/09/25 12:25:50 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 12:25:50 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 12:25:50 - 0:00:02 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 12:25:50 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 12:25:50 - 0:00:02 - Epoch 0
INFO - 07/09/25 12:26:29 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 12:26:29 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 2
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 12:26:29 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 12:26:29 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 12:26:29 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 12:26:29 - 0:00:00 - Loading data
DEBUG - 07/09/25 12:26:29 - 0:00:00 - Total size = 1513
DEBUG - 07/09/25 12:26:29 - 0:00:00 - Building model 0
DEBUG - 07/09/25 12:26:30 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=2, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 12:26:30 - 0:00:02 - Number of M1 parameters = 4,255,255
DEBUG - 07/09/25 12:26:30 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 12:26:30 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 12:26:30 - 0:00:02 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 12:26:30 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 12:26:31 - 0:00:02 - Epoch 0
INFO - 07/09/25 12:31:53 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 12:31:53 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 2
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 12:31:53 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 12:31:53 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 12:31:53 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 12:31:53 - 0:00:00 - Loading data
DEBUG - 07/09/25 12:31:53 - 0:00:00 - Total data size = 1513
INFO - 07/09/25 12:32:23 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 12:32:23 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 12:32:23 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 12:32:23 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 12:32:23 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 12:32:23 - 0:00:00 - Loading data
DEBUG - 07/09/25 12:32:23 - 0:00:00 - Total data size = 1513
INFO - 07/09/25 12:33:06 - 0:00:44 - [Epoch 1] Loss: 2.2604 | ROC-AUC: 0.5951 | Best AUC: -inf
INFO - 07/09/25 12:33:50 - 0:01:27 - [Epoch 2] Loss: 1.7782 | ROC-AUC: 0.6157 | Best AUC: 0.5951
INFO - 07/09/25 12:34:22 - 0:01:59 - [Epoch 3] Loss: 1.6812 | ROC-AUC: 0.6207 | Best AUC: 0.6157
INFO - 07/09/25 12:34:56 - 0:02:33 - [Epoch 4] Loss: 1.6319 | ROC-AUC: 0.6343 | Best AUC: 0.6207
INFO - 07/09/25 12:35:25 - 0:03:03 - [Epoch 5] Loss: 1.5431 | ROC-AUC: 0.6819 | Best AUC: 0.6343
INFO - 07/09/25 12:35:51 - 0:03:28 - [Epoch 6] Loss: 1.4900 | ROC-AUC: 0.7334 | Best AUC: 0.6819
INFO - 07/09/25 12:36:15 - 0:03:52 - [Epoch 7] Loss: 1.4274 | ROC-AUC: 0.7530 | Best AUC: 0.7334
INFO - 07/09/25 12:36:38 - 0:04:16 - [Epoch 8] Loss: 1.3694 | ROC-AUC: 0.7610 | Best AUC: 0.7530
INFO - 07/09/25 12:37:00 - 0:04:38 - [Epoch 9] Loss: 1.2994 | ROC-AUC: 0.7465 | Best AUC: 0.7610
INFO - 07/09/25 12:37:53 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 12:37:53 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 12:37:53 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 12:37:53 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 12:37:53 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 12:37:53 - 0:00:00 - Loading data
DEBUG - 07/09/25 12:37:54 - 0:00:00 - Total size = 1513
DEBUG - 07/09/25 12:37:54 - 0:00:00 - Building model 0
DEBUG - 07/09/25 12:37:55 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 12:37:55 - 0:00:02 - Number of M1 parameters = 4,254,754
DEBUG - 07/09/25 12:37:55 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 12:37:55 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 12:37:55 - 0:00:02 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 12:37:55 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 12:37:55 - 0:00:02 - Epoch 0
INFO - 07/09/25 12:38:30 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 12:38:30 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 12:38:30 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 12:38:30 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 12:38:30 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 12:38:30 - 0:00:00 - Loading data
DEBUG - 07/09/25 12:38:31 - 0:00:00 - Total size = 1513
DEBUG - 07/09/25 12:38:31 - 0:00:00 - Building model 0
DEBUG - 07/09/25 12:38:32 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 12:38:32 - 0:00:02 - Number of M1 parameters = 4,254,754
DEBUG - 07/09/25 12:38:32 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 12:38:32 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 12:38:32 - 0:00:02 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 12:38:32 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 12:38:32 - 0:00:02 - Epoch 0
INFO - 07/09/25 12:38:56 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 12:38:56 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 12:38:56 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 12:38:56 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 12:38:56 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 12:38:56 - 0:00:00 - Loading data
DEBUG - 07/09/25 12:38:56 - 0:00:00 - Total size = 1513
DEBUG - 07/09/25 12:38:56 - 0:00:00 - Building model 0
DEBUG - 07/09/25 12:38:58 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 12:38:58 - 0:00:02 - Number of M1 parameters = 4,254,754
DEBUG - 07/09/25 12:38:58 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 12:38:58 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 12:38:58 - 0:00:02 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 12:38:58 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 12:38:58 - 0:00:02 - Epoch 0
INFO - 07/09/25 12:39:24 - 0:00:27 - Epoch 1/200 | Step 42 |  Avg Test Loss: 2.3504 | Test ROC-AUC: 0.5924
DEBUG - 07/09/25 12:39:24 - 0:00:27 - Epoch 1
INFO - 07/09/25 12:39:47 - 0:00:51 - Epoch 2/200 | Step 84 |  Avg Test Loss: 1.8082 | Test ROC-AUC: 0.5993
DEBUG - 07/09/25 12:39:47 - 0:00:51 - Epoch 2
INFO - 07/09/25 12:40:09 - 0:01:13 - Epoch 3/200 | Step 126 |  Avg Test Loss: 1.6741 | Test ROC-AUC: 0.6183
DEBUG - 07/09/25 12:40:10 - 0:01:13 - Epoch 3
INFO - 07/09/25 12:40:31 - 0:01:35 - Epoch 4/200 | Step 168 |  Avg Test Loss: 1.6083 | Test ROC-AUC: 0.6501
DEBUG - 07/09/25 12:40:31 - 0:01:35 - Epoch 4
INFO - 07/09/25 12:40:53 - 0:01:57 - Epoch 5/200 | Step 210 |  Avg Test Loss: 1.5544 | Test ROC-AUC: 0.7375
DEBUG - 07/09/25 12:40:53 - 0:01:57 - Epoch 5
INFO - 07/09/25 12:41:16 - 0:02:20 - Epoch 6/200 | Step 252 |  Avg Test Loss: 1.4772 | Test ROC-AUC: 0.7360
DEBUG - 07/09/25 12:41:16 - 0:02:20 - Epoch 6
INFO - 07/09/25 12:41:39 - 0:02:42 - Epoch 7/200 | Step 294 |  Avg Test Loss: 1.4181 | Test ROC-AUC: 0.7473
DEBUG - 07/09/25 12:41:39 - 0:02:42 - Epoch 7
INFO - 07/09/25 12:42:02 - 0:03:05 - Epoch 8/200 | Step 336 |  Avg Test Loss: 1.4694 | Test ROC-AUC: 0.7316
DEBUG - 07/09/25 12:42:02 - 0:03:06 - Epoch 8
INFO - 07/09/25 12:42:24 - 0:03:28 - Epoch 9/200 | Step 378 |  Avg Test Loss: 1.2642 | Test ROC-AUC: 0.7626
DEBUG - 07/09/25 12:42:24 - 0:03:28 - Epoch 9
INFO - 07/09/25 12:42:48 - 0:03:52 - Epoch 10/200 | Step 420 |  Avg Test Loss: 1.2097 | Test ROC-AUC: 0.7582
DEBUG - 07/09/25 12:42:48 - 0:03:52 - Epoch 10
INFO - 07/09/25 12:43:11 - 0:04:15 - Epoch 11/200 | Step 462 |  Avg Test Loss: 1.1464 | Test ROC-AUC: 0.7658
DEBUG - 07/09/25 12:43:11 - 0:04:15 - Epoch 11
INFO - 07/09/25 12:43:33 - 0:04:37 - Epoch 12/200 | Step 504 |  Avg Test Loss: 1.0539 | Test ROC-AUC: 0.7680
DEBUG - 07/09/25 12:43:33 - 0:04:37 - Epoch 12
INFO - 07/09/25 12:43:55 - 0:04:59 - Epoch 13/200 | Step 546 |  Avg Test Loss: 1.0876 | Test ROC-AUC: 0.7607
DEBUG - 07/09/25 12:43:55 - 0:04:59 - Epoch 13
INFO - 07/09/25 12:44:17 - 0:05:21 - Epoch 14/200 | Step 588 |  Avg Test Loss: 0.9192 | Test ROC-AUC: 0.7814
DEBUG - 07/09/25 12:44:17 - 0:05:21 - Epoch 14
INFO - 07/09/25 12:44:38 - 0:05:42 - Epoch 15/200 | Step 630 |  Avg Test Loss: 0.9098 | Test ROC-AUC: 0.7714
DEBUG - 07/09/25 12:44:39 - 0:05:42 - Epoch 15
INFO - 07/09/25 12:45:02 - 0:06:06 - Epoch 16/200 | Step 672 |  Avg Test Loss: 0.8268 | Test ROC-AUC: 0.7790
DEBUG - 07/09/25 12:45:02 - 0:06:06 - Epoch 16
INFO - 07/09/25 12:45:26 - 0:06:29 - Epoch 17/200 | Step 714 |  Avg Test Loss: 0.8351 | Test ROC-AUC: 0.7819
DEBUG - 07/09/25 12:45:26 - 0:06:29 - Epoch 17
INFO - 07/09/25 12:45:48 - 0:06:52 - Epoch 18/200 | Step 756 |  Avg Test Loss: 0.7986 | Test ROC-AUC: 0.7841
DEBUG - 07/09/25 12:45:48 - 0:06:52 - Epoch 18
INFO - 07/09/25 12:46:10 - 0:07:14 - Epoch 19/200 | Step 798 |  Avg Test Loss: 0.7619 | Test ROC-AUC: 0.7866
DEBUG - 07/09/25 12:46:11 - 0:07:14 - Epoch 19
INFO - 07/09/25 12:46:34 - 0:07:38 - Epoch 20/200 | Step 840 |  Avg Test Loss: 0.7474 | Test ROC-AUC: 0.7875
DEBUG - 07/09/25 12:46:34 - 0:07:38 - Epoch 20
INFO - 07/09/25 12:46:58 - 0:08:02 - Epoch 21/200 | Step 882 |  Avg Test Loss: 0.7299 | Test ROC-AUC: 0.7990
DEBUG - 07/09/25 12:46:58 - 0:08:02 - Epoch 21
INFO - 07/09/25 12:47:20 - 0:08:24 - Epoch 22/200 | Step 924 |  Avg Test Loss: 0.7317 | Test ROC-AUC: 0.7922
DEBUG - 07/09/25 12:47:20 - 0:08:24 - Epoch 22
INFO - 07/09/25 12:47:44 - 0:08:48 - Epoch 23/200 | Step 966 |  Avg Test Loss: 0.7463 | Test ROC-AUC: 0.8029
DEBUG - 07/09/25 12:47:44 - 0:08:48 - Epoch 23
INFO - 07/09/25 12:48:08 - 0:09:12 - Epoch 24/200 | Step 1008 |  Avg Test Loss: 0.7227 | Test ROC-AUC: 0.8078
DEBUG - 07/09/25 12:48:08 - 0:09:12 - Epoch 24
INFO - 07/09/25 12:48:29 - 0:09:33 - Epoch 25/200 | Step 1050 |  Avg Test Loss: 0.6547 | Test ROC-AUC: 0.8154
DEBUG - 07/09/25 12:48:30 - 0:09:33 - Epoch 25
INFO - 07/09/25 12:48:52 - 0:09:56 - Epoch 26/200 | Step 1092 |  Avg Test Loss: 0.6749 | Test ROC-AUC: 0.8137
DEBUG - 07/09/25 12:48:52 - 0:09:56 - Epoch 26
INFO - 07/09/25 12:49:14 - 0:10:18 - Epoch 27/200 | Step 1134 |  Avg Test Loss: 0.6741 | Test ROC-AUC: 0.8208
DEBUG - 07/09/25 12:49:15 - 0:10:18 - Epoch 27
INFO - 07/09/25 12:49:38 - 0:10:42 - Epoch 28/200 | Step 1176 |  Avg Test Loss: 0.6553 | Test ROC-AUC: 0.8161
DEBUG - 07/09/25 12:49:38 - 0:10:42 - Epoch 28
INFO - 07/09/25 12:50:01 - 0:11:05 - Epoch 29/200 | Step 1218 |  Avg Test Loss: 0.6551 | Test ROC-AUC: 0.8159
DEBUG - 07/09/25 12:50:01 - 0:11:05 - Epoch 29
INFO - 07/09/25 12:50:24 - 0:11:27 - Epoch 30/200 | Step 1260 |  Avg Test Loss: 0.6352 | Test ROC-AUC: 0.8256
DEBUG - 07/09/25 12:50:24 - 0:11:28 - Epoch 30
INFO - 07/09/25 12:50:47 - 0:11:51 - Epoch 31/200 | Step 1302 |  Avg Test Loss: 0.6282 | Test ROC-AUC: 0.8300
DEBUG - 07/09/25 12:50:47 - 0:11:51 - Epoch 31
INFO - 07/09/25 12:51:11 - 0:12:15 - Epoch 32/200 | Step 1344 |  Avg Test Loss: 0.6162 | Test ROC-AUC: 0.8259
DEBUG - 07/09/25 12:51:11 - 0:12:15 - Epoch 32
INFO - 07/09/25 12:51:34 - 0:12:38 - Epoch 33/200 | Step 1386 |  Avg Test Loss: 0.6147 | Test ROC-AUC: 0.8298
DEBUG - 07/09/25 12:51:34 - 0:12:38 - Epoch 33
INFO - 07/09/25 12:51:56 - 0:13:00 - Epoch 34/200 | Step 1428 |  Avg Test Loss: 0.6316 | Test ROC-AUC: 0.8242
DEBUG - 07/09/25 12:51:56 - 0:13:00 - Epoch 34
INFO - 07/09/25 12:52:18 - 0:13:22 - Epoch 35/200 | Step 1470 |  Avg Test Loss: 0.6148 | Test ROC-AUC: 0.8371
DEBUG - 07/09/25 12:52:18 - 0:13:22 - Epoch 35
INFO - 07/09/25 12:52:40 - 0:13:44 - Epoch 36/200 | Step 1512 |  Avg Test Loss: 0.6063 | Test ROC-AUC: 0.8400
DEBUG - 07/09/25 12:52:40 - 0:13:44 - Epoch 36
INFO - 07/09/25 12:53:03 - 0:14:07 - Epoch 37/200 | Step 1554 |  Avg Test Loss: 0.5689 | Test ROC-AUC: 0.8503
DEBUG - 07/09/25 12:53:03 - 0:14:07 - Epoch 37
INFO - 07/09/25 12:53:23 - 0:14:27 - Epoch 38/200 | Step 1596 |  Avg Test Loss: 0.5963 | Test ROC-AUC: 0.8405
DEBUG - 07/09/25 12:53:23 - 0:14:27 - Epoch 38
INFO - 07/09/25 12:53:43 - 0:14:46 - Epoch 39/200 | Step 1638 |  Avg Test Loss: 0.5616 | Test ROC-AUC: 0.8422
DEBUG - 07/09/25 12:53:43 - 0:14:46 - Epoch 39
INFO - 07/09/25 12:54:02 - 0:15:06 - Epoch 40/200 | Step 1680 |  Avg Test Loss: 0.5533 | Test ROC-AUC: 0.8510
DEBUG - 07/09/25 12:54:02 - 0:15:06 - Epoch 40
INFO - 07/09/25 12:54:21 - 0:15:25 - Epoch 41/200 | Step 1722 |  Avg Test Loss: 0.5329 | Test ROC-AUC: 0.8571
DEBUG - 07/09/25 12:54:21 - 0:15:25 - Epoch 41
INFO - 07/09/25 12:54:41 - 0:15:44 - Epoch 42/200 | Step 1764 |  Avg Test Loss: 0.6966 | Test ROC-AUC: 0.8501
DEBUG - 07/09/25 12:54:41 - 0:15:45 - Epoch 42
INFO - 07/09/25 12:55:00 - 0:16:04 - Epoch 43/200 | Step 1806 |  Avg Test Loss: 0.5831 | Test ROC-AUC: 0.8520
DEBUG - 07/09/25 12:55:00 - 0:16:04 - Epoch 43
INFO - 07/09/25 12:55:19 - 0:16:23 - Epoch 44/200 | Step 1848 |  Avg Test Loss: 0.5531 | Test ROC-AUC: 0.8579
DEBUG - 07/09/25 12:55:19 - 0:16:23 - Epoch 44
INFO - 07/09/25 12:55:39 - 0:16:43 - Epoch 45/200 | Step 1890 |  Avg Test Loss: 0.6266 | Test ROC-AUC: 0.8542
DEBUG - 07/09/25 12:55:39 - 0:16:43 - Epoch 45
INFO - 07/09/25 12:55:58 - 0:17:02 - Epoch 46/200 | Step 1932 |  Avg Test Loss: 0.5436 | Test ROC-AUC: 0.8562
DEBUG - 07/09/25 12:55:58 - 0:17:02 - Epoch 46
INFO - 07/09/25 12:56:18 - 0:17:21 - Epoch 47/200 | Step 1974 |  Avg Test Loss: 0.5363 | Test ROC-AUC: 0.8733
DEBUG - 07/09/25 12:56:18 - 0:17:21 - Epoch 47
INFO - 07/09/25 12:56:37 - 0:17:41 - Epoch 48/200 | Step 2016 |  Avg Test Loss: 0.5429 | Test ROC-AUC: 0.8611
DEBUG - 07/09/25 12:56:37 - 0:17:41 - Epoch 48
INFO - 07/09/25 12:56:56 - 0:18:00 - Epoch 49/200 | Step 2058 |  Avg Test Loss: 0.5125 | Test ROC-AUC: 0.8662
DEBUG - 07/09/25 12:56:57 - 0:18:00 - Epoch 49
INFO - 07/09/25 12:57:16 - 0:18:20 - Epoch 50/200 | Step 2100 |  Avg Test Loss: 0.4991 | Test ROC-AUC: 0.8672
DEBUG - 07/09/25 12:57:16 - 0:18:20 - Epoch 50
INFO - 07/09/25 12:57:44 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 12:57:44 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/clintox/clintox.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 2
                                     path: /home/cassie/macfrag/data/clintox
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 12:57:44 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 12:57:44 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 12:57:44 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 12:57:44 - 0:00:00 - Loading data
DEBUG - 07/09/25 12:57:44 - 0:00:00 - Total size = 1478
DEBUG - 07/09/25 12:57:44 - 0:00:00 - Building model 0
DEBUG - 07/09/25 12:57:46 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=2, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 12:57:46 - 0:00:03 - Number of M1 parameters = 4,255,255
DEBUG - 07/09/25 12:57:46 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 12:57:46 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 12:57:46 - 0:00:03 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 12:57:46 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 12:57:46 - 0:00:03 - Epoch 0
INFO - 07/09/25 12:58:02 - 0:00:19 - Epoch 1/200 | Step 41 |  Avg Test Loss: 2.0663 | Test ROC-AUC: 0.4885
DEBUG - 07/09/25 12:58:02 - 0:00:19 - Epoch 1
INFO - 07/09/25 12:58:17 - 0:00:33 - Epoch 2/200 | Step 82 |  Avg Test Loss: 1.5274 | Test ROC-AUC: 0.4745
DEBUG - 07/09/25 12:58:17 - 0:00:34 - Epoch 2
INFO - 07/09/25 12:58:32 - 0:00:48 - Epoch 3/200 | Step 123 |  Avg Test Loss: 1.4176 | Test ROC-AUC: 0.4505
DEBUG - 07/09/25 12:58:32 - 0:00:48 - Epoch 3
INFO - 07/09/25 12:58:47 - 0:01:03 - Epoch 4/200 | Step 164 |  Avg Test Loss: 1.3462 | Test ROC-AUC: 0.4313
DEBUG - 07/09/25 12:58:47 - 0:01:03 - Epoch 4
INFO - 07/09/25 12:59:01 - 0:01:18 - Epoch 5/200 | Step 205 |  Avg Test Loss: 1.2665 | Test ROC-AUC: 0.4286
DEBUG - 07/09/25 12:59:02 - 0:01:18 - Epoch 5
INFO - 07/09/25 12:59:16 - 0:01:33 - Epoch 6/200 | Step 246 |  Avg Test Loss: 1.1665 | Test ROC-AUC: 0.4031
DEBUG - 07/09/25 12:59:16 - 0:01:33 - Epoch 6
INFO - 07/09/25 12:59:31 - 0:01:47 - Epoch 7/200 | Step 287 |  Avg Test Loss: 1.0208 | Test ROC-AUC: 0.4167
DEBUG - 07/09/25 12:59:31 - 0:01:48 - Epoch 7
INFO - 07/09/25 12:59:46 - 0:02:02 - Epoch 8/200 | Step 328 |  Avg Test Loss: 0.9194 | Test ROC-AUC: 0.4818
DEBUG - 07/09/25 12:59:46 - 0:02:02 - Epoch 8
INFO - 07/09/25 13:00:01 - 0:02:17 - Epoch 9/200 | Step 369 |  Avg Test Loss: 0.7787 | Test ROC-AUC: 0.4828
DEBUG - 07/09/25 13:00:01 - 0:02:17 - Epoch 9
INFO - 07/09/25 13:00:15 - 0:02:32 - Epoch 10/200 | Step 410 |  Avg Test Loss: 0.7193 | Test ROC-AUC: 0.5068
DEBUG - 07/09/25 13:00:15 - 0:02:32 - Epoch 10
INFO - 07/09/25 13:00:30 - 0:02:47 - Epoch 11/200 | Step 451 |  Avg Test Loss: 0.6669 | Test ROC-AUC: 0.5875
DEBUG - 07/09/25 13:00:30 - 0:02:47 - Epoch 11
INFO - 07/09/25 13:00:45 - 0:03:01 - Epoch 12/200 | Step 492 |  Avg Test Loss: 0.5704 | Test ROC-AUC: 0.5542
DEBUG - 07/09/25 13:00:45 - 0:03:01 - Epoch 12
INFO - 07/09/25 13:01:00 - 0:03:16 - Epoch 13/200 | Step 533 |  Avg Test Loss: 0.5607 | Test ROC-AUC: 0.5776
DEBUG - 07/09/25 13:01:00 - 0:03:16 - Epoch 13
INFO - 07/09/25 13:01:15 - 0:03:31 - Epoch 14/200 | Step 574 |  Avg Test Loss: 0.4849 | Test ROC-AUC: 0.5870
DEBUG - 07/09/25 13:01:15 - 0:03:31 - Epoch 14
INFO - 07/09/25 13:01:29 - 0:03:46 - Epoch 15/200 | Step 615 |  Avg Test Loss: 0.4650 | Test ROC-AUC: 0.6328
DEBUG - 07/09/25 13:01:29 - 0:03:46 - Epoch 15
INFO - 07/09/25 13:01:44 - 0:04:00 - Epoch 16/200 | Step 656 |  Avg Test Loss: 0.4439 | Test ROC-AUC: 0.6115
DEBUG - 07/09/25 13:01:44 - 0:04:00 - Epoch 16
INFO - 07/09/25 13:01:59 - 0:04:15 - Epoch 17/200 | Step 697 |  Avg Test Loss: 0.4115 | Test ROC-AUC: 0.6438
DEBUG - 07/09/25 13:01:59 - 0:04:15 - Epoch 17
INFO - 07/09/25 13:02:13 - 0:04:30 - Epoch 18/200 | Step 738 |  Avg Test Loss: 0.3828 | Test ROC-AUC: 0.6536
DEBUG - 07/09/25 13:02:14 - 0:04:30 - Epoch 18
INFO - 07/09/25 13:02:28 - 0:04:45 - Epoch 19/200 | Step 779 |  Avg Test Loss: 0.3792 | Test ROC-AUC: 0.6510
DEBUG - 07/09/25 13:02:28 - 0:04:45 - Epoch 19
INFO - 07/09/25 13:02:43 - 0:05:00 - Epoch 20/200 | Step 820 |  Avg Test Loss: 0.3563 | Test ROC-AUC: 0.6719
DEBUG - 07/09/25 13:02:43 - 0:05:00 - Epoch 20
INFO - 07/09/25 13:02:58 - 0:05:14 - Epoch 21/200 | Step 861 |  Avg Test Loss: 0.3409 | Test ROC-AUC: 0.6802
DEBUG - 07/09/25 13:02:58 - 0:05:15 - Epoch 21
INFO - 07/09/25 13:03:13 - 0:05:29 - Epoch 22/200 | Step 902 |  Avg Test Loss: 0.3321 | Test ROC-AUC: 0.6740
DEBUG - 07/09/25 13:03:13 - 0:05:29 - Epoch 22
INFO - 07/09/25 13:03:27 - 0:05:44 - Epoch 23/200 | Step 943 |  Avg Test Loss: 0.3459 | Test ROC-AUC: 0.6833
DEBUG - 07/09/25 13:03:27 - 0:05:44 - Epoch 23
INFO - 07/09/25 13:03:42 - 0:05:59 - Epoch 24/200 | Step 984 |  Avg Test Loss: 0.3256 | Test ROC-AUC: 0.6745
DEBUG - 07/09/25 13:03:42 - 0:05:59 - Epoch 24
INFO - 07/09/25 13:03:57 - 0:06:13 - Epoch 25/200 | Step 1025 |  Avg Test Loss: 0.3298 | Test ROC-AUC: 0.7490
DEBUG - 07/09/25 13:03:57 - 0:06:13 - Epoch 25
INFO - 07/09/25 13:04:12 - 0:06:28 - Epoch 26/200 | Step 1066 |  Avg Test Loss: 0.3017 | Test ROC-AUC: 0.7625
DEBUG - 07/09/25 13:04:12 - 0:06:28 - Epoch 26
INFO - 07/09/25 13:04:26 - 0:06:43 - Epoch 27/200 | Step 1107 |  Avg Test Loss: 0.2932 | Test ROC-AUC: 0.7042
DEBUG - 07/09/25 13:04:26 - 0:06:43 - Epoch 27
INFO - 07/09/25 13:04:41 - 0:06:58 - Epoch 28/200 | Step 1148 |  Avg Test Loss: 0.2840 | Test ROC-AUC: 0.6979
DEBUG - 07/09/25 13:04:41 - 0:06:58 - Epoch 28
INFO - 07/09/25 13:04:56 - 0:07:12 - Epoch 29/200 | Step 1189 |  Avg Test Loss: 0.3082 | Test ROC-AUC: 0.7260
DEBUG - 07/09/25 13:04:56 - 0:07:12 - Epoch 29
INFO - 07/09/25 13:05:11 - 0:07:27 - Epoch 30/200 | Step 1230 |  Avg Test Loss: 0.2888 | Test ROC-AUC: 0.7344
DEBUG - 07/09/25 13:05:11 - 0:07:27 - Epoch 30
INFO - 07/09/25 13:05:25 - 0:07:42 - Epoch 31/200 | Step 1271 |  Avg Test Loss: 0.2593 | Test ROC-AUC: 0.7563
DEBUG - 07/09/25 13:05:26 - 0:07:42 - Epoch 31
INFO - 07/09/25 13:05:40 - 0:07:57 - Epoch 32/200 | Step 1312 |  Avg Test Loss: 0.2755 | Test ROC-AUC: 0.7260
DEBUG - 07/09/25 13:05:40 - 0:07:57 - Epoch 32
INFO - 07/09/25 13:05:55 - 0:08:11 - Epoch 33/200 | Step 1353 |  Avg Test Loss: 0.2540 | Test ROC-AUC: 0.7969
DEBUG - 07/09/25 13:05:55 - 0:08:12 - Epoch 33
INFO - 07/09/25 13:06:10 - 0:08:26 - Epoch 34/200 | Step 1394 |  Avg Test Loss: 0.2839 | Test ROC-AUC: 0.7536
DEBUG - 07/09/25 13:06:10 - 0:08:26 - Epoch 34
INFO - 07/09/25 13:06:24 - 0:08:41 - Epoch 35/200 | Step 1435 |  Avg Test Loss: 0.2633 | Test ROC-AUC: 0.7740
DEBUG - 07/09/25 13:06:25 - 0:08:41 - Epoch 35
INFO - 07/09/25 13:06:39 - 0:08:56 - Epoch 36/200 | Step 1476 |  Avg Test Loss: 0.2582 | Test ROC-AUC: 0.7396
DEBUG - 07/09/25 13:06:39 - 0:08:56 - Epoch 36
INFO - 07/09/25 13:06:54 - 0:09:11 - Epoch 37/200 | Step 1517 |  Avg Test Loss: 0.2555 | Test ROC-AUC: 0.7849
DEBUG - 07/09/25 13:06:54 - 0:09:11 - Epoch 37
INFO - 07/09/25 13:07:09 - 0:09:25 - Epoch 38/200 | Step 1558 |  Avg Test Loss: 0.2602 | Test ROC-AUC: 0.7891
DEBUG - 07/09/25 13:07:09 - 0:09:25 - Epoch 38
INFO - 07/09/25 13:07:23 - 0:09:40 - Epoch 39/200 | Step 1599 |  Avg Test Loss: 0.2386 | Test ROC-AUC: 0.7906
DEBUG - 07/09/25 13:07:24 - 0:09:40 - Epoch 39
INFO - 07/09/25 13:07:38 - 0:09:55 - Epoch 40/200 | Step 1640 |  Avg Test Loss: 0.2694 | Test ROC-AUC: 0.7932
DEBUG - 07/09/25 13:07:38 - 0:09:55 - Epoch 40
INFO - 07/09/25 13:07:53 - 0:10:09 - Epoch 41/200 | Step 1681 |  Avg Test Loss: 0.2400 | Test ROC-AUC: 0.8339
DEBUG - 07/09/25 13:07:53 - 0:10:10 - Epoch 41
INFO - 07/09/25 13:08:08 - 0:10:24 - Epoch 42/200 | Step 1722 |  Avg Test Loss: 0.2223 | Test ROC-AUC: 0.8286
DEBUG - 07/09/25 13:08:08 - 0:10:24 - Epoch 42
INFO - 07/09/25 13:08:22 - 0:10:39 - Epoch 43/200 | Step 1763 |  Avg Test Loss: 0.2206 | Test ROC-AUC: 0.8135
DEBUG - 07/09/25 13:08:23 - 0:10:39 - Epoch 43
INFO - 07/09/25 13:08:37 - 0:10:54 - Epoch 44/200 | Step 1804 |  Avg Test Loss: 0.2223 | Test ROC-AUC: 0.7995
DEBUG - 07/09/25 13:08:37 - 0:10:54 - Epoch 44
INFO - 07/09/25 13:08:52 - 0:11:08 - Epoch 45/200 | Step 1845 |  Avg Test Loss: 0.2268 | Test ROC-AUC: 0.7953
DEBUG - 07/09/25 13:08:52 - 0:11:08 - Epoch 45
INFO - 07/09/25 13:09:07 - 0:11:23 - Epoch 46/200 | Step 1886 |  Avg Test Loss: 0.2182 | Test ROC-AUC: 0.8552
DEBUG - 07/09/25 13:09:07 - 0:11:23 - Epoch 46
INFO - 07/09/25 13:09:21 - 0:11:38 - Epoch 47/200 | Step 1927 |  Avg Test Loss: 0.2509 | Test ROC-AUC: 0.8203
DEBUG - 07/09/25 13:09:21 - 0:11:38 - Epoch 47
INFO - 07/09/25 13:09:36 - 0:11:53 - Epoch 48/200 | Step 1968 |  Avg Test Loss: 0.2678 | Test ROC-AUC: 0.8036
DEBUG - 07/09/25 13:09:36 - 0:11:53 - Epoch 48
INFO - 07/09/25 13:09:51 - 0:12:07 - Epoch 49/200 | Step 2009 |  Avg Test Loss: 0.2134 | Test ROC-AUC: 0.8302
DEBUG - 07/09/25 13:09:51 - 0:12:08 - Epoch 49
INFO - 07/09/25 13:10:06 - 0:12:22 - Epoch 50/200 | Step 2050 |  Avg Test Loss: 0.2258 | Test ROC-AUC: 0.8198
DEBUG - 07/09/25 13:10:06 - 0:12:22 - Epoch 50
INFO - 07/09/25 13:10:20 - 0:12:37 - Epoch 51/200 | Step 2091 |  Avg Test Loss: 0.2300 | Test ROC-AUC: 0.8078
DEBUG - 07/09/25 13:10:21 - 0:12:37 - Epoch 51
INFO - 07/09/25 13:10:35 - 0:12:52 - Epoch 52/200 | Step 2132 |  Avg Test Loss: 0.2160 | Test ROC-AUC: 0.7958
DEBUG - 07/09/25 13:10:35 - 0:12:52 - Epoch 52
INFO - 07/09/25 13:10:50 - 0:13:07 - Epoch 53/200 | Step 2173 |  Avg Test Loss: 0.2215 | Test ROC-AUC: 0.7854
DEBUG - 07/09/25 13:10:50 - 0:13:07 - Epoch 53
INFO - 07/09/25 13:11:05 - 0:13:21 - Epoch 54/200 | Step 2214 |  Avg Test Loss: 0.1961 | Test ROC-AUC: 0.8359
DEBUG - 07/09/25 13:11:05 - 0:13:21 - Epoch 54
INFO - 07/09/25 13:11:20 - 0:13:36 - Epoch 55/200 | Step 2255 |  Avg Test Loss: 0.2010 | Test ROC-AUC: 0.8458
DEBUG - 07/09/25 13:11:20 - 0:13:36 - Epoch 55
INFO - 07/09/25 13:11:34 - 0:13:51 - Epoch 56/200 | Step 2296 |  Avg Test Loss: 0.2124 | Test ROC-AUC: 0.8302
DEBUG - 07/09/25 13:11:34 - 0:13:51 - Epoch 56
INFO - 07/09/25 13:11:49 - 0:14:06 - Epoch 57/200 | Step 2337 |  Avg Test Loss: 0.2103 | Test ROC-AUC: 0.8182
DEBUG - 07/09/25 13:11:49 - 0:14:06 - Epoch 57
INFO - 07/09/25 13:12:04 - 0:14:20 - Epoch 58/200 | Step 2378 |  Avg Test Loss: 0.2107 | Test ROC-AUC: 0.8099
DEBUG - 07/09/25 13:12:04 - 0:14:21 - Epoch 58
INFO - 07/09/25 13:12:19 - 0:14:35 - Epoch 59/200 | Step 2419 |  Avg Test Loss: 0.2207 | Test ROC-AUC: 0.7885
DEBUG - 07/09/25 13:12:19 - 0:14:35 - Epoch 59
INFO - 07/09/25 13:12:34 - 0:14:50 - Epoch 60/200 | Step 2460 |  Avg Test Loss: 0.2309 | Test ROC-AUC: 0.8135
DEBUG - 07/09/25 13:12:34 - 0:14:50 - Epoch 60
INFO - 07/09/25 13:12:48 - 0:15:05 - Epoch 61/200 | Step 2501 |  Avg Test Loss: 0.2106 | Test ROC-AUC: 0.8276
DEBUG - 07/09/25 13:12:48 - 0:15:05 - Epoch 61
INFO - 07/09/25 13:13:03 - 0:15:20 - Epoch 62/200 | Step 2542 |  Avg Test Loss: 0.1938 | Test ROC-AUC: 0.8354
DEBUG - 07/09/25 13:13:03 - 0:15:20 - Epoch 62
INFO - 07/09/25 13:13:18 - 0:15:34 - Epoch 63/200 | Step 2583 |  Avg Test Loss: 0.2028 | Test ROC-AUC: 0.8276
DEBUG - 07/09/25 13:13:18 - 0:15:34 - Epoch 63
INFO - 07/09/25 13:13:33 - 0:15:49 - Epoch 64/200 | Step 2624 |  Avg Test Loss: 0.2220 | Test ROC-AUC: 0.8177
DEBUG - 07/09/25 13:13:33 - 0:15:49 - Epoch 64
INFO - 07/09/25 13:13:47 - 0:16:04 - Epoch 65/200 | Step 2665 |  Avg Test Loss: 0.2098 | Test ROC-AUC: 0.8151
DEBUG - 07/09/25 13:13:47 - 0:16:04 - Epoch 65
INFO - 07/09/25 13:14:02 - 0:16:19 - Epoch 66/200 | Step 2706 |  Avg Test Loss: 0.2273 | Test ROC-AUC: 0.8276
DEBUG - 07/09/25 13:14:02 - 0:16:19 - Epoch 66
INFO - 07/09/25 13:14:17 - 0:16:33 - Epoch 67/200 | Step 2747 |  Avg Test Loss: 0.1916 | Test ROC-AUC: 0.8385
DEBUG - 07/09/25 13:14:17 - 0:16:33 - Epoch 67
INFO - 07/09/25 13:14:32 - 0:16:48 - Epoch 68/200 | Step 2788 |  Avg Test Loss: 0.1923 | Test ROC-AUC: 0.8771
DEBUG - 07/09/25 13:14:32 - 0:16:48 - Epoch 68
INFO - 07/09/25 13:14:46 - 0:17:03 - Epoch 69/200 | Step 2829 |  Avg Test Loss: 0.2322 | Test ROC-AUC: 0.8245
DEBUG - 07/09/25 13:14:47 - 0:17:03 - Epoch 69
INFO - 07/09/25 13:15:01 - 0:17:18 - Epoch 70/200 | Step 2870 |  Avg Test Loss: 0.2146 | Test ROC-AUC: 0.7839
DEBUG - 07/09/25 13:15:01 - 0:17:18 - Epoch 70
INFO - 07/09/25 13:15:16 - 0:17:32 - Epoch 71/200 | Step 2911 |  Avg Test Loss: 0.2402 | Test ROC-AUC: 0.7781
DEBUG - 07/09/25 13:15:16 - 0:17:33 - Epoch 71
INFO - 07/09/25 13:15:31 - 0:17:47 - Epoch 72/200 | Step 2952 |  Avg Test Loss: 0.1857 | Test ROC-AUC: 0.8307
DEBUG - 07/09/25 13:15:31 - 0:17:47 - Epoch 72
INFO - 07/09/25 13:15:46 - 0:18:02 - Epoch 73/200 | Step 2993 |  Avg Test Loss: 0.1914 | Test ROC-AUC: 0.8411
DEBUG - 07/09/25 13:15:46 - 0:18:02 - Epoch 73
INFO - 07/09/25 13:16:00 - 0:18:17 - Epoch 74/200 | Step 3034 |  Avg Test Loss: 0.1970 | Test ROC-AUC: 0.8312
DEBUG - 07/09/25 13:16:00 - 0:18:17 - Epoch 74
INFO - 07/09/25 13:16:15 - 0:18:31 - Epoch 75/200 | Step 3075 |  Avg Test Loss: 0.2031 | Test ROC-AUC: 0.7964
DEBUG - 07/09/25 13:16:15 - 0:18:32 - Epoch 75
INFO - 07/09/25 13:16:30 - 0:18:46 - Epoch 76/200 | Step 3116 |  Avg Test Loss: 0.1920 | Test ROC-AUC: 0.8510
DEBUG - 07/09/25 13:16:30 - 0:18:46 - Epoch 76
INFO - 07/09/25 13:16:45 - 0:19:01 - Epoch 77/200 | Step 3157 |  Avg Test Loss: 0.2154 | Test ROC-AUC: 0.8396
DEBUG - 07/09/25 13:16:45 - 0:19:01 - Epoch 77
INFO - 07/09/25 13:16:59 - 0:19:16 - Epoch 78/200 | Step 3198 |  Avg Test Loss: 0.1920 | Test ROC-AUC: 0.8651
DEBUG - 07/09/25 13:16:59 - 0:19:16 - Epoch 78
INFO - 07/09/25 13:17:14 - 0:19:31 - Epoch 79/200 | Step 3239 |  Avg Test Loss: 0.2034 | Test ROC-AUC: 0.8203
DEBUG - 07/09/25 13:17:14 - 0:19:31 - Epoch 79
INFO - 07/09/25 13:17:29 - 0:19:45 - Epoch 80/200 | Step 3280 |  Avg Test Loss: 0.1885 | Test ROC-AUC: 0.8073
DEBUG - 07/09/25 13:17:29 - 0:19:45 - Epoch 80
INFO - 07/09/25 13:17:44 - 0:20:00 - Epoch 81/200 | Step 3321 |  Avg Test Loss: 0.2374 | Test ROC-AUC: 0.8073
DEBUG - 07/09/25 13:17:44 - 0:20:00 - Epoch 81
INFO - 07/09/25 13:17:58 - 0:20:15 - Epoch 82/200 | Step 3362 |  Avg Test Loss: 0.2058 | Test ROC-AUC: 0.8146
DEBUG - 07/09/25 13:17:58 - 0:20:15 - Epoch 82
INFO - 07/09/25 13:18:13 - 0:20:30 - Epoch 83/200 | Step 3403 |  Avg Test Loss: 0.2045 | Test ROC-AUC: 0.8380
DEBUG - 07/09/25 13:18:13 - 0:20:30 - Epoch 83
INFO - 07/09/25 13:18:28 - 0:20:44 - Epoch 84/200 | Step 3444 |  Avg Test Loss: 0.1879 | Test ROC-AUC: 0.8109
DEBUG - 07/09/25 13:18:28 - 0:20:45 - Epoch 84
INFO - 07/09/25 13:18:43 - 0:20:59 - Epoch 85/200 | Step 3485 |  Avg Test Loss: 0.2043 | Test ROC-AUC: 0.8401
DEBUG - 07/09/25 13:18:43 - 0:20:59 - Epoch 85
INFO - 07/09/25 13:18:58 - 0:21:14 - Epoch 86/200 | Step 3526 |  Avg Test Loss: 0.2309 | Test ROC-AUC: 0.8229
DEBUG - 07/09/25 13:18:58 - 0:21:14 - Epoch 86
INFO - 07/09/25 13:19:12 - 0:21:29 - Epoch 87/200 | Step 3567 |  Avg Test Loss: 0.1996 | Test ROC-AUC: 0.8104
DEBUG - 07/09/25 13:19:12 - 0:21:29 - Epoch 87
INFO - 07/09/25 13:19:27 - 0:21:44 - Epoch 88/200 | Step 3608 |  Avg Test Loss: 0.2044 | Test ROC-AUC: 0.8047
DEBUG - 07/09/25 13:19:27 - 0:21:44 - Epoch 88
INFO - 07/09/25 13:19:42 - 0:21:58 - Epoch 89/200 | Step 3649 |  Avg Test Loss: 0.2195 | Test ROC-AUC: 0.8135
DEBUG - 07/09/25 13:19:42 - 0:21:58 - Epoch 89
INFO - 07/09/25 13:19:57 - 0:22:13 - Epoch 90/200 | Step 3690 |  Avg Test Loss: 0.2075 | Test ROC-AUC: 0.8167
DEBUG - 07/09/25 13:19:57 - 0:22:13 - Epoch 90
INFO - 07/09/25 13:20:11 - 0:22:28 - Epoch 91/200 | Step 3731 |  Avg Test Loss: 0.2441 | Test ROC-AUC: 0.8297
DEBUG - 07/09/25 13:20:11 - 0:22:28 - Epoch 91
INFO - 07/09/25 13:20:26 - 0:22:43 - Epoch 92/200 | Step 3772 |  Avg Test Loss: 0.1934 | Test ROC-AUC: 0.8073
DEBUG - 07/09/25 13:20:26 - 0:22:43 - Epoch 92
INFO - 07/09/25 13:20:41 - 0:22:57 - Epoch 93/200 | Step 3813 |  Avg Test Loss: 0.2032 | Test ROC-AUC: 0.7958
DEBUG - 07/09/25 13:20:41 - 0:22:58 - Epoch 93
INFO - 07/09/25 13:20:56 - 0:23:12 - Epoch 94/200 | Step 3854 |  Avg Test Loss: 0.1935 | Test ROC-AUC: 0.8047
DEBUG - 07/09/25 13:20:56 - 0:23:12 - Epoch 94
INFO - 07/09/25 13:21:10 - 0:23:27 - Epoch 95/200 | Step 3895 |  Avg Test Loss: 0.2256 | Test ROC-AUC: 0.8177
DEBUG - 07/09/25 13:21:11 - 0:23:27 - Epoch 95
INFO - 07/09/25 13:21:25 - 0:23:42 - Epoch 96/200 | Step 3936 |  Avg Test Loss: 0.2251 | Test ROC-AUC: 0.8354
DEBUG - 07/09/25 13:21:25 - 0:23:42 - Epoch 96
INFO - 07/09/25 13:21:40 - 0:23:56 - Epoch 97/200 | Step 3977 |  Avg Test Loss: 0.1991 | Test ROC-AUC: 0.8323
DEBUG - 07/09/25 13:21:40 - 0:23:57 - Epoch 97
INFO - 07/09/25 13:21:55 - 0:24:11 - Epoch 98/200 | Step 4018 |  Avg Test Loss: 0.1862 | Test ROC-AUC: 0.8573
DEBUG - 07/09/25 13:21:55 - 0:24:11 - Epoch 98
INFO - 07/09/25 13:22:09 - 0:24:26 - Epoch 99/200 | Step 4059 |  Avg Test Loss: 0.1661 | Test ROC-AUC: 0.8682
DEBUG - 07/09/25 13:22:10 - 0:24:26 - Epoch 99
INFO - 07/09/25 13:22:24 - 0:24:41 - Epoch 100/200 | Step 4100 |  Avg Test Loss: 0.2679 | Test ROC-AUC: 0.8318
DEBUG - 07/09/25 13:22:24 - 0:24:41 - Epoch 100
INFO - 07/09/25 13:22:39 - 0:24:56 - Epoch 101/200 | Step 4141 |  Avg Test Loss: 0.2051 | Test ROC-AUC: 0.8411
DEBUG - 07/09/25 13:22:39 - 0:24:56 - Epoch 101
INFO - 07/09/25 13:22:54 - 0:25:10 - Epoch 102/200 | Step 4182 |  Avg Test Loss: 0.1979 | Test ROC-AUC: 0.8521
DEBUG - 07/09/25 13:22:54 - 0:25:10 - Epoch 102
INFO - 07/09/25 13:23:08 - 0:25:25 - Epoch 103/200 | Step 4223 |  Avg Test Loss: 0.2024 | Test ROC-AUC: 0.8042
DEBUG - 07/09/25 13:23:09 - 0:25:25 - Epoch 103
INFO - 07/09/25 13:23:23 - 0:25:40 - Epoch 104/200 | Step 4264 |  Avg Test Loss: 0.2054 | Test ROC-AUC: 0.8547
DEBUG - 07/09/25 13:23:23 - 0:25:40 - Epoch 104
INFO - 07/09/25 13:23:38 - 0:25:55 - Epoch 105/200 | Step 4305 |  Avg Test Loss: 0.1801 | Test ROC-AUC: 0.8479
DEBUG - 07/09/25 13:23:38 - 0:25:55 - Epoch 105
INFO - 07/09/25 13:23:53 - 0:26:09 - Epoch 106/200 | Step 4346 |  Avg Test Loss: 0.1763 | Test ROC-AUC: 0.8599
DEBUG - 07/09/25 13:23:53 - 0:26:09 - Epoch 106
INFO - 07/09/25 13:24:07 - 0:26:24 - Epoch 107/200 | Step 4387 |  Avg Test Loss: 0.1973 | Test ROC-AUC: 0.8370
DEBUG - 07/09/25 13:24:08 - 0:26:24 - Epoch 107
INFO - 07/09/25 13:24:22 - 0:26:39 - Epoch 108/200 | Step 4428 |  Avg Test Loss: 0.1760 | Test ROC-AUC: 0.8667
DEBUG - 07/09/25 13:24:22 - 0:26:39 - Epoch 108
INFO - 07/09/25 13:24:37 - 0:26:53 - Epoch 109/200 | Step 4469 |  Avg Test Loss: 0.2111 | Test ROC-AUC: 0.8031
DEBUG - 07/09/25 13:24:37 - 0:26:54 - Epoch 109
INFO - 07/09/25 13:24:52 - 0:27:08 - Epoch 110/200 | Step 4510 |  Avg Test Loss: 0.2079 | Test ROC-AUC: 0.7885
DEBUG - 07/09/25 13:24:52 - 0:27:08 - Epoch 110
INFO - 07/09/25 13:25:07 - 0:27:23 - Epoch 111/200 | Step 4551 |  Avg Test Loss: 0.1866 | Test ROC-AUC: 0.8151
DEBUG - 07/09/25 13:25:07 - 0:27:23 - Epoch 111
INFO - 07/09/25 13:27:12 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 13:27:12 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/clintox/clintox.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 2
                                     path: /home/cassie/macfrag/data/clintox
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 13:27:12 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 13:27:12 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 13:27:12 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 13:27:12 - 0:00:00 - Loading data
DEBUG - 07/09/25 13:27:13 - 0:00:00 - Total size = 1478
DEBUG - 07/09/25 13:27:13 - 0:00:00 - Building model 0
DEBUG - 07/09/25 13:27:15 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=2, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 13:27:15 - 0:00:03 - Number of M1 parameters = 4,255,255
DEBUG - 07/09/25 13:27:15 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 13:27:15 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 13:27:15 - 0:00:03 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 13:27:15 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 13:27:15 - 0:00:03 - Epoch 0
INFO - 07/09/25 13:27:30 - 0:00:17 - Epoch 1/200 | Step 41 |  Avg Test Loss: 3.8627 | Test ROC-AUC: 0.4828
DEBUG - 07/09/25 13:27:30 - 0:00:18 - Epoch 1
INFO - 07/09/25 13:27:44 - 0:00:31 - Epoch 2/200 | Step 82 |  Avg Test Loss: 2.8263 | Test ROC-AUC: 0.4766
DEBUG - 07/09/25 13:27:44 - 0:00:32 - Epoch 2
INFO - 07/09/25 13:27:58 - 0:00:46 - Epoch 3/200 | Step 123 |  Avg Test Loss: 2.0137 | Test ROC-AUC: 0.4719
DEBUG - 07/09/25 13:27:58 - 0:00:46 - Epoch 3
INFO - 07/09/25 13:28:12 - 0:01:00 - Epoch 4/200 | Step 164 |  Avg Test Loss: 1.6388 | Test ROC-AUC: 0.4687
DEBUG - 07/09/25 13:28:12 - 0:01:00 - Epoch 4
INFO - 07/09/25 13:28:25 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 13:28:25 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/clintox/clintox.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 2
                                     path: /home/cassie/macfrag/data/clintox
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 13:28:25 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 13:28:25 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 13:28:25 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 13:28:25 - 0:00:00 - Loading data
DEBUG - 07/09/25 13:28:25 - 0:00:00 - Total size = 1478
DEBUG - 07/09/25 13:28:25 - 0:00:00 - Building model 0
DEBUG - 07/09/25 13:28:28 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=2, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 13:28:28 - 0:00:03 - Number of M1 parameters = 4,255,255
DEBUG - 07/09/25 13:28:28 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 13:28:28 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 13:28:28 - 0:00:03 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 13:28:28 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 13:28:28 - 0:00:03 - Epoch 0
INFO - 07/09/25 13:28:42 - 0:00:18 - Epoch 1/200 | Step 41 |  Avg Test Loss: 3.8627 | Test ROC-AUC: 0.4828
DEBUG - 07/09/25 13:28:43 - 0:00:18 - Epoch 1
INFO - 07/09/25 13:28:56 - 0:00:32 - Epoch 2/200 | Step 82 |  Avg Test Loss: 2.8257 | Test ROC-AUC: 0.4766
DEBUG - 07/09/25 13:28:57 - 0:00:32 - Epoch 2
INFO - 07/09/25 13:29:11 - 0:00:46 - Epoch 3/200 | Step 123 |  Avg Test Loss: 2.0129 | Test ROC-AUC: 0.4714
DEBUG - 07/09/25 13:29:11 - 0:00:46 - Epoch 3
INFO - 07/09/25 13:29:25 - 0:01:00 - Epoch 4/200 | Step 164 |  Avg Test Loss: 1.6363 | Test ROC-AUC: 0.4656
DEBUG - 07/09/25 13:29:25 - 0:01:00 - Epoch 4
INFO - 07/09/25 13:29:39 - 0:01:14 - Epoch 5/200 | Step 205 |  Avg Test Loss: 1.4670 | Test ROC-AUC: 0.4536
DEBUG - 07/09/25 13:29:39 - 0:01:14 - Epoch 5
INFO - 07/09/25 13:29:53 - 0:01:28 - Epoch 6/200 | Step 246 |  Avg Test Loss: 1.4043 | Test ROC-AUC: 0.4557
DEBUG - 07/09/25 13:29:53 - 0:01:29 - Epoch 6
INFO - 07/09/25 13:30:07 - 0:01:43 - Epoch 7/200 | Step 287 |  Avg Test Loss: 1.3777 | Test ROC-AUC: 0.4516
DEBUG - 07/09/25 13:30:07 - 0:01:43 - Epoch 7
INFO - 07/09/25 13:30:22 - 0:01:57 - Epoch 8/200 | Step 328 |  Avg Test Loss: 1.3676 | Test ROC-AUC: 0.4833
DEBUG - 07/09/25 13:30:22 - 0:01:57 - Epoch 8
INFO - 07/09/25 13:30:36 - 0:02:11 - Epoch 9/200 | Step 369 |  Avg Test Loss: 1.3548 | Test ROC-AUC: 0.4927
DEBUG - 07/09/25 13:30:36 - 0:02:11 - Epoch 9
INFO - 07/09/25 13:30:50 - 0:02:25 - Epoch 10/200 | Step 410 |  Avg Test Loss: 1.3391 | Test ROC-AUC: 0.4807
DEBUG - 07/09/25 13:30:50 - 0:02:25 - Epoch 10
INFO - 07/09/25 13:31:04 - 0:02:39 - Epoch 11/200 | Step 451 |  Avg Test Loss: 1.3265 | Test ROC-AUC: 0.4885
DEBUG - 07/09/25 13:31:04 - 0:02:39 - Epoch 11
INFO - 07/09/25 13:31:18 - 0:02:53 - Epoch 12/200 | Step 492 |  Avg Test Loss: 1.3157 | Test ROC-AUC: 0.5417
DEBUG - 07/09/25 13:31:18 - 0:02:53 - Epoch 12
INFO - 07/09/25 13:31:32 - 0:03:07 - Epoch 13/200 | Step 533 |  Avg Test Loss: 1.3133 | Test ROC-AUC: 0.5229
DEBUG - 07/09/25 13:31:32 - 0:03:07 - Epoch 13
INFO - 07/09/25 13:31:46 - 0:03:21 - Epoch 14/200 | Step 574 |  Avg Test Loss: 1.2978 | Test ROC-AUC: 0.5672
DEBUG - 07/09/25 13:31:46 - 0:03:21 - Epoch 14
INFO - 07/09/25 13:32:00 - 0:03:35 - Epoch 15/200 | Step 615 |  Avg Test Loss: 1.2891 | Test ROC-AUC: 0.5635
DEBUG - 07/09/25 13:32:00 - 0:03:35 - Epoch 15
INFO - 07/09/25 13:32:14 - 0:03:49 - Epoch 16/200 | Step 656 |  Avg Test Loss: 1.2860 | Test ROC-AUC: 0.5698
DEBUG - 07/09/25 13:32:14 - 0:03:50 - Epoch 16
INFO - 07/09/25 13:32:28 - 0:04:04 - Epoch 17/200 | Step 697 |  Avg Test Loss: 1.2882 | Test ROC-AUC: 0.5865
DEBUG - 07/09/25 13:32:29 - 0:04:04 - Epoch 17
INFO - 07/09/25 13:32:43 - 0:04:18 - Epoch 18/200 | Step 738 |  Avg Test Loss: 1.2657 | Test ROC-AUC: 0.6125
DEBUG - 07/09/25 13:32:43 - 0:04:18 - Epoch 18
INFO - 07/09/25 13:32:57 - 0:04:32 - Epoch 19/200 | Step 779 |  Avg Test Loss: 1.2590 | Test ROC-AUC: 0.6172
DEBUG - 07/09/25 13:32:57 - 0:04:32 - Epoch 19
INFO - 07/09/25 13:33:11 - 0:04:46 - Epoch 20/200 | Step 820 |  Avg Test Loss: 1.2547 | Test ROC-AUC: 0.6234
DEBUG - 07/09/25 13:33:11 - 0:04:46 - Epoch 20
INFO - 07/09/25 13:33:25 - 0:05:00 - Epoch 21/200 | Step 861 |  Avg Test Loss: 1.2587 | Test ROC-AUC: 0.6109
DEBUG - 07/09/25 13:33:25 - 0:05:00 - Epoch 21
INFO - 07/09/25 13:33:39 - 0:05:14 - Epoch 22/200 | Step 902 |  Avg Test Loss: 1.2442 | Test ROC-AUC: 0.6359
DEBUG - 07/09/25 13:33:39 - 0:05:14 - Epoch 22
INFO - 07/09/25 13:33:53 - 0:05:28 - Epoch 23/200 | Step 943 |  Avg Test Loss: 1.2340 | Test ROC-AUC: 0.7063
DEBUG - 07/09/25 13:33:53 - 0:05:28 - Epoch 23
INFO - 07/09/25 13:34:07 - 0:05:42 - Epoch 24/200 | Step 984 |  Avg Test Loss: 1.2272 | Test ROC-AUC: 0.6870
DEBUG - 07/09/25 13:34:07 - 0:05:42 - Epoch 24
INFO - 07/09/25 13:34:21 - 0:05:56 - Epoch 25/200 | Step 1025 |  Avg Test Loss: 1.2665 | Test ROC-AUC: 0.6365
DEBUG - 07/09/25 13:34:21 - 0:05:56 - Epoch 25
INFO - 07/09/25 13:34:35 - 0:06:10 - Epoch 26/200 | Step 1066 |  Avg Test Loss: 1.2348 | Test ROC-AUC: 0.7000
DEBUG - 07/09/25 13:34:35 - 0:06:11 - Epoch 26
INFO - 07/09/25 13:34:49 - 0:06:25 - Epoch 27/200 | Step 1107 |  Avg Test Loss: 1.2246 | Test ROC-AUC: 0.6786
DEBUG - 07/09/25 13:34:49 - 0:06:25 - Epoch 27
INFO - 07/09/25 13:35:03 - 0:06:39 - Epoch 28/200 | Step 1148 |  Avg Test Loss: 1.2108 | Test ROC-AUC: 0.7052
DEBUG - 07/09/25 13:35:04 - 0:06:39 - Epoch 28
INFO - 07/09/25 13:35:18 - 0:06:53 - Epoch 29/200 | Step 1189 |  Avg Test Loss: 1.2034 | Test ROC-AUC: 0.7411
DEBUG - 07/09/25 13:35:18 - 0:06:53 - Epoch 29
INFO - 07/09/25 13:35:32 - 0:07:07 - Epoch 30/200 | Step 1230 |  Avg Test Loss: 1.2260 | Test ROC-AUC: 0.7536
DEBUG - 07/09/25 13:35:32 - 0:07:07 - Epoch 30
INFO - 07/09/25 13:35:46 - 0:07:21 - Epoch 31/200 | Step 1271 |  Avg Test Loss: 1.1986 | Test ROC-AUC: 0.7292
DEBUG - 07/09/25 13:35:46 - 0:07:21 - Epoch 31
INFO - 07/09/25 13:36:00 - 0:07:35 - Epoch 32/200 | Step 1312 |  Avg Test Loss: 1.2064 | Test ROC-AUC: 0.7948
DEBUG - 07/09/25 13:36:00 - 0:07:35 - Epoch 32
INFO - 07/09/25 13:36:14 - 0:07:49 - Epoch 33/200 | Step 1353 |  Avg Test Loss: 1.1931 | Test ROC-AUC: 0.7646
DEBUG - 07/09/25 13:36:14 - 0:07:50 - Epoch 33
INFO - 07/09/25 13:36:28 - 0:08:04 - Epoch 34/200 | Step 1394 |  Avg Test Loss: 1.2047 | Test ROC-AUC: 0.7073
DEBUG - 07/09/25 13:36:28 - 0:08:04 - Epoch 34
INFO - 07/09/25 13:36:42 - 0:08:18 - Epoch 35/200 | Step 1435 |  Avg Test Loss: 1.1889 | Test ROC-AUC: 0.7552
DEBUG - 07/09/25 13:36:43 - 0:08:18 - Epoch 35
INFO - 07/09/25 13:36:57 - 0:08:32 - Epoch 36/200 | Step 1476 |  Avg Test Loss: 1.1938 | Test ROC-AUC: 0.7057
DEBUG - 07/09/25 13:36:57 - 0:08:32 - Epoch 36
INFO - 07/09/25 13:37:11 - 0:08:46 - Epoch 37/200 | Step 1517 |  Avg Test Loss: 1.1971 | Test ROC-AUC: 0.7182
DEBUG - 07/09/25 13:37:11 - 0:08:46 - Epoch 37
INFO - 07/09/25 13:37:25 - 0:09:00 - Epoch 38/200 | Step 1558 |  Avg Test Loss: 1.1741 | Test ROC-AUC: 0.7693
DEBUG - 07/09/25 13:37:25 - 0:09:00 - Epoch 38
INFO - 07/09/25 13:37:39 - 0:09:14 - Epoch 39/200 | Step 1599 |  Avg Test Loss: 1.1855 | Test ROC-AUC: 0.7427
DEBUG - 07/09/25 13:37:39 - 0:09:14 - Epoch 39
INFO - 07/09/25 13:37:53 - 0:09:28 - Epoch 40/200 | Step 1640 |  Avg Test Loss: 1.2083 | Test ROC-AUC: 0.7260
DEBUG - 07/09/25 13:37:53 - 0:09:28 - Epoch 40
INFO - 07/09/25 13:38:07 - 0:09:42 - Epoch 41/200 | Step 1681 |  Avg Test Loss: 1.1755 | Test ROC-AUC: 0.7490
DEBUG - 07/09/25 13:38:07 - 0:09:42 - Epoch 41
INFO - 07/09/25 13:38:21 - 0:09:56 - Epoch 42/200 | Step 1722 |  Avg Test Loss: 1.2286 | Test ROC-AUC: 0.6948
DEBUG - 07/09/25 13:38:21 - 0:09:56 - Epoch 42
INFO - 07/09/25 13:38:35 - 0:10:10 - Epoch 43/200 | Step 1763 |  Avg Test Loss: 1.2072 | Test ROC-AUC: 0.7208
DEBUG - 07/09/25 13:38:35 - 0:10:11 - Epoch 43
INFO - 07/09/25 13:38:50 - 0:10:25 - Epoch 44/200 | Step 1804 |  Avg Test Loss: 1.1944 | Test ROC-AUC: 0.7271
DEBUG - 07/09/25 13:38:50 - 0:10:25 - Epoch 44
INFO - 07/09/25 13:39:04 - 0:10:39 - Epoch 45/200 | Step 1845 |  Avg Test Loss: 1.1790 | Test ROC-AUC: 0.7479
DEBUG - 07/09/25 13:39:04 - 0:10:39 - Epoch 45
INFO - 07/09/25 13:39:18 - 0:10:53 - Epoch 46/200 | Step 1886 |  Avg Test Loss: 1.1695 | Test ROC-AUC: 0.7536
DEBUG - 07/09/25 13:39:18 - 0:10:53 - Epoch 46
INFO - 07/09/25 13:39:32 - 0:11:07 - Epoch 47/200 | Step 1927 |  Avg Test Loss: 1.2002 | Test ROC-AUC: 0.7797
DEBUG - 07/09/25 13:39:32 - 0:11:07 - Epoch 47
INFO - 07/09/25 13:39:46 - 0:11:21 - Epoch 48/200 | Step 1968 |  Avg Test Loss: 1.2186 | Test ROC-AUC: 0.7526
DEBUG - 07/09/25 13:39:46 - 0:11:21 - Epoch 48
INFO - 07/09/25 13:40:00 - 0:11:35 - Epoch 49/200 | Step 2009 |  Avg Test Loss: 1.1802 | Test ROC-AUC: 0.7453
DEBUG - 07/09/25 13:40:00 - 0:11:35 - Epoch 49
INFO - 07/09/25 13:40:14 - 0:11:49 - Epoch 50/200 | Step 2050 |  Avg Test Loss: 1.1705 | Test ROC-AUC: 0.7599
DEBUG - 07/09/25 13:40:14 - 0:11:50 - Epoch 50
INFO - 07/09/25 13:40:28 - 0:12:04 - Epoch 51/200 | Step 2091 |  Avg Test Loss: 1.1795 | Test ROC-AUC: 0.7078
DEBUG - 07/09/25 13:40:29 - 0:12:04 - Epoch 51
INFO - 07/09/25 13:40:43 - 0:12:18 - Epoch 52/200 | Step 2132 |  Avg Test Loss: 1.2055 | Test ROC-AUC: 0.7979
DEBUG - 07/09/25 13:40:43 - 0:12:18 - Epoch 52
INFO - 07/09/25 13:40:57 - 0:12:32 - Epoch 53/200 | Step 2173 |  Avg Test Loss: 1.1659 | Test ROC-AUC: 0.7432
DEBUG - 07/09/25 13:40:57 - 0:12:32 - Epoch 53
INFO - 07/09/25 13:41:11 - 0:12:46 - Epoch 54/200 | Step 2214 |  Avg Test Loss: 1.1853 | Test ROC-AUC: 0.7120
DEBUG - 07/09/25 13:41:11 - 0:12:46 - Epoch 54
INFO - 07/09/25 13:41:25 - 0:13:00 - Epoch 55/200 | Step 2255 |  Avg Test Loss: 1.1598 | Test ROC-AUC: 0.7604
DEBUG - 07/09/25 13:41:25 - 0:13:00 - Epoch 55
INFO - 07/09/25 13:41:39 - 0:13:14 - Epoch 56/200 | Step 2296 |  Avg Test Loss: 1.1550 | Test ROC-AUC: 0.7818
DEBUG - 07/09/25 13:41:39 - 0:13:14 - Epoch 56
INFO - 07/09/25 13:41:53 - 0:13:28 - Epoch 57/200 | Step 2337 |  Avg Test Loss: 1.2064 | Test ROC-AUC: 0.6839
DEBUG - 07/09/25 13:41:53 - 0:13:28 - Epoch 57
INFO - 07/09/25 13:42:01 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 13:42:01 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/clintox/clintox.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 2
                                     path: /home/cassie/macfrag/data/clintox
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 13:42:01 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 13:42:01 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 13:42:01 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 13:42:01 - 0:00:00 - Loading data
DEBUG - 07/09/25 13:42:01 - 0:00:00 - Total size = 1478
DEBUG - 07/09/25 13:42:01 - 0:00:00 - Building model 0
DEBUG - 07/09/25 13:42:04 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=2, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 13:42:04 - 0:00:03 - Number of M1 parameters = 4,255,255
DEBUG - 07/09/25 13:42:04 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 13:42:04 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 13:42:04 - 0:00:03 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 13:42:04 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 13:42:04 - 0:00:03 - Epoch 0
INFO - 07/09/25 13:42:26 - 0:00:25 - Epoch 1/200 | Step 41 |  Avg Test Loss: 3.8627 | Test ROC-AUC: 0.4828
DEBUG - 07/09/25 13:42:26 - 0:00:25 - Epoch 1
INFO - 07/09/25 13:42:48 - 0:00:46 - Epoch 2/200 | Step 82 |  Avg Test Loss: 2.8257 | Test ROC-AUC: 0.4766
DEBUG - 07/09/25 13:42:48 - 0:00:46 - Epoch 2
INFO - 07/09/25 13:43:09 - 0:01:08 - Epoch 3/200 | Step 123 |  Avg Test Loss: 2.0132 | Test ROC-AUC: 0.4708
DEBUG - 07/09/25 13:43:09 - 0:01:08 - Epoch 3
INFO - 07/09/25 13:43:30 - 0:01:29 - Epoch 4/200 | Step 164 |  Avg Test Loss: 1.6364 | Test ROC-AUC: 0.4672
DEBUG - 07/09/25 13:43:30 - 0:01:29 - Epoch 4
INFO - 07/09/25 13:43:52 - 0:01:51 - Epoch 5/200 | Step 205 |  Avg Test Loss: 1.4666 | Test ROC-AUC: 0.4615
DEBUG - 07/09/25 13:43:52 - 0:01:51 - Epoch 5
INFO - 07/09/25 13:44:13 - 0:02:12 - Epoch 6/200 | Step 246 |  Avg Test Loss: 1.4041 | Test ROC-AUC: 0.4594
DEBUG - 07/09/25 13:44:13 - 0:02:12 - Epoch 6
INFO - 07/09/25 13:44:35 - 0:02:33 - Epoch 7/200 | Step 287 |  Avg Test Loss: 1.3783 | Test ROC-AUC: 0.4547
DEBUG - 07/09/25 13:44:35 - 0:02:34 - Epoch 7
INFO - 07/09/25 13:44:56 - 0:02:55 - Epoch 8/200 | Step 328 |  Avg Test Loss: 1.3666 | Test ROC-AUC: 0.4865
DEBUG - 07/09/25 13:44:56 - 0:02:55 - Epoch 8
INFO - 07/09/25 13:45:18 - 0:03:16 - Epoch 9/200 | Step 369 |  Avg Test Loss: 1.3544 | Test ROC-AUC: 0.4953
DEBUG - 07/09/25 13:45:18 - 0:03:16 - Epoch 9
INFO - 07/09/25 13:45:39 - 0:03:38 - Epoch 10/200 | Step 410 |  Avg Test Loss: 1.3383 | Test ROC-AUC: 0.4875
DEBUG - 07/09/25 13:45:39 - 0:03:38 - Epoch 10
INFO - 07/09/25 13:46:00 - 0:03:59 - Epoch 11/200 | Step 451 |  Avg Test Loss: 1.3241 | Test ROC-AUC: 0.5026
DEBUG - 07/09/25 13:46:01 - 0:03:59 - Epoch 11
INFO - 07/09/25 13:46:22 - 0:04:21 - Epoch 12/200 | Step 492 |  Avg Test Loss: 1.3151 | Test ROC-AUC: 0.5464
DEBUG - 07/09/25 13:46:22 - 0:04:21 - Epoch 12
INFO - 07/09/25 13:46:43 - 0:04:42 - Epoch 13/200 | Step 533 |  Avg Test Loss: 1.3133 | Test ROC-AUC: 0.5344
DEBUG - 07/09/25 13:46:43 - 0:04:42 - Epoch 13
INFO - 07/09/25 13:47:05 - 0:05:04 - Epoch 14/200 | Step 574 |  Avg Test Loss: 1.2983 | Test ROC-AUC: 0.5698
DEBUG - 07/09/25 13:47:05 - 0:05:04 - Epoch 14
INFO - 07/09/25 13:47:26 - 0:05:25 - Epoch 15/200 | Step 615 |  Avg Test Loss: 1.2887 | Test ROC-AUC: 0.5703
DEBUG - 07/09/25 13:47:26 - 0:05:25 - Epoch 15
INFO - 07/09/25 13:47:48 - 0:05:46 - Epoch 16/200 | Step 656 |  Avg Test Loss: 1.2838 | Test ROC-AUC: 0.5755
DEBUG - 07/09/25 13:47:48 - 0:05:46 - Epoch 16
INFO - 07/09/25 13:48:09 - 0:06:08 - Epoch 17/200 | Step 697 |  Avg Test Loss: 1.2869 | Test ROC-AUC: 0.5927
DEBUG - 07/09/25 13:48:09 - 0:06:08 - Epoch 17
INFO - 07/09/25 13:48:30 - 0:06:29 - Epoch 18/200 | Step 738 |  Avg Test Loss: 1.2650 | Test ROC-AUC: 0.6297
DEBUG - 07/09/25 13:48:30 - 0:06:29 - Epoch 18
INFO - 07/09/25 13:48:52 - 0:06:51 - Epoch 19/200 | Step 779 |  Avg Test Loss: 1.2571 | Test ROC-AUC: 0.6333
DEBUG - 07/09/25 13:48:52 - 0:06:51 - Epoch 19
INFO - 07/09/25 13:49:13 - 0:07:12 - Epoch 20/200 | Step 820 |  Avg Test Loss: 1.2539 | Test ROC-AUC: 0.6297
DEBUG - 07/09/25 13:49:13 - 0:07:12 - Epoch 20
INFO - 07/09/25 13:49:35 - 0:07:34 - Epoch 21/200 | Step 861 |  Avg Test Loss: 1.2601 | Test ROC-AUC: 0.6104
DEBUG - 07/09/25 13:49:35 - 0:07:34 - Epoch 21
INFO - 07/09/25 13:49:56 - 0:07:55 - Epoch 22/200 | Step 902 |  Avg Test Loss: 1.2454 | Test ROC-AUC: 0.6401
DEBUG - 07/09/25 13:49:56 - 0:07:55 - Epoch 22
INFO - 07/09/25 13:50:17 - 0:08:16 - Epoch 23/200 | Step 943 |  Avg Test Loss: 1.2348 | Test ROC-AUC: 0.7203
DEBUG - 07/09/25 13:50:18 - 0:08:16 - Epoch 23
INFO - 07/09/25 13:50:39 - 0:08:38 - Epoch 24/200 | Step 984 |  Avg Test Loss: 1.2286 | Test ROC-AUC: 0.6958
DEBUG - 07/09/25 13:50:39 - 0:08:38 - Epoch 24
INFO - 07/09/25 13:51:00 - 0:08:59 - Epoch 25/200 | Step 1025 |  Avg Test Loss: 1.2664 | Test ROC-AUC: 0.6391
DEBUG - 07/09/25 13:51:00 - 0:08:59 - Epoch 25
INFO - 07/09/25 13:51:22 - 0:09:21 - Epoch 26/200 | Step 1066 |  Avg Test Loss: 1.2395 | Test ROC-AUC: 0.6943
DEBUG - 07/09/25 13:51:22 - 0:09:21 - Epoch 26
INFO - 07/09/25 13:51:43 - 0:09:42 - Epoch 27/200 | Step 1107 |  Avg Test Loss: 1.2272 | Test ROC-AUC: 0.6844
DEBUG - 07/09/25 13:51:43 - 0:09:42 - Epoch 27
INFO - 07/09/25 13:52:05 - 0:10:03 - Epoch 28/200 | Step 1148 |  Avg Test Loss: 1.2120 | Test ROC-AUC: 0.7057
DEBUG - 07/09/25 13:52:05 - 0:10:04 - Epoch 28
INFO - 07/09/25 13:52:26 - 0:10:25 - Epoch 29/200 | Step 1189 |  Avg Test Loss: 1.2062 | Test ROC-AUC: 0.7354
DEBUG - 07/09/25 13:52:26 - 0:10:25 - Epoch 29
INFO - 07/09/25 13:52:48 - 0:10:46 - Epoch 30/200 | Step 1230 |  Avg Test Loss: 1.2299 | Test ROC-AUC: 0.7635
DEBUG - 07/09/25 13:52:48 - 0:10:46 - Epoch 30
INFO - 07/09/25 13:53:09 - 0:11:08 - Epoch 31/200 | Step 1271 |  Avg Test Loss: 1.2017 | Test ROC-AUC: 0.7276
DEBUG - 07/09/25 13:53:09 - 0:11:08 - Epoch 31
INFO - 07/09/25 13:53:31 - 0:11:29 - Epoch 32/200 | Step 1312 |  Avg Test Loss: 1.2050 | Test ROC-AUC: 0.7943
DEBUG - 07/09/25 13:53:31 - 0:11:30 - Epoch 32
INFO - 07/09/25 13:53:52 - 0:11:51 - Epoch 33/200 | Step 1353 |  Avg Test Loss: 1.1960 | Test ROC-AUC: 0.7656
DEBUG - 07/09/25 13:53:52 - 0:11:51 - Epoch 33
INFO - 07/09/25 13:54:14 - 0:12:12 - Epoch 34/200 | Step 1394 |  Avg Test Loss: 1.2061 | Test ROC-AUC: 0.7109
DEBUG - 07/09/25 13:54:14 - 0:12:12 - Epoch 34
INFO - 07/09/25 13:54:35 - 0:12:34 - Epoch 35/200 | Step 1435 |  Avg Test Loss: 1.1931 | Test ROC-AUC: 0.7427
DEBUG - 07/09/25 13:54:35 - 0:12:34 - Epoch 35
INFO - 07/09/25 13:54:56 - 0:12:55 - Epoch 36/200 | Step 1476 |  Avg Test Loss: 1.1949 | Test ROC-AUC: 0.7052
DEBUG - 07/09/25 13:54:57 - 0:12:55 - Epoch 36
INFO - 07/09/25 13:55:18 - 0:13:17 - Epoch 37/200 | Step 1517 |  Avg Test Loss: 1.1997 | Test ROC-AUC: 0.7151
DEBUG - 07/09/25 13:55:18 - 0:13:17 - Epoch 37
INFO - 07/09/25 13:55:40 - 0:13:38 - Epoch 38/200 | Step 1558 |  Avg Test Loss: 1.1749 | Test ROC-AUC: 0.7734
DEBUG - 07/09/25 13:55:40 - 0:13:38 - Epoch 38
INFO - 07/09/25 13:56:02 - 0:14:01 - Epoch 39/200 | Step 1599 |  Avg Test Loss: 1.1822 | Test ROC-AUC: 0.7490
DEBUG - 07/09/25 13:56:02 - 0:14:01 - Epoch 39
INFO - 07/09/25 13:56:24 - 0:14:23 - Epoch 40/200 | Step 1640 |  Avg Test Loss: 1.2135 | Test ROC-AUC: 0.7219
DEBUG - 07/09/25 13:56:24 - 0:14:23 - Epoch 40
INFO - 07/09/25 13:56:46 - 0:14:45 - Epoch 41/200 | Step 1681 |  Avg Test Loss: 1.1759 | Test ROC-AUC: 0.7484
DEBUG - 07/09/25 13:56:47 - 0:14:45 - Epoch 41
INFO - 07/09/25 13:57:08 - 0:15:07 - Epoch 42/200 | Step 1722 |  Avg Test Loss: 1.2261 | Test ROC-AUC: 0.6927
DEBUG - 07/09/25 13:57:08 - 0:15:07 - Epoch 42
INFO - 07/09/25 13:57:29 - 0:15:28 - Epoch 43/200 | Step 1763 |  Avg Test Loss: 1.2095 | Test ROC-AUC: 0.7188
DEBUG - 07/09/25 13:57:29 - 0:15:28 - Epoch 43
INFO - 07/09/25 13:57:51 - 0:15:50 - Epoch 44/200 | Step 1804 |  Avg Test Loss: 1.1965 | Test ROC-AUC: 0.7234
DEBUG - 07/09/25 13:57:51 - 0:15:50 - Epoch 44
INFO - 07/09/25 13:58:13 - 0:16:12 - Epoch 45/200 | Step 1845 |  Avg Test Loss: 1.1769 | Test ROC-AUC: 0.7474
DEBUG - 07/09/25 13:58:14 - 0:16:12 - Epoch 45
INFO - 07/09/25 13:58:36 - 0:16:34 - Epoch 46/200 | Step 1886 |  Avg Test Loss: 1.1689 | Test ROC-AUC: 0.7411
DEBUG - 07/09/25 13:58:36 - 0:16:35 - Epoch 46
INFO - 07/09/25 13:58:58 - 0:16:57 - Epoch 47/200 | Step 1927 |  Avg Test Loss: 1.1986 | Test ROC-AUC: 0.7844
DEBUG - 07/09/25 13:58:58 - 0:16:57 - Epoch 47
INFO - 07/09/25 13:59:20 - 0:17:19 - Epoch 48/200 | Step 1968 |  Avg Test Loss: 1.2106 | Test ROC-AUC: 0.7521
DEBUG - 07/09/25 13:59:20 - 0:17:19 - Epoch 48
INFO - 07/09/25 13:59:42 - 0:17:41 - Epoch 49/200 | Step 2009 |  Avg Test Loss: 1.1765 | Test ROC-AUC: 0.7505
DEBUG - 07/09/25 13:59:42 - 0:17:41 - Epoch 49
INFO - 07/09/25 14:00:05 - 0:18:04 - Epoch 50/200 | Step 2050 |  Avg Test Loss: 1.1672 | Test ROC-AUC: 0.7719
DEBUG - 07/09/25 14:00:05 - 0:18:04 - Epoch 50
INFO - 07/09/25 14:00:29 - 0:18:27 - Epoch 51/200 | Step 2091 |  Avg Test Loss: 1.1789 | Test ROC-AUC: 0.7115
DEBUG - 07/09/25 14:00:29 - 0:18:27 - Epoch 51
INFO - 07/09/25 14:00:52 - 0:18:50 - Epoch 52/200 | Step 2132 |  Avg Test Loss: 1.2043 | Test ROC-AUC: 0.8063
DEBUG - 07/09/25 14:00:52 - 0:18:50 - Epoch 52
INFO - 07/09/25 14:01:14 - 0:19:13 - Epoch 53/200 | Step 2173 |  Avg Test Loss: 1.1625 | Test ROC-AUC: 0.7448
DEBUG - 07/09/25 14:01:15 - 0:19:13 - Epoch 53
INFO - 07/09/25 14:01:37 - 0:19:35 - Epoch 54/200 | Step 2214 |  Avg Test Loss: 1.1849 | Test ROC-AUC: 0.7109
DEBUG - 07/09/25 14:01:37 - 0:19:36 - Epoch 54
INFO - 07/09/25 14:01:59 - 0:19:58 - Epoch 55/200 | Step 2255 |  Avg Test Loss: 1.1567 | Test ROC-AUC: 0.7630
DEBUG - 07/09/25 14:01:59 - 0:19:58 - Epoch 55
INFO - 07/09/25 14:02:21 - 0:20:20 - Epoch 56/200 | Step 2296 |  Avg Test Loss: 1.1549 | Test ROC-AUC: 0.7833
DEBUG - 07/09/25 14:02:21 - 0:20:20 - Epoch 56
INFO - 07/09/25 14:02:44 - 0:20:43 - Epoch 57/200 | Step 2337 |  Avg Test Loss: 1.2136 | Test ROC-AUC: 0.6865
DEBUG - 07/09/25 14:02:44 - 0:20:43 - Epoch 57
INFO - 07/09/25 14:03:06 - 0:21:05 - Epoch 58/200 | Step 2378 |  Avg Test Loss: 1.2492 | Test ROC-AUC: 0.6781
DEBUG - 07/09/25 14:03:06 - 0:21:05 - Epoch 58
INFO - 07/09/25 14:03:28 - 0:21:27 - Epoch 59/200 | Step 2419 |  Avg Test Loss: 1.1890 | Test ROC-AUC: 0.7250
DEBUG - 07/09/25 14:03:28 - 0:21:27 - Epoch 59
INFO - 07/09/25 14:04:45 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 14:04:45 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/clintox/clintox.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 2
                                     path: /home/cassie/macfrag/data/clintox
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 14:04:45 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 14:04:45 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 14:04:45 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 14:04:45 - 0:00:00 - Loading data
DEBUG - 07/09/25 14:04:45 - 0:00:00 - Total size = 1478
DEBUG - 07/09/25 14:04:45 - 0:00:00 - Building model 0
DEBUG - 07/09/25 14:04:47 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=2, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 14:04:47 - 0:00:03 - Number of M1 parameters = 4,255,255
DEBUG - 07/09/25 14:04:47 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 14:04:47 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 14:04:47 - 0:00:03 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 14:04:47 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 14:04:47 - 0:00:03 - Epoch 0
INFO - 07/09/25 14:05:11 - 0:00:26 - Epoch 1/200 | Step 41 |  Avg Test Loss: 3.9315 | Test ROC-AUC: 0.5047
DEBUG - 07/09/25 14:05:11 - 0:00:26 - Epoch 1
INFO - 07/09/25 14:05:33 - 0:00:48 - Epoch 2/200 | Step 82 |  Avg Test Loss: 2.9707 | Test ROC-AUC: 0.4964
DEBUG - 07/09/25 14:05:33 - 0:00:48 - Epoch 2
INFO - 07/09/25 14:05:55 - 0:01:10 - Epoch 3/200 | Step 123 |  Avg Test Loss: 2.2552 | Test ROC-AUC: 0.4672
DEBUG - 07/09/25 14:05:55 - 0:01:10 - Epoch 3
INFO - 07/09/25 14:06:16 - 0:01:31 - Epoch 4/200 | Step 164 |  Avg Test Loss: 1.8140 | Test ROC-AUC: 0.4667
DEBUG - 07/09/25 14:06:16 - 0:01:32 - Epoch 4
INFO - 07/09/25 14:06:37 - 0:01:53 - Epoch 5/200 | Step 205 |  Avg Test Loss: 1.5848 | Test ROC-AUC: 0.4547
DEBUG - 07/09/25 14:06:37 - 0:01:53 - Epoch 5
INFO - 07/09/25 14:06:59 - 0:02:14 - Epoch 6/200 | Step 246 |  Avg Test Loss: 1.5122 | Test ROC-AUC: 0.4651
DEBUG - 07/09/25 14:06:59 - 0:02:14 - Epoch 6
INFO - 07/09/25 14:07:20 - 0:02:36 - Epoch 7/200 | Step 287 |  Avg Test Loss: 1.4588 | Test ROC-AUC: 0.4771
DEBUG - 07/09/25 14:07:20 - 0:02:36 - Epoch 7
INFO - 07/09/25 14:07:42 - 0:02:57 - Epoch 8/200 | Step 328 |  Avg Test Loss: 1.4412 | Test ROC-AUC: 0.4901
DEBUG - 07/09/25 14:07:42 - 0:02:57 - Epoch 8
INFO - 07/09/25 14:08:03 - 0:03:18 - Epoch 9/200 | Step 369 |  Avg Test Loss: 1.4402 | Test ROC-AUC: 0.4964
DEBUG - 07/09/25 14:08:03 - 0:03:19 - Epoch 9
INFO - 07/09/25 14:08:24 - 0:03:40 - Epoch 10/200 | Step 410 |  Avg Test Loss: 1.4217 | Test ROC-AUC: 0.5010
DEBUG - 07/09/25 14:08:25 - 0:03:40 - Epoch 10
INFO - 07/09/25 14:08:46 - 0:04:01 - Epoch 11/200 | Step 451 |  Avg Test Loss: 1.4129 | Test ROC-AUC: 0.5234
DEBUG - 07/09/25 14:08:46 - 0:04:02 - Epoch 11
INFO - 07/09/25 14:09:07 - 0:04:23 - Epoch 12/200 | Step 492 |  Avg Test Loss: 1.4060 | Test ROC-AUC: 0.5583
DEBUG - 07/09/25 14:09:07 - 0:04:23 - Epoch 12
INFO - 07/09/25 14:09:29 - 0:04:44 - Epoch 13/200 | Step 533 |  Avg Test Loss: 1.4084 | Test ROC-AUC: 0.5589
DEBUG - 07/09/25 14:09:29 - 0:04:44 - Epoch 13
INFO - 07/09/25 14:09:50 - 0:05:06 - Epoch 14/200 | Step 574 |  Avg Test Loss: 1.3995 | Test ROC-AUC: 0.5875
DEBUG - 07/09/25 14:09:50 - 0:05:06 - Epoch 14
INFO - 07/09/25 14:10:12 - 0:05:27 - Epoch 15/200 | Step 615 |  Avg Test Loss: 1.3957 | Test ROC-AUC: 0.6047
DEBUG - 07/09/25 14:10:12 - 0:05:27 - Epoch 15
INFO - 07/09/25 14:10:33 - 0:05:48 - Epoch 16/200 | Step 656 |  Avg Test Loss: 1.4034 | Test ROC-AUC: 0.6005
DEBUG - 07/09/25 14:10:33 - 0:05:48 - Epoch 16
INFO - 07/09/25 14:10:55 - 0:06:10 - Epoch 17/200 | Step 697 |  Avg Test Loss: 1.4010 | Test ROC-AUC: 0.6042
DEBUG - 07/09/25 14:10:55 - 0:06:10 - Epoch 17
INFO - 07/09/25 14:11:17 - 0:06:32 - Epoch 18/200 | Step 738 |  Avg Test Loss: 1.3844 | Test ROC-AUC: 0.6656
DEBUG - 07/09/25 14:11:17 - 0:06:32 - Epoch 18
INFO - 07/09/25 14:11:38 - 0:06:54 - Epoch 19/200 | Step 779 |  Avg Test Loss: 1.3813 | Test ROC-AUC: 0.6729
DEBUG - 07/09/25 14:11:38 - 0:06:54 - Epoch 19
INFO - 07/09/25 14:12:00 - 0:07:15 - Epoch 20/200 | Step 820 |  Avg Test Loss: 1.3772 | Test ROC-AUC: 0.6724
DEBUG - 07/09/25 14:12:00 - 0:07:15 - Epoch 20
INFO - 07/09/25 14:12:21 - 0:07:36 - Epoch 21/200 | Step 861 |  Avg Test Loss: 1.3886 | Test ROC-AUC: 0.6578
DEBUG - 07/09/25 14:12:21 - 0:07:36 - Epoch 21
INFO - 07/09/25 14:12:42 - 0:07:58 - Epoch 22/200 | Step 902 |  Avg Test Loss: 1.3724 | Test ROC-AUC: 0.6958
DEBUG - 07/09/25 14:12:42 - 0:07:58 - Epoch 22
INFO - 07/09/25 14:13:03 - 0:08:19 - Epoch 23/200 | Step 943 |  Avg Test Loss: 1.3658 | Test ROC-AUC: 0.7651
DEBUG - 07/09/25 14:13:03 - 0:08:19 - Epoch 23
INFO - 07/09/25 14:13:25 - 0:08:40 - Epoch 24/200 | Step 984 |  Avg Test Loss: 1.3601 | Test ROC-AUC: 0.7406
DEBUG - 07/09/25 14:13:25 - 0:08:40 - Epoch 24
INFO - 07/09/25 14:13:46 - 0:09:02 - Epoch 25/200 | Step 1025 |  Avg Test Loss: 1.4100 | Test ROC-AUC: 0.6703
DEBUG - 07/09/25 14:13:46 - 0:09:02 - Epoch 25
INFO - 07/09/25 14:14:08 - 0:09:23 - Epoch 26/200 | Step 1066 |  Avg Test Loss: 1.3867 | Test ROC-AUC: 0.7292
DEBUG - 07/09/25 14:14:08 - 0:09:23 - Epoch 26
INFO - 07/09/25 14:14:29 - 0:09:44 - Epoch 27/200 | Step 1107 |  Avg Test Loss: 1.3718 | Test ROC-AUC: 0.6969
DEBUG - 07/09/25 14:14:29 - 0:09:44 - Epoch 27
INFO - 07/09/25 14:14:50 - 0:10:06 - Epoch 28/200 | Step 1148 |  Avg Test Loss: 1.3871 | Test ROC-AUC: 0.8120
DEBUG - 07/09/25 14:14:50 - 0:10:06 - Epoch 28
INFO - 07/09/25 14:15:12 - 0:10:27 - Epoch 29/200 | Step 1189 |  Avg Test Loss: 1.3516 | Test ROC-AUC: 0.7948
DEBUG - 07/09/25 14:15:12 - 0:10:27 - Epoch 29
INFO - 07/09/25 14:15:33 - 0:10:48 - Epoch 30/200 | Step 1230 |  Avg Test Loss: 1.3661 | Test ROC-AUC: 0.7995
DEBUG - 07/09/25 14:15:33 - 0:10:48 - Epoch 30
INFO - 07/09/25 14:15:54 - 0:11:10 - Epoch 31/200 | Step 1271 |  Avg Test Loss: 1.3462 | Test ROC-AUC: 0.7906
DEBUG - 07/09/25 14:15:54 - 0:11:10 - Epoch 31
INFO - 07/09/25 14:16:16 - 0:11:32 - Epoch 32/200 | Step 1312 |  Avg Test Loss: 1.3537 | Test ROC-AUC: 0.8318
DEBUG - 07/09/25 14:16:16 - 0:11:32 - Epoch 32
INFO - 07/09/25 14:16:37 - 0:11:53 - Epoch 33/200 | Step 1353 |  Avg Test Loss: 1.3452 | Test ROC-AUC: 0.7823
DEBUG - 07/09/25 14:16:38 - 0:11:53 - Epoch 33
INFO - 07/09/25 14:16:59 - 0:12:14 - Epoch 34/200 | Step 1394 |  Avg Test Loss: 1.3480 | Test ROC-AUC: 0.7500
DEBUG - 07/09/25 14:16:59 - 0:12:14 - Epoch 34
INFO - 07/09/25 14:17:20 - 0:12:36 - Epoch 35/200 | Step 1435 |  Avg Test Loss: 1.3564 | Test ROC-AUC: 0.7240
DEBUG - 07/09/25 14:17:20 - 0:12:36 - Epoch 35
INFO - 07/09/25 14:17:42 - 0:12:57 - Epoch 36/200 | Step 1476 |  Avg Test Loss: 1.3495 | Test ROC-AUC: 0.7312
DEBUG - 07/09/25 14:17:42 - 0:12:57 - Epoch 36
INFO - 07/09/25 14:18:03 - 0:13:18 - Epoch 37/200 | Step 1517 |  Avg Test Loss: 1.3975 | Test ROC-AUC: 0.7286
DEBUG - 07/09/25 14:18:03 - 0:13:19 - Epoch 37
INFO - 07/09/25 14:18:24 - 0:13:40 - Epoch 38/200 | Step 1558 |  Avg Test Loss: 1.3581 | Test ROC-AUC: 0.8745
DEBUG - 07/09/25 14:18:24 - 0:13:40 - Epoch 38
INFO - 07/09/25 14:18:46 - 0:14:01 - Epoch 39/200 | Step 1599 |  Avg Test Loss: 1.3435 | Test ROC-AUC: 0.7594
DEBUG - 07/09/25 14:18:46 - 0:14:02 - Epoch 39
INFO - 07/09/25 14:19:08 - 0:14:23 - Epoch 40/200 | Step 1640 |  Avg Test Loss: 1.3605 | Test ROC-AUC: 0.7406
DEBUG - 07/09/25 14:19:08 - 0:14:23 - Epoch 40
INFO - 07/09/25 14:19:29 - 0:14:45 - Epoch 41/200 | Step 1681 |  Avg Test Loss: 1.3459 | Test ROC-AUC: 0.7880
DEBUG - 07/09/25 14:19:30 - 0:14:45 - Epoch 41
INFO - 07/09/25 14:19:51 - 0:15:07 - Epoch 42/200 | Step 1722 |  Avg Test Loss: 1.3719 | Test ROC-AUC: 0.6891
DEBUG - 07/09/25 14:19:51 - 0:15:07 - Epoch 42
INFO - 07/09/25 14:20:13 - 0:15:28 - Epoch 43/200 | Step 1763 |  Avg Test Loss: 1.3527 | Test ROC-AUC: 0.7583
DEBUG - 07/09/25 14:20:13 - 0:15:28 - Epoch 43
INFO - 07/09/25 14:20:35 - 0:15:50 - Epoch 44/200 | Step 1804 |  Avg Test Loss: 1.3499 | Test ROC-AUC: 0.7599
DEBUG - 07/09/25 14:20:35 - 0:15:51 - Epoch 44
INFO - 07/09/25 14:20:57 - 0:16:12 - Epoch 45/200 | Step 1845 |  Avg Test Loss: 1.3327 | Test ROC-AUC: 0.8068
DEBUG - 07/09/25 14:20:57 - 0:16:12 - Epoch 45
INFO - 07/09/25 14:21:19 - 0:16:34 - Epoch 46/200 | Step 1886 |  Avg Test Loss: 1.3448 | Test ROC-AUC: 0.7724
DEBUG - 07/09/25 14:21:19 - 0:16:34 - Epoch 46
INFO - 07/09/25 14:21:40 - 0:16:56 - Epoch 47/200 | Step 1927 |  Avg Test Loss: 1.3307 | Test ROC-AUC: 0.8109
DEBUG - 07/09/25 14:21:40 - 0:16:56 - Epoch 47
INFO - 07/09/25 14:22:03 - 0:17:18 - Epoch 48/200 | Step 1968 |  Avg Test Loss: 1.3455 | Test ROC-AUC: 0.7927
DEBUG - 07/09/25 14:22:03 - 0:17:18 - Epoch 48
INFO - 07/09/25 14:22:24 - 0:17:40 - Epoch 49/200 | Step 2009 |  Avg Test Loss: 1.3752 | Test ROC-AUC: 0.7443
DEBUG - 07/09/25 14:22:24 - 0:17:40 - Epoch 49
INFO - 07/09/25 14:22:46 - 0:18:01 - Epoch 50/200 | Step 2050 |  Avg Test Loss: 1.3418 | Test ROC-AUC: 0.7807
DEBUG - 07/09/25 14:22:46 - 0:18:01 - Epoch 50
INFO - 07/09/25 14:23:08 - 0:18:23 - Epoch 51/200 | Step 2091 |  Avg Test Loss: 1.3589 | Test ROC-AUC: 0.7042
DEBUG - 07/09/25 14:23:08 - 0:18:23 - Epoch 51
INFO - 07/09/25 14:23:29 - 0:18:45 - Epoch 52/200 | Step 2132 |  Avg Test Loss: 1.3660 | Test ROC-AUC: 0.8589
DEBUG - 07/09/25 14:23:30 - 0:18:45 - Epoch 52
INFO - 07/09/25 14:23:51 - 0:19:07 - Epoch 53/200 | Step 2173 |  Avg Test Loss: 1.3653 | Test ROC-AUC: 0.7221
DEBUG - 07/09/25 14:23:51 - 0:19:07 - Epoch 53
INFO - 07/09/25 14:24:13 - 0:19:28 - Epoch 54/200 | Step 2214 |  Avg Test Loss: 1.3576 | Test ROC-AUC: 0.7271
DEBUG - 07/09/25 14:24:13 - 0:19:29 - Epoch 54
INFO - 07/09/25 14:24:35 - 0:19:51 - Epoch 55/200 | Step 2255 |  Avg Test Loss: 1.3291 | Test ROC-AUC: 0.8198
DEBUG - 07/09/25 14:24:35 - 0:19:51 - Epoch 55
INFO - 07/09/25 14:24:57 - 0:20:12 - Epoch 56/200 | Step 2296 |  Avg Test Loss: 1.3260 | Test ROC-AUC: 0.8427
DEBUG - 07/09/25 14:24:57 - 0:20:13 - Epoch 56
INFO - 07/09/25 14:25:19 - 0:20:34 - Epoch 57/200 | Step 2337 |  Avg Test Loss: 1.3714 | Test ROC-AUC: 0.7302
DEBUG - 07/09/25 14:25:19 - 0:20:34 - Epoch 57
INFO - 07/09/25 14:27:23 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 14:27:23 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/clintox/bbbp.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 2
                                     path: /home/cassie/macfrag/data/bbbp
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 14:27:23 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 14:27:23 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 14:27:23 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 14:27:23 - 0:00:00 - Loading data
INFO - 07/09/25 14:27:39 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 14:27:39 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bbbp/bbbp.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 2
                                     path: /home/cassie/macfrag/data/bbbp
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 14:27:39 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 14:27:39 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 14:27:39 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 14:27:39 - 0:00:00 - Loading data
DEBUG - 07/09/25 14:27:39 - 0:00:00 - Total size = 2039
DEBUG - 07/09/25 14:27:39 - 0:00:00 - Building model 0
DEBUG - 07/09/25 14:27:42 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=2, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 14:27:42 - 0:00:03 - Number of M1 parameters = 4,255,255
DEBUG - 07/09/25 14:27:42 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 14:27:42 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 14:27:42 - 0:00:03 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 14:27:42 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 14:27:42 - 0:00:03 - Epoch 0
INFO - 07/09/25 14:28:15 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 14:28:15 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bbbp/bbbp.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bbbp
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 14:28:15 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 14:28:15 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 14:28:15 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 14:28:15 - 0:00:00 - Loading data
DEBUG - 07/09/25 14:28:15 - 0:00:00 - Total size = 2039
DEBUG - 07/09/25 14:28:15 - 0:00:00 - Building model 0
DEBUG - 07/09/25 14:28:18 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 14:28:18 - 0:00:03 - Number of M1 parameters = 4,254,754
DEBUG - 07/09/25 14:28:18 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 14:28:18 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 14:28:18 - 0:00:03 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 14:28:18 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 14:28:18 - 0:00:03 - Epoch 0
INFO - 07/09/25 14:28:37 - 0:00:23 - Epoch 1/200 | Step 57 |  Avg Test Loss: 1.9220 | Test ROC-AUC: 0.6651
DEBUG - 07/09/25 14:28:38 - 0:00:23 - Epoch 1
INFO - 07/09/25 14:28:56 - 0:00:42 - Epoch 2/200 | Step 114 |  Avg Test Loss: 1.5380 | Test ROC-AUC: 0.7466
DEBUG - 07/09/25 14:28:56 - 0:00:42 - Epoch 2
INFO - 07/09/25 14:29:16 - 0:01:01 - Epoch 3/200 | Step 171 |  Avg Test Loss: 1.4060 | Test ROC-AUC: 0.7617
DEBUG - 07/09/25 14:29:16 - 0:01:01 - Epoch 3
INFO - 07/09/25 14:29:35 - 0:01:20 - Epoch 4/200 | Step 228 |  Avg Test Loss: 1.2793 | Test ROC-AUC: 0.7824
DEBUG - 07/09/25 14:29:35 - 0:01:20 - Epoch 4
INFO - 07/09/25 14:29:54 - 0:01:39 - Epoch 5/200 | Step 285 |  Avg Test Loss: 1.0970 | Test ROC-AUC: 0.8070
DEBUG - 07/09/25 14:29:54 - 0:01:39 - Epoch 5
INFO - 07/09/25 14:30:13 - 0:01:59 - Epoch 6/200 | Step 342 |  Avg Test Loss: 0.9390 | Test ROC-AUC: 0.8205
DEBUG - 07/09/25 14:30:13 - 0:01:59 - Epoch 6
INFO - 07/09/25 14:30:33 - 0:02:18 - Epoch 7/200 | Step 399 |  Avg Test Loss: 0.8474 | Test ROC-AUC: 0.8381
DEBUG - 07/09/25 14:30:33 - 0:02:18 - Epoch 7
INFO - 07/09/25 14:30:52 - 0:02:37 - Epoch 8/200 | Step 456 |  Avg Test Loss: 0.7330 | Test ROC-AUC: 0.8466
DEBUG - 07/09/25 14:30:52 - 0:02:37 - Epoch 8
INFO - 07/09/25 14:31:11 - 0:02:56 - Epoch 9/200 | Step 513 |  Avg Test Loss: 0.6556 | Test ROC-AUC: 0.8500
DEBUG - 07/09/25 14:31:11 - 0:02:56 - Epoch 9
INFO - 07/09/25 14:31:31 - 0:03:16 - Epoch 10/200 | Step 570 |  Avg Test Loss: 0.6397 | Test ROC-AUC: 0.8375
DEBUG - 07/09/25 14:31:31 - 0:03:16 - Epoch 10
INFO - 07/09/25 14:31:50 - 0:03:35 - Epoch 11/200 | Step 627 |  Avg Test Loss: 0.5522 | Test ROC-AUC: 0.8550
DEBUG - 07/09/25 14:31:50 - 0:03:35 - Epoch 11
INFO - 07/09/25 14:32:09 - 0:03:54 - Epoch 12/200 | Step 684 |  Avg Test Loss: 0.5546 | Test ROC-AUC: 0.8635
DEBUG - 07/09/25 14:32:09 - 0:03:55 - Epoch 12
INFO - 07/09/25 14:32:28 - 0:04:14 - Epoch 13/200 | Step 741 |  Avg Test Loss: 0.5471 | Test ROC-AUC: 0.8661
DEBUG - 07/09/25 14:32:29 - 0:04:14 - Epoch 13
INFO - 07/09/25 14:32:48 - 0:04:33 - Epoch 14/200 | Step 798 |  Avg Test Loss: 0.5030 | Test ROC-AUC: 0.8497
DEBUG - 07/09/25 14:32:48 - 0:04:33 - Epoch 14
INFO - 07/09/25 14:33:07 - 0:04:52 - Epoch 15/200 | Step 855 |  Avg Test Loss: 0.4698 | Test ROC-AUC: 0.8587
DEBUG - 07/09/25 14:33:07 - 0:04:52 - Epoch 15
INFO - 07/09/25 14:33:26 - 0:05:11 - Epoch 16/200 | Step 912 |  Avg Test Loss: 0.4691 | Test ROC-AUC: 0.8650
DEBUG - 07/09/25 14:33:26 - 0:05:12 - Epoch 16
INFO - 07/09/25 14:33:45 - 0:05:30 - Epoch 17/200 | Step 969 |  Avg Test Loss: 0.4406 | Test ROC-AUC: 0.8744
DEBUG - 07/09/25 14:33:45 - 0:05:31 - Epoch 17
INFO - 07/09/25 14:34:05 - 0:05:50 - Epoch 18/200 | Step 1026 |  Avg Test Loss: 0.4363 | Test ROC-AUC: 0.8467
DEBUG - 07/09/25 14:34:05 - 0:05:50 - Epoch 18
INFO - 07/09/25 14:34:24 - 0:06:09 - Epoch 19/200 | Step 1083 |  Avg Test Loss: 0.5231 | Test ROC-AUC: 0.8719
DEBUG - 07/09/25 14:34:24 - 0:06:10 - Epoch 19
INFO - 07/09/25 14:34:44 - 0:06:29 - Epoch 20/200 | Step 1140 |  Avg Test Loss: 0.4254 | Test ROC-AUC: 0.8684
DEBUG - 07/09/25 14:34:44 - 0:06:29 - Epoch 20
INFO - 07/09/25 14:35:03 - 0:06:48 - Epoch 21/200 | Step 1197 |  Avg Test Loss: 0.3987 | Test ROC-AUC: 0.8656
DEBUG - 07/09/25 14:35:03 - 0:06:48 - Epoch 21
INFO - 07/09/25 14:35:22 - 0:07:07 - Epoch 22/200 | Step 1254 |  Avg Test Loss: 0.4037 | Test ROC-AUC: 0.8712
DEBUG - 07/09/25 14:35:22 - 0:07:08 - Epoch 22
INFO - 07/09/25 14:35:42 - 0:07:27 - Epoch 23/200 | Step 1311 |  Avg Test Loss: 0.3929 | Test ROC-AUC: 0.8722
DEBUG - 07/09/25 14:35:42 - 0:07:27 - Epoch 23
INFO - 07/09/25 14:36:01 - 0:07:46 - Epoch 24/200 | Step 1368 |  Avg Test Loss: 0.4150 | Test ROC-AUC: 0.8729
DEBUG - 07/09/25 14:36:01 - 0:07:46 - Epoch 24
INFO - 07/09/25 14:36:20 - 0:08:05 - Epoch 25/200 | Step 1425 |  Avg Test Loss: 0.3704 | Test ROC-AUC: 0.8825
DEBUG - 07/09/25 14:36:20 - 0:08:05 - Epoch 25
INFO - 07/09/25 14:36:40 - 0:08:25 - Epoch 26/200 | Step 1482 |  Avg Test Loss: 0.4485 | Test ROC-AUC: 0.8870
DEBUG - 07/09/25 14:36:40 - 0:08:25 - Epoch 26
INFO - 07/09/25 14:36:59 - 0:08:44 - Epoch 27/200 | Step 1539 |  Avg Test Loss: 0.3664 | Test ROC-AUC: 0.8822
DEBUG - 07/09/25 14:36:59 - 0:08:44 - Epoch 27
INFO - 07/09/25 14:37:18 - 0:09:03 - Epoch 28/200 | Step 1596 |  Avg Test Loss: 0.3707 | Test ROC-AUC: 0.8741
DEBUG - 07/09/25 14:37:18 - 0:09:03 - Epoch 28
INFO - 07/09/25 14:37:37 - 0:09:22 - Epoch 29/200 | Step 1653 |  Avg Test Loss: 0.3721 | Test ROC-AUC: 0.8626
DEBUG - 07/09/25 14:37:37 - 0:09:22 - Epoch 29
INFO - 07/09/25 14:37:56 - 0:09:41 - Epoch 30/200 | Step 1710 |  Avg Test Loss: 0.3484 | Test ROC-AUC: 0.8848
DEBUG - 07/09/25 14:37:56 - 0:09:42 - Epoch 30
INFO - 07/09/25 14:38:16 - 0:10:01 - Epoch 31/200 | Step 1767 |  Avg Test Loss: 0.3717 | Test ROC-AUC: 0.8839
DEBUG - 07/09/25 14:38:16 - 0:10:01 - Epoch 31
INFO - 07/09/25 14:38:35 - 0:10:20 - Epoch 32/200 | Step 1824 |  Avg Test Loss: 0.3448 | Test ROC-AUC: 0.8791
DEBUG - 07/09/25 14:38:35 - 0:10:20 - Epoch 32
INFO - 07/09/25 14:38:55 - 0:10:40 - Epoch 33/200 | Step 1881 |  Avg Test Loss: 0.3509 | Test ROC-AUC: 0.8879
DEBUG - 07/09/25 14:38:55 - 0:10:40 - Epoch 33
INFO - 07/09/25 14:39:14 - 0:10:59 - Epoch 34/200 | Step 1938 |  Avg Test Loss: 0.3485 | Test ROC-AUC: 0.8819
DEBUG - 07/09/25 14:39:14 - 0:10:59 - Epoch 34
INFO - 07/09/25 14:39:33 - 0:11:19 - Epoch 35/200 | Step 1995 |  Avg Test Loss: 0.3493 | Test ROC-AUC: 0.8752
DEBUG - 07/09/25 14:39:34 - 0:11:19 - Epoch 35
INFO - 07/09/25 14:39:53 - 0:11:38 - Epoch 36/200 | Step 2052 |  Avg Test Loss: 0.3451 | Test ROC-AUC: 0.8959
DEBUG - 07/09/25 14:39:53 - 0:11:38 - Epoch 36
INFO - 07/09/25 14:40:13 - 0:11:58 - Epoch 37/200 | Step 2109 |  Avg Test Loss: 0.3724 | Test ROC-AUC: 0.8719
DEBUG - 07/09/25 14:40:13 - 0:11:58 - Epoch 37
INFO - 07/09/25 14:40:32 - 0:12:17 - Epoch 38/200 | Step 2166 |  Avg Test Loss: 0.3680 | Test ROC-AUC: 0.8788
DEBUG - 07/09/25 14:40:32 - 0:12:17 - Epoch 38
INFO - 07/09/25 14:40:51 - 0:12:36 - Epoch 39/200 | Step 2223 |  Avg Test Loss: 0.3294 | Test ROC-AUC: 0.8925
DEBUG - 07/09/25 14:40:51 - 0:12:36 - Epoch 39
INFO - 07/09/25 14:41:10 - 0:12:55 - Epoch 40/200 | Step 2280 |  Avg Test Loss: 0.3269 | Test ROC-AUC: 0.8833
DEBUG - 07/09/25 14:41:10 - 0:12:56 - Epoch 40
INFO - 07/09/25 14:41:30 - 0:13:15 - Epoch 41/200 | Step 2337 |  Avg Test Loss: 0.3900 | Test ROC-AUC: 0.8787
DEBUG - 07/09/25 14:41:30 - 0:13:15 - Epoch 41
INFO - 07/09/25 14:41:49 - 0:13:35 - Epoch 42/200 | Step 2394 |  Avg Test Loss: 0.3586 | Test ROC-AUC: 0.8756
DEBUG - 07/09/25 14:41:49 - 0:13:35 - Epoch 42
INFO - 07/09/25 14:42:09 - 0:13:54 - Epoch 43/200 | Step 2451 |  Avg Test Loss: 0.3697 | Test ROC-AUC: 0.8704
DEBUG - 07/09/25 14:42:09 - 0:13:54 - Epoch 43
INFO - 07/09/25 14:42:28 - 0:14:13 - Epoch 44/200 | Step 2508 |  Avg Test Loss: 0.3383 | Test ROC-AUC: 0.8805
DEBUG - 07/09/25 14:42:28 - 0:14:13 - Epoch 44
INFO - 07/09/25 14:42:47 - 0:14:33 - Epoch 45/200 | Step 2565 |  Avg Test Loss: 0.3342 | Test ROC-AUC: 0.8934
DEBUG - 07/09/25 14:42:48 - 0:14:33 - Epoch 45
INFO - 07/09/25 14:43:07 - 0:14:52 - Epoch 46/200 | Step 2622 |  Avg Test Loss: 0.3310 | Test ROC-AUC: 0.8831
DEBUG - 07/09/25 14:43:07 - 0:14:52 - Epoch 46
INFO - 07/09/25 14:43:26 - 0:15:11 - Epoch 47/200 | Step 2679 |  Avg Test Loss: 0.3739 | Test ROC-AUC: 0.8828
DEBUG - 07/09/25 14:43:26 - 0:15:12 - Epoch 47
INFO - 07/09/25 14:43:46 - 0:15:31 - Epoch 48/200 | Step 2736 |  Avg Test Loss: 0.3328 | Test ROC-AUC: 0.9022
DEBUG - 07/09/25 14:43:46 - 0:15:31 - Epoch 48
INFO - 07/09/25 14:44:05 - 0:15:50 - Epoch 49/200 | Step 2793 |  Avg Test Loss: 0.3716 | Test ROC-AUC: 0.8788
DEBUG - 07/09/25 14:44:05 - 0:15:50 - Epoch 49
INFO - 07/09/25 14:44:24 - 0:16:09 - Epoch 50/200 | Step 2850 |  Avg Test Loss: 0.3482 | Test ROC-AUC: 0.8675
DEBUG - 07/09/25 14:44:24 - 0:16:09 - Epoch 50
INFO - 07/09/25 14:44:44 - 0:16:29 - Epoch 51/200 | Step 2907 |  Avg Test Loss: 0.3757 | Test ROC-AUC: 0.8601
DEBUG - 07/09/25 14:44:44 - 0:16:29 - Epoch 51
INFO - 07/09/25 14:45:03 - 0:16:48 - Epoch 52/200 | Step 2964 |  Avg Test Loss: 0.3400 | Test ROC-AUC: 0.8798
DEBUG - 07/09/25 14:45:03 - 0:16:48 - Epoch 52
INFO - 07/09/25 14:45:22 - 0:17:07 - Epoch 53/200 | Step 3021 |  Avg Test Loss: 0.3745 | Test ROC-AUC: 0.8713
DEBUG - 07/09/25 14:45:22 - 0:17:08 - Epoch 53
INFO - 07/09/25 14:45:42 - 0:17:27 - Epoch 54/200 | Step 3078 |  Avg Test Loss: 0.3554 | Test ROC-AUC: 0.8643
DEBUG - 07/09/25 14:45:42 - 0:17:27 - Epoch 54
INFO - 07/09/25 14:46:01 - 0:17:46 - Epoch 55/200 | Step 3135 |  Avg Test Loss: 0.3427 | Test ROC-AUC: 0.8968
DEBUG - 07/09/25 14:46:01 - 0:17:46 - Epoch 55
INFO - 07/09/25 14:46:20 - 0:18:05 - Epoch 56/200 | Step 3192 |  Avg Test Loss: 0.3519 | Test ROC-AUC: 0.8836
DEBUG - 07/09/25 14:46:20 - 0:18:05 - Epoch 56
INFO - 07/09/25 14:46:39 - 0:18:25 - Epoch 57/200 | Step 3249 |  Avg Test Loss: 0.3355 | Test ROC-AUC: 0.8768
DEBUG - 07/09/25 14:46:40 - 0:18:25 - Epoch 57
INFO - 07/09/25 14:46:59 - 0:18:44 - Epoch 58/200 | Step 3306 |  Avg Test Loss: 0.3648 | Test ROC-AUC: 0.8805
DEBUG - 07/09/25 14:46:59 - 0:18:44 - Epoch 58
INFO - 07/09/25 14:47:18 - 0:19:03 - Epoch 59/200 | Step 3363 |  Avg Test Loss: 0.3955 | Test ROC-AUC: 0.8788
DEBUG - 07/09/25 14:47:18 - 0:19:03 - Epoch 59
INFO - 07/09/25 14:47:37 - 0:19:22 - Epoch 60/200 | Step 3420 |  Avg Test Loss: 0.4932 | Test ROC-AUC: 0.8741
DEBUG - 07/09/25 14:47:37 - 0:19:22 - Epoch 60
INFO - 07/09/25 14:47:56 - 0:19:41 - Epoch 61/200 | Step 3477 |  Avg Test Loss: 0.4645 | Test ROC-AUC: 0.8673
DEBUG - 07/09/25 14:47:56 - 0:19:42 - Epoch 61
INFO - 07/09/25 14:48:16 - 0:20:01 - Epoch 62/200 | Step 3534 |  Avg Test Loss: 0.3704 | Test ROC-AUC: 0.8857
DEBUG - 07/09/25 14:48:16 - 0:20:01 - Epoch 62
INFO - 07/09/25 14:48:35 - 0:20:20 - Epoch 63/200 | Step 3591 |  Avg Test Loss: 0.4262 | Test ROC-AUC: 0.8675
DEBUG - 07/09/25 14:48:35 - 0:20:20 - Epoch 63
INFO - 07/09/25 14:48:55 - 0:20:40 - Epoch 64/200 | Step 3648 |  Avg Test Loss: 0.3439 | Test ROC-AUC: 0.8802
DEBUG - 07/09/25 14:48:55 - 0:20:40 - Epoch 64
INFO - 07/09/25 14:49:14 - 0:20:59 - Epoch 65/200 | Step 3705 |  Avg Test Loss: 0.3470 | Test ROC-AUC: 0.8755
DEBUG - 07/09/25 14:49:14 - 0:20:59 - Epoch 65
INFO - 07/09/25 14:49:33 - 0:21:18 - Epoch 66/200 | Step 3762 |  Avg Test Loss: 0.3379 | Test ROC-AUC: 0.8848
DEBUG - 07/09/25 14:49:33 - 0:21:18 - Epoch 66
INFO - 07/09/25 14:49:53 - 0:21:38 - Epoch 67/200 | Step 3819 |  Avg Test Loss: 0.3647 | Test ROC-AUC: 0.8980
DEBUG - 07/09/25 14:49:53 - 0:21:38 - Epoch 67
INFO - 07/09/25 14:50:12 - 0:21:57 - Epoch 68/200 | Step 3876 |  Avg Test Loss: 0.3542 | Test ROC-AUC: 0.8881
DEBUG - 07/09/25 14:50:12 - 0:21:57 - Epoch 68
INFO - 07/09/25 14:50:31 - 0:22:16 - Epoch 69/200 | Step 3933 |  Avg Test Loss: 0.4098 | Test ROC-AUC: 0.8887
DEBUG - 07/09/25 14:50:31 - 0:22:17 - Epoch 69
INFO - 07/09/25 14:50:51 - 0:22:36 - Epoch 70/200 | Step 3990 |  Avg Test Loss: 0.3837 | Test ROC-AUC: 0.8715
DEBUG - 07/09/25 14:50:51 - 0:22:36 - Epoch 70
INFO - 07/09/25 14:51:10 - 0:22:55 - Epoch 71/200 | Step 4047 |  Avg Test Loss: 0.3320 | Test ROC-AUC: 0.8888
DEBUG - 07/09/25 14:51:10 - 0:22:55 - Epoch 71
INFO - 07/09/25 14:51:29 - 0:23:14 - Epoch 72/200 | Step 4104 |  Avg Test Loss: 0.3792 | Test ROC-AUC: 0.8589
DEBUG - 07/09/25 14:51:29 - 0:23:14 - Epoch 72
INFO - 07/09/25 14:51:48 - 0:23:33 - Epoch 73/200 | Step 4161 |  Avg Test Loss: 0.3687 | Test ROC-AUC: 0.8859
DEBUG - 07/09/25 14:51:48 - 0:23:33 - Epoch 73
INFO - 07/09/25 14:52:07 - 0:23:52 - Epoch 74/200 | Step 4218 |  Avg Test Loss: 0.3861 | Test ROC-AUC: 0.8830
DEBUG - 07/09/25 14:52:07 - 0:23:53 - Epoch 74
INFO - 07/09/25 14:52:27 - 0:24:12 - Epoch 75/200 | Step 4275 |  Avg Test Loss: 0.3853 | Test ROC-AUC: 0.8801
DEBUG - 07/09/25 14:52:27 - 0:24:12 - Epoch 75
INFO - 07/09/25 14:52:47 - 0:24:32 - Epoch 76/200 | Step 4332 |  Avg Test Loss: 0.4653 | Test ROC-AUC: 0.8808
DEBUG - 07/09/25 14:52:47 - 0:24:32 - Epoch 76
INFO - 07/09/25 14:53:06 - 0:24:51 - Epoch 77/200 | Step 4389 |  Avg Test Loss: 0.3203 | Test ROC-AUC: 0.8900
DEBUG - 07/09/25 14:53:06 - 0:24:52 - Epoch 77
INFO - 07/09/25 14:53:26 - 0:25:11 - Epoch 78/200 | Step 4446 |  Avg Test Loss: 0.3865 | Test ROC-AUC: 0.8799
DEBUG - 07/09/25 14:53:26 - 0:25:11 - Epoch 78
INFO - 07/09/25 14:53:45 - 0:25:30 - Epoch 79/200 | Step 4503 |  Avg Test Loss: 0.3733 | Test ROC-AUC: 0.8897
DEBUG - 07/09/25 14:53:45 - 0:25:30 - Epoch 79
INFO - 07/09/25 14:54:04 - 0:25:49 - Epoch 80/200 | Step 4560 |  Avg Test Loss: 0.3808 | Test ROC-AUC: 0.8867
DEBUG - 07/09/25 14:54:04 - 0:25:49 - Epoch 80
INFO - 07/09/25 14:54:23 - 0:26:08 - Epoch 81/200 | Step 4617 |  Avg Test Loss: 0.3797 | Test ROC-AUC: 0.8752
DEBUG - 07/09/25 14:54:23 - 0:26:09 - Epoch 81
INFO - 07/09/25 14:54:42 - 0:26:28 - Epoch 82/200 | Step 4674 |  Avg Test Loss: 0.3679 | Test ROC-AUC: 0.8831
DEBUG - 07/09/25 14:54:42 - 0:26:28 - Epoch 82
INFO - 07/09/25 14:55:02 - 0:26:47 - Epoch 83/200 | Step 4731 |  Avg Test Loss: 0.4208 | Test ROC-AUC: 0.8661
DEBUG - 07/09/25 14:55:02 - 0:26:47 - Epoch 83
INFO - 07/09/25 14:55:21 - 0:27:06 - Epoch 84/200 | Step 4788 |  Avg Test Loss: 0.3846 | Test ROC-AUC: 0.8647
DEBUG - 07/09/25 14:55:21 - 0:27:06 - Epoch 84
INFO - 07/09/25 14:55:41 - 0:27:26 - Epoch 85/200 | Step 4845 |  Avg Test Loss: 0.3740 | Test ROC-AUC: 0.8775
DEBUG - 07/09/25 14:55:41 - 0:27:26 - Epoch 85
INFO - 07/09/25 14:56:01 - 0:27:46 - Epoch 86/200 | Step 4902 |  Avg Test Loss: 0.4554 | Test ROC-AUC: 0.8704
DEBUG - 07/09/25 14:56:01 - 0:27:46 - Epoch 86
INFO - 07/09/25 14:56:21 - 0:28:06 - Epoch 87/200 | Step 4959 |  Avg Test Loss: 0.4249 | Test ROC-AUC: 0.8601
DEBUG - 07/09/25 14:56:21 - 0:28:06 - Epoch 87
INFO - 07/09/25 14:56:40 - 0:28:25 - Epoch 88/200 | Step 5016 |  Avg Test Loss: 0.4431 | Test ROC-AUC: 0.8759
DEBUG - 07/09/25 14:56:40 - 0:28:25 - Epoch 88
INFO - 07/09/25 14:56:59 - 0:28:44 - Epoch 89/200 | Step 5073 |  Avg Test Loss: 0.3897 | Test ROC-AUC: 0.8796
DEBUG - 07/09/25 14:56:59 - 0:28:44 - Epoch 89
INFO - 07/09/25 14:57:19 - 0:29:04 - Epoch 90/200 | Step 5130 |  Avg Test Loss: 0.3798 | Test ROC-AUC: 0.8841
DEBUG - 07/09/25 14:57:19 - 0:29:04 - Epoch 90
INFO - 07/09/25 14:57:38 - 0:29:23 - Epoch 91/200 | Step 5187 |  Avg Test Loss: 0.3933 | Test ROC-AUC: 0.8865
DEBUG - 07/09/25 14:57:38 - 0:29:23 - Epoch 91
INFO - 07/09/25 14:57:58 - 0:29:43 - Epoch 92/200 | Step 5244 |  Avg Test Loss: 0.5201 | Test ROC-AUC: 0.8798
DEBUG - 07/09/25 14:57:58 - 0:29:43 - Epoch 92
INFO - 07/09/25 14:58:17 - 0:30:02 - Epoch 93/200 | Step 5301 |  Avg Test Loss: 0.4141 | Test ROC-AUC: 0.8859
DEBUG - 07/09/25 14:58:17 - 0:30:03 - Epoch 93
INFO - 07/09/25 14:58:37 - 0:30:22 - Epoch 94/200 | Step 5358 |  Avg Test Loss: 0.3785 | Test ROC-AUC: 0.8928
DEBUG - 07/09/25 14:58:37 - 0:30:22 - Epoch 94
INFO - 07/09/25 14:58:56 - 0:30:41 - Epoch 95/200 | Step 5415 |  Avg Test Loss: 0.4017 | Test ROC-AUC: 0.8755
DEBUG - 07/09/25 14:58:56 - 0:30:41 - Epoch 95
INFO - 07/09/25 14:59:15 - 0:31:00 - Epoch 96/200 | Step 5472 |  Avg Test Loss: 0.4787 | Test ROC-AUC: 0.8444
DEBUG - 07/09/25 14:59:15 - 0:31:00 - Epoch 96
INFO - 07/09/25 14:59:34 - 0:31:20 - Epoch 97/200 | Step 5529 |  Avg Test Loss: 0.3550 | Test ROC-AUC: 0.8888
DEBUG - 07/09/25 14:59:34 - 0:31:20 - Epoch 97
INFO - 07/09/25 14:59:54 - 0:31:39 - Epoch 98/200 | Step 5586 |  Avg Test Loss: 0.3898 | Test ROC-AUC: 0.8807
DEBUG - 07/09/25 14:59:54 - 0:31:39 - Epoch 98
INFO - 07/09/25 15:00:13 - 0:31:58 - Epoch 99/200 | Step 5643 |  Avg Test Loss: 0.3934 | Test ROC-AUC: 0.8653
DEBUG - 07/09/25 15:00:13 - 0:31:59 - Epoch 99
INFO - 07/09/25 15:00:33 - 0:32:18 - Epoch 100/200 | Step 5700 |  Avg Test Loss: 0.4464 | Test ROC-AUC: 0.8850
DEBUG - 07/09/25 15:00:33 - 0:32:18 - Epoch 100
INFO - 07/09/25 15:00:52 - 0:32:37 - Epoch 101/200 | Step 5757 |  Avg Test Loss: 0.4237 | Test ROC-AUC: 0.8908
DEBUG - 07/09/25 15:00:52 - 0:32:37 - Epoch 101
INFO - 07/09/25 15:01:11 - 0:32:56 - Epoch 102/200 | Step 5814 |  Avg Test Loss: 0.4116 | Test ROC-AUC: 0.8650
DEBUG - 07/09/25 15:01:11 - 0:32:57 - Epoch 102
INFO - 07/09/25 15:01:31 - 0:33:16 - Epoch 103/200 | Step 5871 |  Avg Test Loss: 0.4001 | Test ROC-AUC: 0.8647
DEBUG - 07/09/25 15:01:31 - 0:33:16 - Epoch 103
INFO - 07/09/25 15:01:50 - 0:33:35 - Epoch 104/200 | Step 5928 |  Avg Test Loss: 0.4207 | Test ROC-AUC: 0.8913
DEBUG - 07/09/25 15:01:50 - 0:33:35 - Epoch 104
INFO - 07/09/25 15:02:09 - 0:33:55 - Epoch 105/200 | Step 5985 |  Avg Test Loss: 0.3565 | Test ROC-AUC: 0.8752
DEBUG - 07/09/25 15:02:09 - 0:33:55 - Epoch 105
INFO - 07/09/25 15:02:29 - 0:34:14 - Epoch 106/200 | Step 6042 |  Avg Test Loss: 0.3784 | Test ROC-AUC: 0.8764
DEBUG - 07/09/25 15:02:29 - 0:34:14 - Epoch 106
INFO - 07/09/25 15:02:48 - 0:34:33 - Epoch 107/200 | Step 6099 |  Avg Test Loss: 0.4068 | Test ROC-AUC: 0.8917
DEBUG - 07/09/25 15:02:48 - 0:34:33 - Epoch 107
INFO - 07/09/25 15:03:07 - 0:34:52 - Epoch 108/200 | Step 6156 |  Avg Test Loss: 0.5041 | Test ROC-AUC: 0.8702
DEBUG - 07/09/25 15:03:07 - 0:34:52 - Epoch 108
INFO - 07/09/25 15:04:53 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 15:04:53 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/sider/sider.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 27
                                     path: /home/cassie/macfrag/data/sider
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 15:04:53 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 15:04:53 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 15:04:53 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 15:04:53 - 0:00:00 - Loading data
DEBUG - 07/09/25 15:04:53 - 0:00:00 - Total size = 1427
DEBUG - 07/09/25 15:04:53 - 0:00:00 - Building model 0
DEBUG - 07/09/25 15:04:56 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=27, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:04:56 - 0:00:03 - Number of M1 parameters = 4,267,780
DEBUG - 07/09/25 15:04:56 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:04:56 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:04:56 - 0:00:03 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 15:04:56 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:04:56 - 0:00:03 - Epoch 0
INFO - 07/09/25 15:09:11 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 15:09:11 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/sider/sider.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 27
                                     path: /home/cassie/macfrag/data/sider
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 15:09:11 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 15:09:11 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 15:09:11 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 15:09:11 - 0:00:00 - Loading data
DEBUG - 07/09/25 15:09:11 - 0:00:00 - Total size = 1427
DEBUG - 07/09/25 15:09:11 - 0:00:00 - Building model 0
DEBUG - 07/09/25 15:09:14 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=27, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:09:14 - 0:00:03 - Number of M1 parameters = 4,267,780
DEBUG - 07/09/25 15:09:14 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:09:14 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:09:14 - 0:00:03 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 15:09:14 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:09:14 - 0:00:03 - Epoch 0
INFO - 07/09/25 15:10:21 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 15:10:21 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/sider/sider.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 27
                                     path: /home/cassie/macfrag/data/sider
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 15:10:21 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 15:10:21 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 15:10:21 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 15:10:21 - 0:00:00 - Loading data
DEBUG - 07/09/25 15:10:22 - 0:00:00 - Total size = 1427
DEBUG - 07/09/25 15:10:22 - 0:00:00 - Building model 0
DEBUG - 07/09/25 15:10:24 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=27, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:10:24 - 0:00:03 - Number of M1 parameters = 4,267,780
DEBUG - 07/09/25 15:10:24 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:10:24 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:10:24 - 0:00:03 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 15:10:24 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:10:24 - 0:00:03 - Epoch 0
INFO - 07/09/25 15:11:32 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 15:11:32 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/sider/sider.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 27
                                     path: /home/cassie/macfrag/data/sider
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 15:11:32 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 15:11:32 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 15:11:32 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 15:11:32 - 0:00:00 - Loading data
DEBUG - 07/09/25 15:11:32 - 0:00:00 - Total size = 1427
DEBUG - 07/09/25 15:11:32 - 0:00:00 - Building model 0
DEBUG - 07/09/25 15:11:35 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=27, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:11:35 - 0:00:03 - Number of M1 parameters = 4,267,780
DEBUG - 07/09/25 15:11:35 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:11:35 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:11:35 - 0:00:03 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 15:11:35 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:11:35 - 0:00:03 - Epoch 0
INFO - 07/09/25 15:13:31 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 15:13:31 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/sider/sider.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 27
                                     path: /home/cassie/macfrag/data/sider
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 15:13:32 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 15:13:32 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 15:13:32 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 15:13:32 - 0:00:00 - Loading data
DEBUG - 07/09/25 15:13:32 - 0:00:00 - Total size = 1427
DEBUG - 07/09/25 15:13:32 - 0:00:00 - Building model 0
DEBUG - 07/09/25 15:13:34 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=27, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:13:34 - 0:00:03 - Number of M1 parameters = 4,267,780
DEBUG - 07/09/25 15:13:34 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:13:34 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:13:34 - 0:00:03 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 15:13:34 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:13:34 - 0:00:03 - Epoch 0
INFO - 07/09/25 15:14:26 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 15:14:26 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/sider/sider.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 27
                                     path: /home/cassie/macfrag/data/sider
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 15:14:26 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 15:14:26 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 15:14:26 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 15:14:26 - 0:00:00 - Loading data
DEBUG - 07/09/25 15:14:26 - 0:00:00 - Total size = 1427
DEBUG - 07/09/25 15:14:26 - 0:00:00 - Building model 0
DEBUG - 07/09/25 15:14:29 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=27, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:14:29 - 0:00:03 - Number of M1 parameters = 4,267,780
DEBUG - 07/09/25 15:14:29 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:14:29 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:14:29 - 0:00:03 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 15:14:29 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:14:29 - 0:00:03 - Epoch 0
INFO - 07/09/25 15:15:21 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 15:15:21 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 27
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 15:15:21 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 15:15:21 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 15:15:21 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 15:15:21 - 0:00:00 - Loading data
DEBUG - 07/09/25 15:15:21 - 0:00:00 - Total size = 1513
DEBUG - 07/09/25 15:15:21 - 0:00:00 - Building model 0
DEBUG - 07/09/25 15:15:22 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=27, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:15:22 - 0:00:02 - Number of M1 parameters = 4,267,780
DEBUG - 07/09/25 15:15:22 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 15:15:22 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:15:22 - 0:00:02 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 15:15:22 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 15:15:22 - 0:00:02 - Epoch 0
INFO - 07/09/25 15:15:52 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 15:15:52 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 27
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 15:15:52 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 15:15:52 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 15:15:52 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 15:15:52 - 0:00:00 - Loading data
DEBUG - 07/09/25 15:15:53 - 0:00:00 - Total size = 1513
DEBUG - 07/09/25 15:15:53 - 0:00:00 - Building model 0
DEBUG - 07/09/25 15:15:54 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=27, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:15:54 - 0:00:02 - Number of M1 parameters = 4,267,780
DEBUG - 07/09/25 15:15:54 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 15:15:54 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:15:54 - 0:00:02 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 15:15:54 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 15:15:54 - 0:00:02 - Epoch 0
INFO - 07/09/25 15:16:31 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 15:16:31 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 15:16:31 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 15:16:31 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 15:16:31 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 15:16:31 - 0:00:00 - Loading data
DEBUG - 07/09/25 15:16:32 - 0:00:00 - Total size = 1513
DEBUG - 07/09/25 15:16:32 - 0:00:00 - Building model 0
DEBUG - 07/09/25 15:16:33 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:16:33 - 0:00:02 - Number of M1 parameters = 4,254,754
DEBUG - 07/09/25 15:16:33 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 15:16:33 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:16:33 - 0:00:02 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 15:16:33 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 15:16:33 - 0:00:02 - Epoch 0
INFO - 07/09/25 15:16:54 - 0:00:23 - Epoch 1/200 | Step 42 |  Avg Test Loss: 2.3504 | Test ROC-AUC: 0.5927
DEBUG - 07/09/25 15:16:55 - 0:00:23 - Epoch 1
INFO - 07/09/25 15:17:15 - 0:00:44 - Epoch 2/200 | Step 84 |  Avg Test Loss: 1.8079 | Test ROC-AUC: 0.6002
DEBUG - 07/09/25 15:17:16 - 0:00:44 - Epoch 2
INFO - 07/09/25 15:17:36 - 0:01:05 - Epoch 3/200 | Step 126 |  Avg Test Loss: 1.6741 | Test ROC-AUC: 0.6183
DEBUG - 07/09/25 15:17:36 - 0:01:05 - Epoch 3
INFO - 07/09/25 15:18:11 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 15:18:11 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/sider/sider.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 27
                                     path: /home/cassie/macfrag/data/sider
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 15:18:11 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 15:18:11 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 15:18:11 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 15:18:11 - 0:00:00 - Loading data
DEBUG - 07/09/25 15:18:11 - 0:00:00 - Total size = 1427
DEBUG - 07/09/25 15:18:11 - 0:00:00 - Building model 0
DEBUG - 07/09/25 15:18:14 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=27, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:18:14 - 0:00:03 - Number of M1 parameters = 4,267,780
DEBUG - 07/09/25 15:18:14 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:18:14 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:18:14 - 0:00:03 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 15:18:14 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:18:14 - 0:00:03 - Epoch 0
INFO - 07/09/25 15:18:55 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 15:18:55 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/sider/sider.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 101
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 27
                                     path: /home/cassie/macfrag/data/sider
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 15:18:55 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 15:18:55 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 15:18:55 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 15:18:55 - 0:00:00 - Loading data
DEBUG - 07/09/25 15:18:55 - 0:00:00 - Total size = 1427
DEBUG - 07/09/25 15:18:55 - 0:00:00 - Building model 0
DEBUG - 07/09/25 15:18:57 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=27, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:18:57 - 0:00:03 - Number of M1 parameters = 4,267,780
DEBUG - 07/09/25 15:18:57 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:18:57 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:18:57 - 0:00:03 - Number of M2 parameters = 9,104,251
DEBUG - 07/09/25 15:18:57 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:18:57 - 0:00:03 - Epoch 0
INFO - 07/09/25 15:20:15 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 15:20:15 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/sider/sider.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 27
                                     path: /home/cassie/macfrag/data/sider
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 15:20:15 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 15:20:15 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 15:20:15 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 15:20:15 - 0:00:00 - Loading data
DEBUG - 07/09/25 15:20:15 - 0:00:00 - Total size = 1427
DEBUG - 07/09/25 15:20:15 - 0:00:00 - Building model 0
DEBUG - 07/09/25 15:20:18 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=27, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:20:18 - 0:00:03 - Number of M1 parameters = 4,267,780
DEBUG - 07/09/25 15:20:18 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:20:18 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:20:18 - 0:00:03 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 15:20:18 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:20:18 - 0:00:03 - Epoch 0
INFO - 07/09/25 15:20:50 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 15:20:50 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/sider/sider.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 27
                                     path: /home/cassie/macfrag/data/sider
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 15:20:50 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 15:20:50 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 15:20:50 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 15:20:50 - 0:00:00 - Loading data
DEBUG - 07/09/25 15:20:51 - 0:00:00 - Total size = 1427
DEBUG - 07/09/25 15:20:51 - 0:00:00 - Building model 0
DEBUG - 07/09/25 15:20:53 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=27, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:20:53 - 0:00:03 - Number of M1 parameters = 4,267,780
DEBUG - 07/09/25 15:20:53 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:20:53 - 0:00:03 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:20:53 - 0:00:03 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 15:20:53 - 0:00:03 - Moving model to cuda
DEBUG - 07/09/25 15:20:53 - 0:00:03 - Epoch 0
INFO - 07/09/25 15:22:19 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 15:22:19 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/tox21/tox21.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 12
                                     path: /home/cassie/macfrag/data/tox21
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 15:22:19 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 15:22:19 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 15:22:19 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 15:22:19 - 0:00:00 - Loading data
DEBUG - 07/09/25 15:22:20 - 0:00:01 - Total size = 7831
DEBUG - 07/09/25 15:22:20 - 0:00:01 - Building model 0
DEBUG - 07/09/25 15:22:24 - 0:00:05 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=12, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:22:24 - 0:00:05 - Number of M1 parameters = 4,260,265
DEBUG - 07/09/25 15:22:24 - 0:00:05 - Moving model to cuda
DEBUG - 07/09/25 15:22:24 - 0:00:05 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 15:22:24 - 0:00:05 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 15:22:24 - 0:00:05 - Moving model to cuda
DEBUG - 07/09/25 15:22:24 - 0:00:05 - Epoch 0
INFO - 07/09/25 15:23:22 - 0:01:03 - Epoch 1/200 | Step 220 |  Avg Test Loss: 1.1881 | Test ROC-AUC: 0.4907
DEBUG - 07/09/25 15:23:22 - 0:01:03 - Epoch 1
INFO - 07/09/25 15:24:19 - 0:02:00 - Epoch 2/200 | Step 440 |  Avg Test Loss: 0.7282 | Test ROC-AUC: 0.5618
DEBUG - 07/09/25 15:24:19 - 0:02:00 - Epoch 2
INFO - 07/09/25 15:25:18 - 0:02:59 - Epoch 3/200 | Step 660 |  Avg Test Loss: 0.4550 | Test ROC-AUC: 0.6179
DEBUG - 07/09/25 15:25:18 - 0:02:59 - Epoch 3
INFO - 07/09/25 15:26:17 - 0:03:58 - Epoch 4/200 | Step 880 |  Avg Test Loss: 0.3734 | Test ROC-AUC: 0.6465
DEBUG - 07/09/25 15:26:17 - 0:03:58 - Epoch 4
INFO - 07/09/25 15:27:15 - 0:04:56 - Epoch 5/200 | Step 1100 |  Avg Test Loss: 0.3252 | Test ROC-AUC: 0.6613
DEBUG - 07/09/25 15:27:15 - 0:04:56 - Epoch 5
INFO - 07/09/25 15:28:14 - 0:05:55 - Epoch 6/200 | Step 1320 |  Avg Test Loss: 0.3044 | Test ROC-AUC: 0.6692
DEBUG - 07/09/25 15:28:14 - 0:05:55 - Epoch 6
INFO - 07/09/25 15:29:12 - 0:06:53 - Epoch 7/200 | Step 1540 |  Avg Test Loss: 0.2791 | Test ROC-AUC: 0.6833
DEBUG - 07/09/25 15:29:12 - 0:06:53 - Epoch 7
INFO - 07/09/25 15:30:11 - 0:07:52 - Epoch 8/200 | Step 1760 |  Avg Test Loss: 0.2633 | Test ROC-AUC: 0.6952
DEBUG - 07/09/25 15:30:11 - 0:07:52 - Epoch 8
INFO - 07/09/25 15:31:09 - 0:08:50 - Epoch 9/200 | Step 1980 |  Avg Test Loss: 0.2573 | Test ROC-AUC: 0.7158
DEBUG - 07/09/25 15:31:09 - 0:08:50 - Epoch 9
INFO - 07/09/25 15:32:08 - 0:09:49 - Epoch 10/200 | Step 2200 |  Avg Test Loss: 0.2443 | Test ROC-AUC: 0.7156
DEBUG - 07/09/25 15:32:08 - 0:09:49 - Epoch 10
INFO - 07/09/25 15:33:07 - 0:10:48 - Epoch 11/200 | Step 2420 |  Avg Test Loss: 0.2514 | Test ROC-AUC: 0.7327
DEBUG - 07/09/25 15:33:07 - 0:10:48 - Epoch 11
INFO - 07/09/25 15:34:06 - 0:11:47 - Epoch 12/200 | Step 2640 |  Avg Test Loss: 0.2424 | Test ROC-AUC: 0.7448
DEBUG - 07/09/25 15:34:06 - 0:11:47 - Epoch 12
INFO - 07/09/25 15:35:05 - 0:12:46 - Epoch 13/200 | Step 2860 |  Avg Test Loss: 0.2273 | Test ROC-AUC: 0.7448
DEBUG - 07/09/25 15:35:05 - 0:12:46 - Epoch 13
INFO - 07/09/25 15:36:03 - 0:13:44 - Epoch 14/200 | Step 3080 |  Avg Test Loss: 0.2312 | Test ROC-AUC: 0.7561
DEBUG - 07/09/25 15:36:03 - 0:13:44 - Epoch 14
INFO - 07/09/25 15:37:02 - 0:14:43 - Epoch 15/200 | Step 3300 |  Avg Test Loss: 0.2249 | Test ROC-AUC: 0.7622
DEBUG - 07/09/25 15:37:02 - 0:14:43 - Epoch 15
INFO - 07/09/25 15:38:01 - 0:15:42 - Epoch 16/200 | Step 3520 |  Avg Test Loss: 0.2118 | Test ROC-AUC: 0.7734
DEBUG - 07/09/25 15:38:01 - 0:15:42 - Epoch 16
INFO - 07/09/25 15:38:59 - 0:16:40 - Epoch 17/200 | Step 3740 |  Avg Test Loss: 0.2061 | Test ROC-AUC: 0.7737
DEBUG - 07/09/25 15:38:59 - 0:16:40 - Epoch 17
INFO - 07/09/25 15:39:58 - 0:17:39 - Epoch 18/200 | Step 3960 |  Avg Test Loss: 0.2173 | Test ROC-AUC: 0.7851
DEBUG - 07/09/25 15:39:58 - 0:17:39 - Epoch 18
INFO - 07/09/25 15:40:57 - 0:18:38 - Epoch 19/200 | Step 4180 |  Avg Test Loss: 0.2098 | Test ROC-AUC: 0.7886
DEBUG - 07/09/25 15:40:57 - 0:18:38 - Epoch 19
INFO - 07/09/25 15:41:56 - 0:19:37 - Epoch 20/200 | Step 4400 |  Avg Test Loss: 0.1897 | Test ROC-AUC: 0.7979
DEBUG - 07/09/25 15:41:56 - 0:19:37 - Epoch 20
INFO - 07/09/25 15:42:56 - 0:20:37 - Epoch 21/200 | Step 4620 |  Avg Test Loss: 0.1942 | Test ROC-AUC: 0.7999
DEBUG - 07/09/25 15:42:56 - 0:20:37 - Epoch 21
INFO - 07/09/25 15:43:56 - 0:21:37 - Epoch 22/200 | Step 4840 |  Avg Test Loss: 0.1938 | Test ROC-AUC: 0.8045
DEBUG - 07/09/25 15:43:56 - 0:21:37 - Epoch 22
INFO - 07/09/25 15:44:55 - 0:22:36 - Epoch 23/200 | Step 5060 |  Avg Test Loss: 0.1836 | Test ROC-AUC: 0.8098
DEBUG - 07/09/25 15:44:55 - 0:22:36 - Epoch 23
INFO - 07/09/25 15:45:53 - 0:23:34 - Epoch 24/200 | Step 5280 |  Avg Test Loss: 0.1927 | Test ROC-AUC: 0.8007
DEBUG - 07/09/25 15:45:53 - 0:23:34 - Epoch 24
INFO - 07/09/25 15:46:52 - 0:24:33 - Epoch 25/200 | Step 5500 |  Avg Test Loss: 0.1823 | Test ROC-AUC: 0.8151
DEBUG - 07/09/25 15:46:53 - 0:24:33 - Epoch 25
INFO - 07/09/25 15:47:51 - 0:25:32 - Epoch 26/200 | Step 5720 |  Avg Test Loss: 0.1782 | Test ROC-AUC: 0.8247
DEBUG - 07/09/25 15:47:52 - 0:25:33 - Epoch 26
INFO - 07/09/25 15:48:50 - 0:26:31 - Epoch 27/200 | Step 5940 |  Avg Test Loss: 0.1790 | Test ROC-AUC: 0.8174
DEBUG - 07/09/25 15:48:50 - 0:26:31 - Epoch 27
INFO - 07/09/25 15:49:47 - 0:27:28 - Epoch 28/200 | Step 6160 |  Avg Test Loss: 0.1760 | Test ROC-AUC: 0.8190
DEBUG - 07/09/25 15:49:48 - 0:27:29 - Epoch 28
INFO - 07/09/25 15:50:46 - 0:28:27 - Epoch 29/200 | Step 6380 |  Avg Test Loss: 0.1763 | Test ROC-AUC: 0.8243
DEBUG - 07/09/25 15:50:46 - 0:28:27 - Epoch 29
INFO - 07/09/25 15:51:45 - 0:29:26 - Epoch 30/200 | Step 6600 |  Avg Test Loss: 0.1725 | Test ROC-AUC: 0.8294
DEBUG - 07/09/25 15:51:45 - 0:29:26 - Epoch 30
INFO - 07/09/25 15:52:44 - 0:30:25 - Epoch 31/200 | Step 6820 |  Avg Test Loss: 0.1685 | Test ROC-AUC: 0.8258
DEBUG - 07/09/25 15:52:44 - 0:30:25 - Epoch 31
INFO - 07/09/25 15:53:42 - 0:31:23 - Epoch 32/200 | Step 7040 |  Avg Test Loss: 0.1708 | Test ROC-AUC: 0.8296
DEBUG - 07/09/25 15:53:43 - 0:31:23 - Epoch 32
INFO - 07/09/25 15:54:42 - 0:32:23 - Epoch 33/200 | Step 7260 |  Avg Test Loss: 0.1776 | Test ROC-AUC: 0.8284
DEBUG - 07/09/25 15:54:42 - 0:32:23 - Epoch 33
INFO - 07/09/25 15:55:40 - 0:33:21 - Epoch 34/200 | Step 7480 |  Avg Test Loss: 0.1763 | Test ROC-AUC: 0.8228
DEBUG - 07/09/25 15:55:40 - 0:33:21 - Epoch 34
INFO - 07/09/25 15:56:38 - 0:34:19 - Epoch 35/200 | Step 7700 |  Avg Test Loss: 0.1635 | Test ROC-AUC: 0.8345
DEBUG - 07/09/25 15:56:38 - 0:34:19 - Epoch 35
INFO - 07/09/25 15:57:36 - 0:35:17 - Epoch 36/200 | Step 7920 |  Avg Test Loss: 0.1651 | Test ROC-AUC: 0.8351
DEBUG - 07/09/25 15:57:36 - 0:35:17 - Epoch 36
INFO - 07/09/25 15:58:34 - 0:36:15 - Epoch 37/200 | Step 8140 |  Avg Test Loss: 0.1709 | Test ROC-AUC: 0.8335
DEBUG - 07/09/25 15:58:34 - 0:36:15 - Epoch 37
INFO - 07/09/25 15:59:33 - 0:37:14 - Epoch 38/200 | Step 8360 |  Avg Test Loss: 0.1726 | Test ROC-AUC: 0.8340
DEBUG - 07/09/25 15:59:33 - 0:37:14 - Epoch 38
INFO - 07/09/25 16:00:32 - 0:38:13 - Epoch 39/200 | Step 8580 |  Avg Test Loss: 0.1652 | Test ROC-AUC: 0.8416
DEBUG - 07/09/25 16:00:32 - 0:38:13 - Epoch 39
INFO - 07/09/25 16:01:32 - 0:39:13 - Epoch 40/200 | Step 8800 |  Avg Test Loss: 0.1677 | Test ROC-AUC: 0.8391
DEBUG - 07/09/25 16:01:32 - 0:39:13 - Epoch 40
INFO - 07/09/25 16:02:32 - 0:40:13 - Epoch 41/200 | Step 9020 |  Avg Test Loss: 0.1669 | Test ROC-AUC: 0.8363
DEBUG - 07/09/25 16:02:32 - 0:40:13 - Epoch 41
INFO - 07/09/25 16:03:32 - 0:41:13 - Epoch 42/200 | Step 9240 |  Avg Test Loss: 0.1617 | Test ROC-AUC: 0.8427
DEBUG - 07/09/25 16:03:32 - 0:41:13 - Epoch 42
INFO - 07/09/25 16:04:31 - 0:42:12 - Epoch 43/200 | Step 9460 |  Avg Test Loss: 0.1625 | Test ROC-AUC: 0.8413
DEBUG - 07/09/25 16:04:31 - 0:42:12 - Epoch 43
INFO - 07/09/25 16:05:31 - 0:43:12 - Epoch 44/200 | Step 9680 |  Avg Test Loss: 0.1707 | Test ROC-AUC: 0.8425
DEBUG - 07/09/25 16:05:31 - 0:43:12 - Epoch 44
INFO - 07/09/25 16:06:30 - 0:44:11 - Epoch 45/200 | Step 9900 |  Avg Test Loss: 0.1561 | Test ROC-AUC: 0.8465
DEBUG - 07/09/25 16:06:31 - 0:44:12 - Epoch 45
INFO - 07/09/25 16:07:30 - 0:45:11 - Epoch 46/200 | Step 10120 |  Avg Test Loss: 0.1697 | Test ROC-AUC: 0.8441
DEBUG - 07/09/25 16:07:30 - 0:45:11 - Epoch 46
INFO - 07/09/25 16:08:30 - 0:46:11 - Epoch 47/200 | Step 10340 |  Avg Test Loss: 0.1539 | Test ROC-AUC: 0.8464
DEBUG - 07/09/25 16:08:30 - 0:46:11 - Epoch 47
INFO - 07/09/25 16:09:30 - 0:47:11 - Epoch 48/200 | Step 10560 |  Avg Test Loss: 0.1615 | Test ROC-AUC: 0.8413
DEBUG - 07/09/25 16:09:30 - 0:47:11 - Epoch 48
INFO - 07/09/25 16:10:30 - 0:48:11 - Epoch 49/200 | Step 10780 |  Avg Test Loss: 0.1574 | Test ROC-AUC: 0.8452
DEBUG - 07/09/25 16:10:30 - 0:48:11 - Epoch 49
INFO - 07/09/25 16:11:30 - 0:49:11 - Epoch 50/200 | Step 11000 |  Avg Test Loss: 0.1614 | Test ROC-AUC: 0.8468
DEBUG - 07/09/25 16:11:30 - 0:49:11 - Epoch 50
INFO - 07/09/25 16:12:30 - 0:50:11 - Epoch 51/200 | Step 11220 |  Avg Test Loss: 0.1559 | Test ROC-AUC: 0.8478
DEBUG - 07/09/25 16:12:30 - 0:50:11 - Epoch 51
INFO - 07/09/25 16:15:14 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 16:15:14 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/tox21/tox21.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 12
                                     path: /home/cassie/macfrag/data/tox21
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 16:15:14 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 16:15:14 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 16:15:14 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 16:15:14 - 0:00:00 - Loading data
DEBUG - 07/09/25 16:15:15 - 0:00:01 - Total size = 7831
DEBUG - 07/09/25 16:15:15 - 0:00:01 - Building model 0
DEBUG - 07/09/25 16:15:19 - 0:00:05 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=12, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 16:15:19 - 0:00:05 - Number of M1 parameters = 4,260,265
DEBUG - 07/09/25 16:15:19 - 0:00:05 - Moving model to cuda
DEBUG - 07/09/25 16:15:19 - 0:00:05 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 16:15:19 - 0:00:05 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 16:15:19 - 0:00:05 - Moving model to cuda
DEBUG - 07/09/25 16:15:19 - 0:00:05 - Epoch 0
INFO - 07/09/25 16:16:16 - 0:01:02 - Epoch 1/200 | Step 220 |  Avg Test Loss: 1.6825 | Test ROC-AUC: 0.5309
DEBUG - 07/09/25 16:16:16 - 0:01:02 - Epoch 1
INFO - 07/09/25 16:17:10 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 16:17:10 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 16:17:10 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 16:17:10 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 16:17:10 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 16:17:10 - 0:00:00 - Loading data
DEBUG - 07/09/25 16:17:10 - 0:00:00 - Total size = 1513
DEBUG - 07/09/25 16:17:10 - 0:00:00 - Building model 0
DEBUG - 07/09/25 16:17:11 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 16:17:11 - 0:00:02 - Number of M1 parameters = 4,254,754
DEBUG - 07/09/25 16:17:11 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 16:17:11 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 16:17:11 - 0:00:02 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 16:17:11 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 16:17:11 - 0:00:02 - Epoch 0
INFO - 07/09/25 16:17:32 - 0:00:22 - Epoch 1/200 | Step 42 |  Avg Test Loss: 3.7661 | Test ROC-AUC: 0.5096
DEBUG - 07/09/25 16:17:32 - 0:00:22 - Epoch 1
INFO - 07/09/25 16:17:51 - 0:00:41 - Epoch 2/200 | Step 84 |  Avg Test Loss: 2.8582 | Test ROC-AUC: 0.6322
DEBUG - 07/09/25 16:17:51 - 0:00:42 - Epoch 2
INFO - 07/09/25 16:18:11 - 0:01:01 - Epoch 3/200 | Step 126 |  Avg Test Loss: 2.2211 | Test ROC-AUC: 0.6589
DEBUG - 07/09/25 16:18:11 - 0:01:01 - Epoch 3
INFO - 07/09/25 16:18:30 - 0:01:21 - Epoch 4/200 | Step 168 |  Avg Test Loss: 1.8897 | Test ROC-AUC: 0.6991
DEBUG - 07/09/25 16:18:30 - 0:01:21 - Epoch 4
INFO - 07/09/25 16:18:50 - 0:01:40 - Epoch 5/200 | Step 210 |  Avg Test Loss: 1.7400 | Test ROC-AUC: 0.7341
DEBUG - 07/09/25 16:18:50 - 0:01:40 - Epoch 5
INFO - 07/09/25 16:19:09 - 0:02:00 - Epoch 6/200 | Step 252 |  Avg Test Loss: 1.6842 | Test ROC-AUC: 0.7404
DEBUG - 07/09/25 16:19:09 - 0:02:00 - Epoch 6
INFO - 07/09/25 16:19:29 - 0:02:20 - Epoch 7/200 | Step 294 |  Avg Test Loss: 1.6419 | Test ROC-AUC: 0.7426
DEBUG - 07/09/25 16:19:29 - 0:02:20 - Epoch 7
INFO - 07/09/25 16:19:49 - 0:02:39 - Epoch 8/200 | Step 336 |  Avg Test Loss: 1.7660 | Test ROC-AUC: 0.6835
DEBUG - 07/09/25 16:19:49 - 0:02:39 - Epoch 8
INFO - 07/09/25 16:20:09 - 0:02:59 - Epoch 9/200 | Step 378 |  Avg Test Loss: 1.6175 | Test ROC-AUC: 0.7465
DEBUG - 07/09/25 16:20:09 - 0:02:59 - Epoch 9
INFO - 07/09/25 16:20:28 - 0:03:19 - Epoch 10/200 | Step 420 |  Avg Test Loss: 1.6194 | Test ROC-AUC: 0.7629
DEBUG - 07/09/25 16:20:28 - 0:03:19 - Epoch 10
INFO - 07/09/25 16:20:48 - 0:03:38 - Epoch 11/200 | Step 462 |  Avg Test Loss: 1.5919 | Test ROC-AUC: 0.7565
DEBUG - 07/09/25 16:20:48 - 0:03:38 - Epoch 11
INFO - 07/09/25 16:21:09 - 0:03:59 - Epoch 12/200 | Step 504 |  Avg Test Loss: 1.5965 | Test ROC-AUC: 0.7834
DEBUG - 07/09/25 16:21:09 - 0:03:59 - Epoch 12
INFO - 07/09/25 16:21:30 - 0:04:20 - Epoch 13/200 | Step 546 |  Avg Test Loss: 1.5930 | Test ROC-AUC: 0.7705
DEBUG - 07/09/25 16:21:30 - 0:04:20 - Epoch 13
INFO - 07/09/25 16:21:51 - 0:04:41 - Epoch 14/200 | Step 588 |  Avg Test Loss: 1.5771 | Test ROC-AUC: 0.7717
DEBUG - 07/09/25 16:21:51 - 0:04:41 - Epoch 14
INFO - 07/09/25 16:22:12 - 0:05:02 - Epoch 15/200 | Step 630 |  Avg Test Loss: 1.5736 | Test ROC-AUC: 0.7873
DEBUG - 07/09/25 16:22:12 - 0:05:02 - Epoch 15
INFO - 07/09/25 16:22:32 - 0:05:23 - Epoch 16/200 | Step 672 |  Avg Test Loss: 1.5715 | Test ROC-AUC: 0.7861
DEBUG - 07/09/25 16:22:32 - 0:05:23 - Epoch 16
INFO - 07/09/25 16:22:53 - 0:05:44 - Epoch 17/200 | Step 714 |  Avg Test Loss: 1.5783 | Test ROC-AUC: 0.7853
DEBUG - 07/09/25 16:22:53 - 0:05:44 - Epoch 17
INFO - 07/09/25 16:23:15 - 0:06:05 - Epoch 18/200 | Step 756 |  Avg Test Loss: 1.6199 | Test ROC-AUC: 0.7949
DEBUG - 07/09/25 16:23:15 - 0:06:05 - Epoch 18
INFO - 07/09/25 16:23:35 - 0:06:26 - Epoch 19/200 | Step 798 |  Avg Test Loss: 1.5453 | Test ROC-AUC: 0.7968
DEBUG - 07/09/25 16:23:35 - 0:06:26 - Epoch 19
INFO - 07/09/25 16:23:56 - 0:06:47 - Epoch 20/200 | Step 840 |  Avg Test Loss: 1.5992 | Test ROC-AUC: 0.7961
DEBUG - 07/09/25 16:23:56 - 0:06:47 - Epoch 20
INFO - 07/09/25 16:24:17 - 0:07:07 - Epoch 21/200 | Step 882 |  Avg Test Loss: 1.5435 | Test ROC-AUC: 0.7958
DEBUG - 07/09/25 16:24:17 - 0:07:07 - Epoch 21
INFO - 07/09/25 16:24:38 - 0:07:28 - Epoch 22/200 | Step 924 |  Avg Test Loss: 1.5441 | Test ROC-AUC: 0.7919
DEBUG - 07/09/25 16:24:38 - 0:07:28 - Epoch 22
INFO - 07/09/25 16:24:58 - 0:07:49 - Epoch 23/200 | Step 966 |  Avg Test Loss: 1.5415 | Test ROC-AUC: 0.8020
DEBUG - 07/09/25 16:24:58 - 0:07:49 - Epoch 23
INFO - 07/09/25 16:25:19 - 0:08:09 - Epoch 24/200 | Step 1008 |  Avg Test Loss: 1.5454 | Test ROC-AUC: 0.8154
DEBUG - 07/09/25 16:25:19 - 0:08:10 - Epoch 24
INFO - 07/09/25 16:25:40 - 0:08:31 - Epoch 25/200 | Step 1050 |  Avg Test Loss: 1.5291 | Test ROC-AUC: 0.7922
DEBUG - 07/09/25 16:25:40 - 0:08:31 - Epoch 25
INFO - 07/09/25 16:26:01 - 0:08:51 - Epoch 26/200 | Step 1092 |  Avg Test Loss: 1.5143 | Test ROC-AUC: 0.8154
DEBUG - 07/09/25 16:26:01 - 0:08:51 - Epoch 26
INFO - 07/09/25 16:26:21 - 0:09:11 - Epoch 27/200 | Step 1134 |  Avg Test Loss: 1.5434 | Test ROC-AUC: 0.8129
DEBUG - 07/09/25 16:26:21 - 0:09:12 - Epoch 27
INFO - 07/09/25 16:26:42 - 0:09:32 - Epoch 28/200 | Step 1176 |  Avg Test Loss: 1.5669 | Test ROC-AUC: 0.8066
DEBUG - 07/09/25 16:26:42 - 0:09:32 - Epoch 28
INFO - 07/09/25 16:27:02 - 0:09:53 - Epoch 29/200 | Step 1218 |  Avg Test Loss: 1.5061 | Test ROC-AUC: 0.8117
DEBUG - 07/09/25 16:27:03 - 0:09:53 - Epoch 29
INFO - 07/09/25 16:27:24 - 0:10:14 - Epoch 30/200 | Step 1260 |  Avg Test Loss: 1.5105 | Test ROC-AUC: 0.8115
DEBUG - 07/09/25 16:27:24 - 0:10:14 - Epoch 30
INFO - 07/09/25 16:27:45 - 0:10:35 - Epoch 31/200 | Step 1302 |  Avg Test Loss: 1.5238 | Test ROC-AUC: 0.8110
DEBUG - 07/09/25 16:27:45 - 0:10:35 - Epoch 31
INFO - 07/09/25 16:28:06 - 0:10:56 - Epoch 32/200 | Step 1344 |  Avg Test Loss: 1.5358 | Test ROC-AUC: 0.8020
DEBUG - 07/09/25 16:28:06 - 0:10:56 - Epoch 32
INFO - 07/09/25 16:28:26 - 0:11:16 - Epoch 33/200 | Step 1386 |  Avg Test Loss: 1.4947 | Test ROC-AUC: 0.8139
DEBUG - 07/09/25 16:28:26 - 0:11:17 - Epoch 33
INFO - 07/09/25 16:28:46 - 0:11:36 - Epoch 34/200 | Step 1428 |  Avg Test Loss: 1.4934 | Test ROC-AUC: 0.8127
DEBUG - 07/09/25 16:28:46 - 0:11:36 - Epoch 34
INFO - 07/09/25 16:29:07 - 0:11:57 - Epoch 35/200 | Step 1470 |  Avg Test Loss: 1.5106 | Test ROC-AUC: 0.8200
DEBUG - 07/09/25 16:29:07 - 0:11:57 - Epoch 35
INFO - 07/09/25 16:29:28 - 0:12:18 - Epoch 36/200 | Step 1512 |  Avg Test Loss: 1.5430 | Test ROC-AUC: 0.8107
DEBUG - 07/09/25 16:29:28 - 0:12:18 - Epoch 36
INFO - 07/09/25 16:29:48 - 0:12:39 - Epoch 37/200 | Step 1554 |  Avg Test Loss: 1.4864 | Test ROC-AUC: 0.8278
DEBUG - 07/09/25 16:29:49 - 0:12:39 - Epoch 37
INFO - 07/09/25 16:30:09 - 0:13:00 - Epoch 38/200 | Step 1596 |  Avg Test Loss: 1.4903 | Test ROC-AUC: 0.8276
DEBUG - 07/09/25 16:30:09 - 0:13:00 - Epoch 38
INFO - 07/09/25 16:30:30 - 0:13:20 - Epoch 39/200 | Step 1638 |  Avg Test Loss: 1.4922 | Test ROC-AUC: 0.8208
DEBUG - 07/09/25 16:30:30 - 0:13:21 - Epoch 39
INFO - 07/09/25 16:30:51 - 0:13:41 - Epoch 40/200 | Step 1680 |  Avg Test Loss: 1.4964 | Test ROC-AUC: 0.8278
DEBUG - 07/09/25 16:30:51 - 0:13:41 - Epoch 40
INFO - 07/09/25 16:31:11 - 0:14:02 - Epoch 41/200 | Step 1722 |  Avg Test Loss: 1.4935 | Test ROC-AUC: 0.8288
DEBUG - 07/09/25 16:31:11 - 0:14:02 - Epoch 41
INFO - 07/09/25 16:31:32 - 0:14:22 - Epoch 42/200 | Step 1764 |  Avg Test Loss: 1.4749 | Test ROC-AUC: 0.8352
DEBUG - 07/09/25 16:31:32 - 0:14:22 - Epoch 42
INFO - 07/09/25 16:31:52 - 0:14:43 - Epoch 43/200 | Step 1806 |  Avg Test Loss: 1.5153 | Test ROC-AUC: 0.8149
DEBUG - 07/09/25 16:31:52 - 0:14:43 - Epoch 43
INFO - 07/09/25 16:32:13 - 0:15:04 - Epoch 44/200 | Step 1848 |  Avg Test Loss: 1.4783 | Test ROC-AUC: 0.8357
DEBUG - 07/09/25 16:32:13 - 0:15:04 - Epoch 44
INFO - 07/09/25 16:32:34 - 0:15:24 - Epoch 45/200 | Step 1890 |  Avg Test Loss: 1.4813 | Test ROC-AUC: 0.8225
DEBUG - 07/09/25 16:32:34 - 0:15:24 - Epoch 45
INFO - 07/09/25 16:32:55 - 0:15:45 - Epoch 46/200 | Step 1932 |  Avg Test Loss: 1.4974 | Test ROC-AUC: 0.8308
DEBUG - 07/09/25 16:32:55 - 0:15:45 - Epoch 46
INFO - 07/09/25 16:33:15 - 0:16:05 - Epoch 47/200 | Step 1974 |  Avg Test Loss: 1.4847 | Test ROC-AUC: 0.8498
DEBUG - 07/09/25 16:33:15 - 0:16:06 - Epoch 47
INFO - 07/09/25 16:33:36 - 0:16:26 - Epoch 48/200 | Step 2016 |  Avg Test Loss: 1.5106 | Test ROC-AUC: 0.8379
DEBUG - 07/09/25 16:33:36 - 0:16:27 - Epoch 48
INFO - 07/09/25 16:33:58 - 0:16:48 - Epoch 49/200 | Step 2058 |  Avg Test Loss: 1.4837 | Test ROC-AUC: 0.8300
DEBUG - 07/09/25 16:33:58 - 0:16:48 - Epoch 49
INFO - 07/09/25 16:34:19 - 0:17:09 - Epoch 50/200 | Step 2100 |  Avg Test Loss: 1.5019 | Test ROC-AUC: 0.8281
DEBUG - 07/09/25 16:34:19 - 0:17:09 - Epoch 50
INFO - 07/09/25 16:34:39 - 0:17:29 - Epoch 51/200 | Step 2142 |  Avg Test Loss: 1.4795 | Test ROC-AUC: 0.8295
DEBUG - 07/09/25 16:34:39 - 0:17:29 - Epoch 51
INFO - 07/09/25 16:34:59 - 0:17:49 - Epoch 52/200 | Step 2184 |  Avg Test Loss: 1.4856 | Test ROC-AUC: 0.8398
DEBUG - 07/09/25 16:34:59 - 0:17:49 - Epoch 52
INFO - 07/09/25 16:35:19 - 0:18:10 - Epoch 53/200 | Step 2226 |  Avg Test Loss: 1.4866 | Test ROC-AUC: 0.8400
DEBUG - 07/09/25 16:35:20 - 0:18:10 - Epoch 53
INFO - 07/09/25 16:35:40 - 0:18:31 - Epoch 54/200 | Step 2268 |  Avg Test Loss: 1.4913 | Test ROC-AUC: 0.8291
DEBUG - 07/09/25 16:35:41 - 0:18:31 - Epoch 54
INFO - 07/09/25 16:36:01 - 0:18:51 - Epoch 55/200 | Step 2310 |  Avg Test Loss: 1.5276 | Test ROC-AUC: 0.8220
DEBUG - 07/09/25 16:36:01 - 0:18:51 - Epoch 55
INFO - 07/09/25 16:36:21 - 0:19:11 - Epoch 56/200 | Step 2352 |  Avg Test Loss: 1.4619 | Test ROC-AUC: 0.8393
DEBUG - 07/09/25 16:36:21 - 0:19:11 - Epoch 56
INFO - 07/09/25 16:36:42 - 0:19:32 - Epoch 57/200 | Step 2394 |  Avg Test Loss: 1.4777 | Test ROC-AUC: 0.8337
DEBUG - 07/09/25 16:36:42 - 0:19:33 - Epoch 57
INFO - 07/09/25 16:37:02 - 0:19:53 - Epoch 58/200 | Step 2436 |  Avg Test Loss: 1.4907 | Test ROC-AUC: 0.8264
DEBUG - 07/09/25 16:37:03 - 0:19:53 - Epoch 58
INFO - 07/09/25 16:37:23 - 0:20:13 - Epoch 59/200 | Step 2478 |  Avg Test Loss: 1.4840 | Test ROC-AUC: 0.8418
DEBUG - 07/09/25 16:37:23 - 0:20:14 - Epoch 59
INFO - 07/09/25 16:37:43 - 0:20:34 - Epoch 60/200 | Step 2520 |  Avg Test Loss: 1.4760 | Test ROC-AUC: 0.8388
DEBUG - 07/09/25 16:37:43 - 0:20:34 - Epoch 60
INFO - 07/09/25 16:38:04 - 0:20:55 - Epoch 61/200 | Step 2562 |  Avg Test Loss: 1.4975 | Test ROC-AUC: 0.8300
DEBUG - 07/09/25 16:38:04 - 0:20:55 - Epoch 61
INFO - 07/09/25 16:38:25 - 0:21:15 - Epoch 62/200 | Step 2604 |  Avg Test Loss: 1.4828 | Test ROC-AUC: 0.8422
DEBUG - 07/09/25 16:38:25 - 0:21:15 - Epoch 62
INFO - 07/09/25 16:38:46 - 0:21:36 - Epoch 63/200 | Step 2646 |  Avg Test Loss: 1.4860 | Test ROC-AUC: 0.8295
DEBUG - 07/09/25 16:38:46 - 0:21:36 - Epoch 63
INFO - 07/09/25 16:39:07 - 0:21:58 - Epoch 64/200 | Step 2688 |  Avg Test Loss: 1.4533 | Test ROC-AUC: 0.8354
DEBUG - 07/09/25 16:39:07 - 0:21:58 - Epoch 64
INFO - 07/09/25 16:39:28 - 0:22:19 - Epoch 65/200 | Step 2730 |  Avg Test Loss: 1.4827 | Test ROC-AUC: 0.8357
DEBUG - 07/09/25 16:39:29 - 0:22:19 - Epoch 65
INFO - 07/09/25 16:39:49 - 0:22:39 - Epoch 66/200 | Step 2772 |  Avg Test Loss: 1.5055 | Test ROC-AUC: 0.8364
DEBUG - 07/09/25 16:39:49 - 0:22:39 - Epoch 66
INFO - 07/09/25 16:40:10 - 0:23:00 - Epoch 67/200 | Step 2814 |  Avg Test Loss: 1.4545 | Test ROC-AUC: 0.8459
DEBUG - 07/09/25 16:40:10 - 0:23:00 - Epoch 67
INFO - 07/09/25 16:40:31 - 0:23:21 - Epoch 68/200 | Step 2856 |  Avg Test Loss: 1.4832 | Test ROC-AUC: 0.8403
DEBUG - 07/09/25 16:40:31 - 0:23:21 - Epoch 68
INFO - 07/09/25 16:40:52 - 0:23:42 - Epoch 69/200 | Step 2898 |  Avg Test Loss: 1.4831 | Test ROC-AUC: 0.8359
DEBUG - 07/09/25 16:40:52 - 0:23:42 - Epoch 69
INFO - 07/09/25 16:41:12 - 0:24:03 - Epoch 70/200 | Step 2940 |  Avg Test Loss: 1.4853 | Test ROC-AUC: 0.8459
DEBUG - 07/09/25 16:41:12 - 0:24:03 - Epoch 70
INFO - 07/09/25 16:41:33 - 0:24:23 - Epoch 71/200 | Step 2982 |  Avg Test Loss: 1.4473 | Test ROC-AUC: 0.8537
DEBUG - 07/09/25 16:41:33 - 0:24:23 - Epoch 71
INFO - 07/09/25 16:41:53 - 0:24:44 - Epoch 72/200 | Step 3024 |  Avg Test Loss: 1.4700 | Test ROC-AUC: 0.8398
DEBUG - 07/09/25 16:41:53 - 0:24:44 - Epoch 72
INFO - 07/09/25 16:42:15 - 0:25:05 - Epoch 73/200 | Step 3066 |  Avg Test Loss: 1.4695 | Test ROC-AUC: 0.8479
DEBUG - 07/09/25 16:42:15 - 0:25:05 - Epoch 73
INFO - 07/09/25 16:42:35 - 0:25:26 - Epoch 74/200 | Step 3108 |  Avg Test Loss: 1.4876 | Test ROC-AUC: 0.8549
DEBUG - 07/09/25 16:42:35 - 0:25:26 - Epoch 74
INFO - 07/09/25 16:42:56 - 0:25:47 - Epoch 75/200 | Step 3150 |  Avg Test Loss: 1.4672 | Test ROC-AUC: 0.8444
DEBUG - 07/09/25 16:42:56 - 0:25:47 - Epoch 75
INFO - 07/09/25 16:43:17 - 0:26:07 - Epoch 76/200 | Step 3192 |  Avg Test Loss: 1.5602 | Test ROC-AUC: 0.8437
DEBUG - 07/09/25 16:43:17 - 0:26:07 - Epoch 76
INFO - 07/09/25 16:43:38 - 0:26:28 - Epoch 77/200 | Step 3234 |  Avg Test Loss: 1.4673 | Test ROC-AUC: 0.8527
DEBUG - 07/09/25 16:43:38 - 0:26:28 - Epoch 77
INFO - 07/09/25 16:43:58 - 0:26:49 - Epoch 78/200 | Step 3276 |  Avg Test Loss: 1.4889 | Test ROC-AUC: 0.8466
DEBUG - 07/09/25 16:43:58 - 0:26:49 - Epoch 78
INFO - 07/09/25 16:44:19 - 0:27:09 - Epoch 79/200 | Step 3318 |  Avg Test Loss: 1.4782 | Test ROC-AUC: 0.8427
DEBUG - 07/09/25 16:44:19 - 0:27:09 - Epoch 79
INFO - 07/09/25 16:44:39 - 0:27:30 - Epoch 80/200 | Step 3360 |  Avg Test Loss: 1.4514 | Test ROC-AUC: 0.8315
DEBUG - 07/09/25 16:44:39 - 0:27:30 - Epoch 80
INFO - 07/09/25 16:45:00 - 0:27:50 - Epoch 81/200 | Step 3402 |  Avg Test Loss: 1.5072 | Test ROC-AUC: 0.8327
DEBUG - 07/09/25 16:45:00 - 0:27:51 - Epoch 81
INFO - 07/09/25 16:45:21 - 0:28:11 - Epoch 82/200 | Step 3444 |  Avg Test Loss: 1.4751 | Test ROC-AUC: 0.8374
DEBUG - 07/09/25 16:45:21 - 0:28:11 - Epoch 82
INFO - 07/09/25 16:45:41 - 0:28:31 - Epoch 83/200 | Step 3486 |  Avg Test Loss: 1.4708 | Test ROC-AUC: 0.8410
DEBUG - 07/09/25 16:45:41 - 0:28:32 - Epoch 83
INFO - 07/09/25 16:46:02 - 0:28:52 - Epoch 84/200 | Step 3528 |  Avg Test Loss: 1.4819 | Test ROC-AUC: 0.8449
DEBUG - 07/09/25 16:46:02 - 0:28:52 - Epoch 84
INFO - 07/09/25 16:46:23 - 0:29:13 - Epoch 85/200 | Step 3570 |  Avg Test Loss: 1.4975 | Test ROC-AUC: 0.8317
DEBUG - 07/09/25 16:46:23 - 0:29:13 - Epoch 85
INFO - 07/09/25 16:46:42 - 0:29:33 - Epoch 86/200 | Step 3612 |  Avg Test Loss: 1.4712 | Test ROC-AUC: 0.8545
DEBUG - 07/09/25 16:46:42 - 0:29:33 - Epoch 86
INFO - 07/09/25 16:47:02 - 0:29:52 - Epoch 87/200 | Step 3654 |  Avg Test Loss: 1.4858 | Test ROC-AUC: 0.8527
DEBUG - 07/09/25 16:47:02 - 0:29:52 - Epoch 87
INFO - 07/09/25 16:47:21 - 0:30:12 - Epoch 88/200 | Step 3696 |  Avg Test Loss: 1.4907 | Test ROC-AUC: 0.8457
DEBUG - 07/09/25 16:47:21 - 0:30:12 - Epoch 88
INFO - 07/09/25 16:47:41 - 0:30:31 - Epoch 89/200 | Step 3738 |  Avg Test Loss: 1.4952 | Test ROC-AUC: 0.8403
DEBUG - 07/09/25 16:47:41 - 0:30:31 - Epoch 89
INFO - 07/09/25 16:48:00 - 0:30:51 - Epoch 90/200 | Step 3780 |  Avg Test Loss: 1.4955 | Test ROC-AUC: 0.8371
DEBUG - 07/09/25 16:48:00 - 0:30:51 - Epoch 90
INFO - 07/09/25 16:48:20 - 0:31:10 - Epoch 91/200 | Step 3822 |  Avg Test Loss: 1.4615 | Test ROC-AUC: 0.8535
DEBUG - 07/09/25 16:48:20 - 0:31:10 - Epoch 91
INFO - 07/09/25 16:48:39 - 0:31:30 - Epoch 92/200 | Step 3864 |  Avg Test Loss: 1.4803 | Test ROC-AUC: 0.8449
DEBUG - 07/09/25 16:48:39 - 0:31:30 - Epoch 92
INFO - 07/09/25 16:48:58 - 0:31:49 - Epoch 93/200 | Step 3906 |  Avg Test Loss: 1.4838 | Test ROC-AUC: 0.8432
DEBUG - 07/09/25 16:48:58 - 0:31:49 - Epoch 93
INFO - 07/09/25 16:49:18 - 0:32:08 - Epoch 94/200 | Step 3948 |  Avg Test Loss: 1.4793 | Test ROC-AUC: 0.8496
DEBUG - 07/09/25 16:49:18 - 0:32:08 - Epoch 94
INFO - 07/09/25 16:49:37 - 0:32:27 - Epoch 95/200 | Step 3990 |  Avg Test Loss: 1.5405 | Test ROC-AUC: 0.8391
DEBUG - 07/09/25 16:49:37 - 0:32:27 - Epoch 95
INFO - 07/09/25 16:49:56 - 0:32:46 - Epoch 96/200 | Step 4032 |  Avg Test Loss: 1.4610 | Test ROC-AUC: 0.8547
DEBUG - 07/09/25 16:49:56 - 0:32:46 - Epoch 96
INFO - 07/09/25 16:50:15 - 0:33:05 - Epoch 97/200 | Step 4074 |  Avg Test Loss: 1.4774 | Test ROC-AUC: 0.8462
DEBUG - 07/09/25 16:50:15 - 0:33:06 - Epoch 97
INFO - 07/09/25 16:50:34 - 0:33:25 - Epoch 98/200 | Step 4116 |  Avg Test Loss: 1.4960 | Test ROC-AUC: 0.8420
DEBUG - 07/09/25 16:50:34 - 0:33:25 - Epoch 98
INFO - 07/09/25 16:50:54 - 0:33:44 - Epoch 99/200 | Step 4158 |  Avg Test Loss: 1.4923 | Test ROC-AUC: 0.8442
DEBUG - 07/09/25 16:50:54 - 0:33:44 - Epoch 99
INFO - 07/09/25 16:51:13 - 0:34:03 - Epoch 100/200 | Step 4200 |  Avg Test Loss: 1.4749 | Test ROC-AUC: 0.8496
DEBUG - 07/09/25 16:51:13 - 0:34:03 - Epoch 100
INFO - 07/09/25 16:51:32 - 0:34:23 - Epoch 101/200 | Step 4242 |  Avg Test Loss: 1.5565 | Test ROC-AUC: 0.8335
DEBUG - 07/09/25 16:51:32 - 0:34:23 - Epoch 101
INFO - 07/09/25 16:51:51 - 0:34:42 - Epoch 102/200 | Step 4284 |  Avg Test Loss: 1.5023 | Test ROC-AUC: 0.8452
DEBUG - 07/09/25 16:51:51 - 0:34:42 - Epoch 102
INFO - 07/09/25 16:52:11 - 0:35:01 - Epoch 103/200 | Step 4326 |  Avg Test Loss: 1.4702 | Test ROC-AUC: 0.8557
DEBUG - 07/09/25 16:52:11 - 0:35:01 - Epoch 103
INFO - 07/09/25 16:52:30 - 0:35:20 - Epoch 104/200 | Step 4368 |  Avg Test Loss: 1.4717 | Test ROC-AUC: 0.8542
DEBUG - 07/09/25 16:52:30 - 0:35:20 - Epoch 104
INFO - 07/09/25 16:52:49 - 0:35:40 - Epoch 105/200 | Step 4410 |  Avg Test Loss: 1.5101 | Test ROC-AUC: 0.8374
DEBUG - 07/09/25 16:52:49 - 0:35:40 - Epoch 105
INFO - 07/09/25 16:53:09 - 0:35:59 - Epoch 106/200 | Step 4452 |  Avg Test Loss: 1.4849 | Test ROC-AUC: 0.8471
DEBUG - 07/09/25 16:53:09 - 0:35:59 - Epoch 106
INFO - 07/09/25 16:53:28 - 0:36:18 - Epoch 107/200 | Step 4494 |  Avg Test Loss: 1.4824 | Test ROC-AUC: 0.8422
DEBUG - 07/09/25 16:53:28 - 0:36:18 - Epoch 107
INFO - 07/09/25 16:53:47 - 0:36:38 - Epoch 108/200 | Step 4536 |  Avg Test Loss: 1.4669 | Test ROC-AUC: 0.8515
DEBUG - 07/09/25 16:53:48 - 0:36:38 - Epoch 108
INFO - 07/09/25 16:54:07 - 0:36:57 - Epoch 109/200 | Step 4578 |  Avg Test Loss: 1.4699 | Test ROC-AUC: 0.8593
DEBUG - 07/09/25 16:54:07 - 0:36:57 - Epoch 109
INFO - 07/09/25 16:54:26 - 0:37:16 - Epoch 110/200 | Step 4620 |  Avg Test Loss: 1.5031 | Test ROC-AUC: 0.8459
DEBUG - 07/09/25 16:54:26 - 0:37:16 - Epoch 110
INFO - 07/09/25 16:54:45 - 0:37:36 - Epoch 111/200 | Step 4662 |  Avg Test Loss: 1.5077 | Test ROC-AUC: 0.8549
DEBUG - 07/09/25 16:54:46 - 0:37:36 - Epoch 111
INFO - 07/09/25 16:55:05 - 0:37:55 - Epoch 112/200 | Step 4704 |  Avg Test Loss: 1.4770 | Test ROC-AUC: 0.8493
DEBUG - 07/09/25 16:55:05 - 0:37:55 - Epoch 112
INFO - 07/09/25 16:55:24 - 0:38:15 - Epoch 113/200 | Step 4746 |  Avg Test Loss: 1.4769 | Test ROC-AUC: 0.8518
DEBUG - 07/09/25 16:55:24 - 0:38:15 - Epoch 113
INFO - 07/09/25 16:55:44 - 0:38:34 - Epoch 114/200 | Step 4788 |  Avg Test Loss: 1.5062 | Test ROC-AUC: 0.8466
DEBUG - 07/09/25 16:55:44 - 0:38:34 - Epoch 114
INFO - 07/09/25 16:56:03 - 0:38:53 - Epoch 115/200 | Step 4830 |  Avg Test Loss: 1.4734 | Test ROC-AUC: 0.8564
DEBUG - 07/09/25 16:56:03 - 0:38:53 - Epoch 115
INFO - 07/09/25 16:56:22 - 0:39:13 - Epoch 116/200 | Step 4872 |  Avg Test Loss: 1.5254 | Test ROC-AUC: 0.8386
DEBUG - 07/09/25 16:56:23 - 0:39:13 - Epoch 116
INFO - 07/09/25 16:56:42 - 0:39:32 - Epoch 117/200 | Step 4914 |  Avg Test Loss: 1.4752 | Test ROC-AUC: 0.8562
DEBUG - 07/09/25 16:56:42 - 0:39:32 - Epoch 117
INFO - 07/09/25 16:57:01 - 0:39:52 - Epoch 118/200 | Step 4956 |  Avg Test Loss: 1.5302 | Test ROC-AUC: 0.8357
DEBUG - 07/09/25 16:57:01 - 0:39:52 - Epoch 118
INFO - 07/09/25 16:57:21 - 0:40:11 - Epoch 119/200 | Step 4998 |  Avg Test Loss: 1.4790 | Test ROC-AUC: 0.8530
DEBUG - 07/09/25 16:57:21 - 0:40:11 - Epoch 119
INFO - 07/09/25 16:57:40 - 0:40:31 - Epoch 120/200 | Step 5040 |  Avg Test Loss: 1.4890 | Test ROC-AUC: 0.8545
DEBUG - 07/09/25 16:57:40 - 0:40:31 - Epoch 120
INFO - 07/09/25 16:58:00 - 0:40:50 - Epoch 121/200 | Step 5082 |  Avg Test Loss: 1.4858 | Test ROC-AUC: 0.8466
DEBUG - 07/09/25 16:58:00 - 0:40:50 - Epoch 121
INFO - 07/09/25 16:58:19 - 0:41:10 - Epoch 122/200 | Step 5124 |  Avg Test Loss: 1.4964 | Test ROC-AUC: 0.8510
DEBUG - 07/09/25 16:58:19 - 0:41:10 - Epoch 122
INFO - 07/09/25 16:58:39 - 0:41:29 - Epoch 123/200 | Step 5166 |  Avg Test Loss: 1.4766 | Test ROC-AUC: 0.8540
DEBUG - 07/09/25 16:58:39 - 0:41:29 - Epoch 123
INFO - 07/09/25 16:58:58 - 0:41:48 - Epoch 124/200 | Step 5208 |  Avg Test Loss: 1.4929 | Test ROC-AUC: 0.8549
DEBUG - 07/09/25 16:58:58 - 0:41:48 - Epoch 124
INFO - 07/09/25 16:59:18 - 0:42:08 - Epoch 125/200 | Step 5250 |  Avg Test Loss: 1.4866 | Test ROC-AUC: 0.8520
DEBUG - 07/09/25 16:59:18 - 0:42:08 - Epoch 125
INFO - 07/09/25 16:59:37 - 0:42:27 - Epoch 126/200 | Step 5292 |  Avg Test Loss: 1.4917 | Test ROC-AUC: 0.8540
DEBUG - 07/09/25 16:59:37 - 0:42:27 - Epoch 126
INFO - 07/09/25 16:59:56 - 0:42:47 - Epoch 127/200 | Step 5334 |  Avg Test Loss: 1.4775 | Test ROC-AUC: 0.8552
DEBUG - 07/09/25 16:59:57 - 0:42:47 - Epoch 127
INFO - 07/09/25 17:00:16 - 0:43:06 - Epoch 128/200 | Step 5376 |  Avg Test Loss: 1.5146 | Test ROC-AUC: 0.8474
DEBUG - 07/09/25 17:00:16 - 0:43:06 - Epoch 128
INFO - 07/09/25 17:00:35 - 0:43:26 - Epoch 129/200 | Step 5418 |  Avg Test Loss: 1.5116 | Test ROC-AUC: 0.8459
DEBUG - 07/09/25 17:00:36 - 0:43:26 - Epoch 129
INFO - 07/09/25 17:00:55 - 0:43:45 - Epoch 130/200 | Step 5460 |  Avg Test Loss: 1.4829 | Test ROC-AUC: 0.8586
DEBUG - 07/09/25 17:00:55 - 0:43:45 - Epoch 130
INFO - 07/09/25 17:01:14 - 0:44:05 - Epoch 131/200 | Step 5502 |  Avg Test Loss: 1.5313 | Test ROC-AUC: 0.8337
DEBUG - 07/09/25 17:01:14 - 0:44:05 - Epoch 131
INFO - 07/09/25 17:01:34 - 0:44:24 - Epoch 132/200 | Step 5544 |  Avg Test Loss: 1.4898 | Test ROC-AUC: 0.8493
DEBUG - 07/09/25 17:01:34 - 0:44:24 - Epoch 132
INFO - 07/09/25 17:01:53 - 0:44:44 - Epoch 133/200 | Step 5586 |  Avg Test Loss: 1.4669 | Test ROC-AUC: 0.8591
DEBUG - 07/09/25 17:01:53 - 0:44:44 - Epoch 133
INFO - 07/09/25 17:02:13 - 0:45:03 - Epoch 134/200 | Step 5628 |  Avg Test Loss: 1.4739 | Test ROC-AUC: 0.8515
DEBUG - 07/09/25 17:02:13 - 0:45:03 - Epoch 134
INFO - 07/09/25 17:02:32 - 0:45:22 - Epoch 135/200 | Step 5670 |  Avg Test Loss: 1.4652 | Test ROC-AUC: 0.8606
DEBUG - 07/09/25 17:02:32 - 0:45:23 - Epoch 135
INFO - 07/09/25 17:02:53 - 0:45:43 - Epoch 136/200 | Step 5712 |  Avg Test Loss: 1.5330 | Test ROC-AUC: 0.8388
DEBUG - 07/09/25 17:02:53 - 0:45:43 - Epoch 136
INFO - 07/09/25 17:03:13 - 0:46:04 - Epoch 137/200 | Step 5754 |  Avg Test Loss: 1.5078 | Test ROC-AUC: 0.8405
DEBUG - 07/09/25 17:03:13 - 0:46:04 - Epoch 137
INFO - 07/09/25 17:03:34 - 0:46:24 - Epoch 138/200 | Step 5796 |  Avg Test Loss: 1.5102 | Test ROC-AUC: 0.8481
DEBUG - 07/09/25 17:03:34 - 0:46:24 - Epoch 138
INFO - 07/09/25 17:03:54 - 0:46:44 - Epoch 139/200 | Step 5838 |  Avg Test Loss: 1.5116 | Test ROC-AUC: 0.8476
DEBUG - 07/09/25 17:03:54 - 0:46:45 - Epoch 139
INFO - 07/09/25 17:04:14 - 0:47:05 - Epoch 140/200 | Step 5880 |  Avg Test Loss: 1.4712 | Test ROC-AUC: 0.8491
DEBUG - 07/09/25 17:04:14 - 0:47:05 - Epoch 140
INFO - 07/09/25 17:04:50 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 17:04:50 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 17:04:50 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 17:04:50 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 17:04:50 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 17:04:50 - 0:00:00 - Loading data
DEBUG - 07/09/25 17:04:50 - 0:00:00 - Total size = 1513
DEBUG - 07/09/25 17:04:50 - 0:00:00 - Building model 0
DEBUG - 07/09/25 17:04:51 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 17:04:51 - 0:00:02 - Number of M1 parameters = 4,254,754
DEBUG - 07/09/25 17:04:51 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 17:04:51 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 17:04:51 - 0:00:02 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 17:04:51 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 17:04:51 - 0:00:02 - Epoch 0
INFO - 07/09/25 17:05:13 - 0:00:23 - Epoch 1/200 | Step 42 |  Avg Test Loss: 3.1792 | Test ROC-AUC: 0.5558
DEBUG - 07/09/25 17:05:13 - 0:00:23 - Epoch 1
INFO - 07/09/25 17:05:33 - 0:00:44 - Epoch 2/200 | Step 84 |  Avg Test Loss: 3.2844 | Test ROC-AUC: 0.4042
DEBUG - 07/09/25 17:05:33 - 0:00:44 - Epoch 2
INFO - 07/09/25 17:05:54 - 0:01:04 - Epoch 3/200 | Step 126 |  Avg Test Loss: 3.2674 | Test ROC-AUC: 0.4364
DEBUG - 07/09/25 17:05:54 - 0:01:04 - Epoch 3
INFO - 07/09/25 17:06:14 - 0:01:25 - Epoch 4/200 | Step 168 |  Avg Test Loss: 3.2437 | Test ROC-AUC: 0.4630
DEBUG - 07/09/25 17:06:14 - 0:01:25 - Epoch 4
INFO - 07/09/25 17:06:35 - 0:01:46 - Epoch 5/200 | Step 210 |  Avg Test Loss: 3.1827 | Test ROC-AUC: 0.5863
DEBUG - 07/09/25 17:06:35 - 0:01:46 - Epoch 5
INFO - 07/09/25 17:06:56 - 0:02:07 - Epoch 6/200 | Step 252 |  Avg Test Loss: 3.2963 | Test ROC-AUC: 0.5538
DEBUG - 07/09/25 17:06:56 - 0:02:07 - Epoch 6
INFO - 07/09/25 17:07:17 - 0:02:27 - Epoch 7/200 | Step 294 |  Avg Test Loss: 3.2292 | Test ROC-AUC: 0.5790
DEBUG - 07/09/25 17:07:17 - 0:02:28 - Epoch 7
INFO - 07/09/25 17:07:37 - 0:02:48 - Epoch 8/200 | Step 336 |  Avg Test Loss: 3.1305 | Test ROC-AUC: 0.6349
DEBUG - 07/09/25 17:07:38 - 0:02:48 - Epoch 8
INFO - 07/09/25 17:07:58 - 0:03:09 - Epoch 9/200 | Step 378 |  Avg Test Loss: 3.1214 | Test ROC-AUC: 0.6166
DEBUG - 07/09/25 17:07:58 - 0:03:09 - Epoch 9
INFO - 07/09/25 17:08:19 - 0:03:29 - Epoch 10/200 | Step 420 |  Avg Test Loss: 3.0931 | Test ROC-AUC: 0.5216
DEBUG - 07/09/25 17:08:19 - 0:03:29 - Epoch 10
INFO - 07/09/25 17:08:39 - 0:03:50 - Epoch 11/200 | Step 462 |  Avg Test Loss: 3.0002 | Test ROC-AUC: 0.4344
DEBUG - 07/09/25 17:08:39 - 0:03:50 - Epoch 11
INFO - 07/09/25 17:09:00 - 0:04:10 - Epoch 12/200 | Step 504 |  Avg Test Loss: 2.9842 | Test ROC-AUC: 0.4918
DEBUG - 07/09/25 17:09:00 - 0:04:11 - Epoch 12
INFO - 07/09/25 17:09:11 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 17:09:11 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 17:09:11 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 17:09:11 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 17:09:11 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 17:09:11 - 0:00:00 - Loading data
DEBUG - 07/09/25 17:09:11 - 0:00:00 - Total size = 1513
DEBUG - 07/09/25 17:09:11 - 0:00:00 - Building model 0
DEBUG - 07/09/25 17:09:13 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 17:09:13 - 0:00:02 - Number of M1 parameters = 4,254,754
DEBUG - 07/09/25 17:09:13 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 17:09:13 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 17:09:13 - 0:00:02 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 17:09:13 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 17:09:13 - 0:00:02 - Epoch 0
INFO - 07/09/25 17:09:34 - 0:00:23 - Epoch 1/200 | Step 42 |  Avg Test Loss: 3.7665 | Test ROC-AUC: 0.5104
DEBUG - 07/09/25 17:09:34 - 0:00:23 - Epoch 1
INFO - 07/09/25 17:09:55 - 0:00:44 - Epoch 2/200 | Step 84 |  Avg Test Loss: 2.8713 | Test ROC-AUC: 0.6400
DEBUG - 07/09/25 17:09:55 - 0:00:44 - Epoch 2
INFO - 07/09/25 17:10:15 - 0:01:04 - Epoch 3/200 | Step 126 |  Avg Test Loss: 2.2392 | Test ROC-AUC: 0.6552
DEBUG - 07/09/25 17:10:15 - 0:01:04 - Epoch 3
INFO - 07/09/25 17:10:36 - 0:01:25 - Epoch 4/200 | Step 168 |  Avg Test Loss: 1.8960 | Test ROC-AUC: 0.7004
DEBUG - 07/09/25 17:10:36 - 0:01:25 - Epoch 4
INFO - 07/09/25 17:10:56 - 0:01:45 - Epoch 5/200 | Step 210 |  Avg Test Loss: 1.7344 | Test ROC-AUC: 0.7353
DEBUG - 07/09/25 17:10:56 - 0:01:45 - Epoch 5
INFO - 07/09/25 17:11:16 - 0:02:05 - Epoch 6/200 | Step 252 |  Avg Test Loss: 1.6801 | Test ROC-AUC: 0.7426
DEBUG - 07/09/25 17:11:16 - 0:02:05 - Epoch 6
INFO - 07/09/25 17:11:37 - 0:02:26 - Epoch 7/200 | Step 294 |  Avg Test Loss: 1.6376 | Test ROC-AUC: 0.7404
DEBUG - 07/09/25 17:11:37 - 0:02:26 - Epoch 7
INFO - 07/09/25 17:11:58 - 0:02:47 - Epoch 8/200 | Step 336 |  Avg Test Loss: 1.7719 | Test ROC-AUC: 0.6879
DEBUG - 07/09/25 17:11:58 - 0:02:47 - Epoch 8
INFO - 07/09/25 17:12:19 - 0:03:08 - Epoch 9/200 | Step 378 |  Avg Test Loss: 1.6150 | Test ROC-AUC: 0.7492
DEBUG - 07/09/25 17:12:19 - 0:03:08 - Epoch 9
INFO - 07/09/25 17:12:39 - 0:03:28 - Epoch 10/200 | Step 420 |  Avg Test Loss: 1.6193 | Test ROC-AUC: 0.7631
DEBUG - 07/09/25 17:12:39 - 0:03:28 - Epoch 10
INFO - 07/09/25 17:13:00 - 0:03:49 - Epoch 11/200 | Step 462 |  Avg Test Loss: 1.5895 | Test ROC-AUC: 0.7604
DEBUG - 07/09/25 17:13:00 - 0:03:49 - Epoch 11
INFO - 07/09/25 17:13:20 - 0:04:09 - Epoch 12/200 | Step 504 |  Avg Test Loss: 1.6042 | Test ROC-AUC: 0.7844
DEBUG - 07/09/25 17:13:20 - 0:04:09 - Epoch 12
INFO - 07/09/25 17:13:41 - 0:04:30 - Epoch 13/200 | Step 546 |  Avg Test Loss: 1.5926 | Test ROC-AUC: 0.7736
DEBUG - 07/09/25 17:13:41 - 0:04:30 - Epoch 13
INFO - 07/09/25 17:14:01 - 0:04:50 - Epoch 14/200 | Step 588 |  Avg Test Loss: 1.5806 | Test ROC-AUC: 0.7602
DEBUG - 07/09/25 17:14:01 - 0:04:50 - Epoch 14
INFO - 07/09/25 17:14:21 - 0:05:10 - Epoch 15/200 | Step 630 |  Avg Test Loss: 1.5749 | Test ROC-AUC: 0.7919
DEBUG - 07/09/25 17:14:21 - 0:05:10 - Epoch 15
INFO - 07/09/25 17:14:41 - 0:05:30 - Epoch 16/200 | Step 672 |  Avg Test Loss: 1.5707 | Test ROC-AUC: 0.7841
DEBUG - 07/09/25 17:14:41 - 0:05:31 - Epoch 16
INFO - 07/09/25 17:15:01 - 0:05:50 - Epoch 17/200 | Step 714 |  Avg Test Loss: 1.5842 | Test ROC-AUC: 0.7841
DEBUG - 07/09/25 17:15:02 - 0:05:51 - Epoch 17
INFO - 07/09/25 17:15:22 - 0:06:11 - Epoch 18/200 | Step 756 |  Avg Test Loss: 1.6232 | Test ROC-AUC: 0.7873
DEBUG - 07/09/25 17:15:22 - 0:06:11 - Epoch 18
INFO - 07/09/25 17:15:42 - 0:06:31 - Epoch 19/200 | Step 798 |  Avg Test Loss: 1.5497 | Test ROC-AUC: 0.7905
DEBUG - 07/09/25 17:15:42 - 0:06:31 - Epoch 19
INFO - 07/09/25 17:16:03 - 0:06:52 - Epoch 20/200 | Step 840 |  Avg Test Loss: 1.6004 | Test ROC-AUC: 0.7968
DEBUG - 07/09/25 17:16:03 - 0:06:52 - Epoch 20
INFO - 07/09/25 17:16:24 - 0:07:13 - Epoch 21/200 | Step 882 |  Avg Test Loss: 1.5394 | Test ROC-AUC: 0.7941
DEBUG - 07/09/25 17:16:24 - 0:07:13 - Epoch 21
INFO - 07/09/25 17:16:44 - 0:07:33 - Epoch 22/200 | Step 924 |  Avg Test Loss: 1.5392 | Test ROC-AUC: 0.7961
DEBUG - 07/09/25 17:16:44 - 0:07:33 - Epoch 22
INFO - 07/09/25 17:17:05 - 0:07:54 - Epoch 23/200 | Step 966 |  Avg Test Loss: 1.5470 | Test ROC-AUC: 0.7988
DEBUG - 07/09/25 17:17:05 - 0:07:54 - Epoch 23
INFO - 07/09/25 17:17:25 - 0:08:14 - Epoch 24/200 | Step 1008 |  Avg Test Loss: 1.5492 | Test ROC-AUC: 0.8110
DEBUG - 07/09/25 17:17:25 - 0:08:14 - Epoch 24
INFO - 07/09/25 17:17:46 - 0:08:35 - Epoch 25/200 | Step 1050 |  Avg Test Loss: 1.5330 | Test ROC-AUC: 0.7968
DEBUG - 07/09/25 17:17:46 - 0:08:35 - Epoch 25
INFO - 07/09/25 17:18:06 - 0:08:55 - Epoch 26/200 | Step 1092 |  Avg Test Loss: 1.5137 | Test ROC-AUC: 0.8147
DEBUG - 07/09/25 17:18:06 - 0:08:55 - Epoch 26
INFO - 07/09/25 17:18:26 - 0:09:15 - Epoch 27/200 | Step 1134 |  Avg Test Loss: 1.5432 | Test ROC-AUC: 0.8137
DEBUG - 07/09/25 17:18:26 - 0:09:15 - Epoch 27
INFO - 07/09/25 17:18:47 - 0:09:36 - Epoch 28/200 | Step 1176 |  Avg Test Loss: 1.5529 | Test ROC-AUC: 0.8081
DEBUG - 07/09/25 17:18:47 - 0:09:36 - Epoch 28
INFO - 07/09/25 17:19:06 - 0:09:55 - Epoch 29/200 | Step 1218 |  Avg Test Loss: 1.5159 | Test ROC-AUC: 0.8061
DEBUG - 07/09/25 17:19:06 - 0:09:55 - Epoch 29
INFO - 07/09/25 17:19:27 - 0:10:16 - Epoch 30/200 | Step 1260 |  Avg Test Loss: 1.5087 | Test ROC-AUC: 0.8186
DEBUG - 07/09/25 17:19:27 - 0:10:16 - Epoch 30
INFO - 07/09/25 17:19:47 - 0:10:36 - Epoch 31/200 | Step 1302 |  Avg Test Loss: 1.5263 | Test ROC-AUC: 0.8051
DEBUG - 07/09/25 17:19:47 - 0:10:36 - Epoch 31
INFO - 07/09/25 17:20:07 - 0:10:56 - Epoch 32/200 | Step 1344 |  Avg Test Loss: 1.5289 | Test ROC-AUC: 0.8027
DEBUG - 07/09/25 17:20:07 - 0:10:56 - Epoch 32
INFO - 07/09/25 17:20:28 - 0:11:17 - Epoch 33/200 | Step 1386 |  Avg Test Loss: 1.4962 | Test ROC-AUC: 0.8149
DEBUG - 07/09/25 17:20:28 - 0:11:17 - Epoch 33
INFO - 07/09/25 17:20:47 - 0:11:36 - Epoch 34/200 | Step 1428 |  Avg Test Loss: 1.4977 | Test ROC-AUC: 0.8181
DEBUG - 07/09/25 17:20:47 - 0:11:36 - Epoch 34
INFO - 07/09/25 17:21:06 - 0:11:55 - Epoch 35/200 | Step 1470 |  Avg Test Loss: 1.5108 | Test ROC-AUC: 0.8156
DEBUG - 07/09/25 17:21:06 - 0:11:55 - Epoch 35
INFO - 07/09/25 17:21:25 - 0:12:14 - Epoch 36/200 | Step 1512 |  Avg Test Loss: 1.5638 | Test ROC-AUC: 0.8081
DEBUG - 07/09/25 17:21:25 - 0:12:14 - Epoch 36
INFO - 07/09/25 17:21:45 - 0:12:34 - Epoch 37/200 | Step 1554 |  Avg Test Loss: 1.4973 | Test ROC-AUC: 0.8217
DEBUG - 07/09/25 17:21:45 - 0:12:34 - Epoch 37
INFO - 07/09/25 17:22:05 - 0:12:54 - Epoch 38/200 | Step 1596 |  Avg Test Loss: 1.4973 | Test ROC-AUC: 0.8205
DEBUG - 07/09/25 17:22:05 - 0:12:54 - Epoch 38
INFO - 07/09/25 17:22:25 - 0:13:14 - Epoch 39/200 | Step 1638 |  Avg Test Loss: 1.4978 | Test ROC-AUC: 0.8164
DEBUG - 07/09/25 17:22:25 - 0:13:14 - Epoch 39
INFO - 07/09/25 17:22:45 - 0:13:34 - Epoch 40/200 | Step 1680 |  Avg Test Loss: 1.5046 | Test ROC-AUC: 0.8186
DEBUG - 07/09/25 17:22:45 - 0:13:34 - Epoch 40
INFO - 07/09/25 17:23:05 - 0:13:54 - Epoch 41/200 | Step 1722 |  Avg Test Loss: 1.4930 | Test ROC-AUC: 0.8249
DEBUG - 07/09/25 17:23:05 - 0:13:54 - Epoch 41
INFO - 07/09/25 17:23:26 - 0:14:15 - Epoch 42/200 | Step 1764 |  Avg Test Loss: 1.4732 | Test ROC-AUC: 0.8435
DEBUG - 07/09/25 17:23:26 - 0:14:15 - Epoch 42
INFO - 07/09/25 17:23:46 - 0:14:35 - Epoch 43/200 | Step 1806 |  Avg Test Loss: 1.5068 | Test ROC-AUC: 0.8283
DEBUG - 07/09/25 17:23:46 - 0:14:35 - Epoch 43
INFO - 07/09/25 17:24:07 - 0:14:56 - Epoch 44/200 | Step 1848 |  Avg Test Loss: 1.4841 | Test ROC-AUC: 0.8405
DEBUG - 07/09/25 17:24:08 - 0:14:57 - Epoch 44
INFO - 07/09/25 17:24:27 - 0:15:16 - Epoch 45/200 | Step 1890 |  Avg Test Loss: 1.4742 | Test ROC-AUC: 0.8386
DEBUG - 07/09/25 17:24:27 - 0:15:16 - Epoch 45
INFO - 07/09/25 17:24:48 - 0:15:37 - Epoch 46/200 | Step 1932 |  Avg Test Loss: 1.5139 | Test ROC-AUC: 0.8149
DEBUG - 07/09/25 17:24:48 - 0:15:37 - Epoch 46
INFO - 07/09/25 17:25:08 - 0:15:57 - Epoch 47/200 | Step 1974 |  Avg Test Loss: 1.4887 | Test ROC-AUC: 0.8498
DEBUG - 07/09/25 17:25:08 - 0:15:57 - Epoch 47
INFO - 07/09/25 17:25:28 - 0:16:18 - Epoch 48/200 | Step 2016 |  Avg Test Loss: 1.5101 | Test ROC-AUC: 0.8322
DEBUG - 07/09/25 17:25:29 - 0:16:18 - Epoch 48
INFO - 07/09/25 17:25:49 - 0:16:38 - Epoch 49/200 | Step 2058 |  Avg Test Loss: 1.4840 | Test ROC-AUC: 0.8339
DEBUG - 07/09/25 17:25:49 - 0:16:38 - Epoch 49
INFO - 07/09/25 17:26:09 - 0:16:58 - Epoch 50/200 | Step 2100 |  Avg Test Loss: 1.4988 | Test ROC-AUC: 0.8249
DEBUG - 07/09/25 17:26:09 - 0:16:58 - Epoch 50
INFO - 07/09/25 17:26:29 - 0:17:18 - Epoch 51/200 | Step 2142 |  Avg Test Loss: 1.4898 | Test ROC-AUC: 0.8269
DEBUG - 07/09/25 17:26:29 - 0:17:18 - Epoch 51
INFO - 07/09/25 17:26:49 - 0:17:38 - Epoch 52/200 | Step 2184 |  Avg Test Loss: 1.4805 | Test ROC-AUC: 0.8444
DEBUG - 07/09/25 17:26:50 - 0:17:39 - Epoch 52
INFO - 07/09/25 17:27:11 - 0:18:00 - Epoch 53/200 | Step 2226 |  Avg Test Loss: 1.4847 | Test ROC-AUC: 0.8425
DEBUG - 07/09/25 17:27:11 - 0:18:00 - Epoch 53
INFO - 07/09/25 17:27:31 - 0:18:20 - Epoch 54/200 | Step 2268 |  Avg Test Loss: 1.4885 | Test ROC-AUC: 0.8361
DEBUG - 07/09/25 17:27:31 - 0:18:20 - Epoch 54
INFO - 07/09/25 17:27:51 - 0:18:40 - Epoch 55/200 | Step 2310 |  Avg Test Loss: 1.5292 | Test ROC-AUC: 0.8142
DEBUG - 07/09/25 17:27:52 - 0:18:41 - Epoch 55
INFO - 07/09/25 17:28:12 - 0:19:01 - Epoch 56/200 | Step 2352 |  Avg Test Loss: 1.4743 | Test ROC-AUC: 0.8405
DEBUG - 07/09/25 17:28:12 - 0:19:01 - Epoch 56
INFO - 07/09/25 17:28:32 - 0:19:21 - Epoch 57/200 | Step 2394 |  Avg Test Loss: 1.4862 | Test ROC-AUC: 0.8249
DEBUG - 07/09/25 17:28:32 - 0:19:21 - Epoch 57
INFO - 07/09/25 17:28:53 - 0:19:42 - Epoch 58/200 | Step 2436 |  Avg Test Loss: 1.4885 | Test ROC-AUC: 0.8300
DEBUG - 07/09/25 17:28:53 - 0:19:42 - Epoch 58
INFO - 07/09/25 17:29:13 - 0:20:02 - Epoch 59/200 | Step 2478 |  Avg Test Loss: 1.4856 | Test ROC-AUC: 0.8430
DEBUG - 07/09/25 17:29:13 - 0:20:02 - Epoch 59
INFO - 07/09/25 17:29:34 - 0:20:23 - Epoch 60/200 | Step 2520 |  Avg Test Loss: 1.4825 | Test ROC-AUC: 0.8520
DEBUG - 07/09/25 17:29:34 - 0:20:23 - Epoch 60
INFO - 07/09/25 17:29:55 - 0:20:44 - Epoch 61/200 | Step 2562 |  Avg Test Loss: 1.4994 | Test ROC-AUC: 0.8320
DEBUG - 07/09/25 17:29:55 - 0:20:44 - Epoch 61
INFO - 07/09/25 17:30:15 - 0:21:04 - Epoch 62/200 | Step 2604 |  Avg Test Loss: 1.4864 | Test ROC-AUC: 0.8452
DEBUG - 07/09/25 17:30:15 - 0:21:04 - Epoch 62
INFO - 07/09/25 17:30:36 - 0:21:25 - Epoch 63/200 | Step 2646 |  Avg Test Loss: 1.5046 | Test ROC-AUC: 0.8249
DEBUG - 07/09/25 17:30:36 - 0:21:25 - Epoch 63
INFO - 07/09/25 17:30:56 - 0:21:45 - Epoch 64/200 | Step 2688 |  Avg Test Loss: 1.4654 | Test ROC-AUC: 0.8371
DEBUG - 07/09/25 17:30:56 - 0:21:45 - Epoch 64
INFO - 07/09/25 17:31:16 - 0:22:05 - Epoch 65/200 | Step 2730 |  Avg Test Loss: 1.4798 | Test ROC-AUC: 0.8418
DEBUG - 07/09/25 17:31:16 - 0:22:05 - Epoch 65
INFO - 07/09/25 17:31:37 - 0:22:26 - Epoch 66/200 | Step 2772 |  Avg Test Loss: 1.4933 | Test ROC-AUC: 0.8354
DEBUG - 07/09/25 17:31:37 - 0:22:26 - Epoch 66
INFO - 07/09/25 17:31:57 - 0:22:46 - Epoch 67/200 | Step 2814 |  Avg Test Loss: 1.4487 | Test ROC-AUC: 0.8503
DEBUG - 07/09/25 17:31:57 - 0:22:46 - Epoch 67
INFO - 07/09/25 17:32:18 - 0:23:07 - Epoch 68/200 | Step 2856 |  Avg Test Loss: 1.4623 | Test ROC-AUC: 0.8437
DEBUG - 07/09/25 17:32:18 - 0:23:07 - Epoch 68
INFO - 07/09/25 17:32:38 - 0:23:27 - Epoch 69/200 | Step 2898 |  Avg Test Loss: 1.4670 | Test ROC-AUC: 0.8464
DEBUG - 07/09/25 17:32:38 - 0:23:27 - Epoch 69
INFO - 07/09/25 17:32:58 - 0:23:47 - Epoch 70/200 | Step 2940 |  Avg Test Loss: 1.4670 | Test ROC-AUC: 0.8491
DEBUG - 07/09/25 17:32:58 - 0:23:47 - Epoch 70
INFO - 07/09/25 17:33:18 - 0:24:07 - Epoch 71/200 | Step 2982 |  Avg Test Loss: 1.4495 | Test ROC-AUC: 0.8527
DEBUG - 07/09/25 17:33:19 - 0:24:08 - Epoch 71
INFO - 07/09/25 17:33:39 - 0:24:28 - Epoch 72/200 | Step 3024 |  Avg Test Loss: 1.4729 | Test ROC-AUC: 0.8437
DEBUG - 07/09/25 17:33:39 - 0:24:28 - Epoch 72
INFO - 07/09/25 17:33:59 - 0:24:48 - Epoch 73/200 | Step 3066 |  Avg Test Loss: 1.4606 | Test ROC-AUC: 0.8606
DEBUG - 07/09/25 17:34:00 - 0:24:49 - Epoch 73
INFO - 07/09/25 17:34:19 - 0:25:08 - Epoch 74/200 | Step 3108 |  Avg Test Loss: 1.4987 | Test ROC-AUC: 0.8381
DEBUG - 07/09/25 17:34:19 - 0:25:08 - Epoch 74
INFO - 07/09/25 17:34:40 - 0:25:29 - Epoch 75/200 | Step 3150 |  Avg Test Loss: 1.4648 | Test ROC-AUC: 0.8435
DEBUG - 07/09/25 17:34:40 - 0:25:29 - Epoch 75
INFO - 07/09/25 17:35:00 - 0:25:49 - Epoch 76/200 | Step 3192 |  Avg Test Loss: 1.5522 | Test ROC-AUC: 0.8486
DEBUG - 07/09/25 17:35:00 - 0:25:49 - Epoch 76
INFO - 07/09/25 17:35:21 - 0:26:10 - Epoch 77/200 | Step 3234 |  Avg Test Loss: 1.4562 | Test ROC-AUC: 0.8557
DEBUG - 07/09/25 17:35:21 - 0:26:10 - Epoch 77
INFO - 07/09/25 17:35:41 - 0:26:30 - Epoch 78/200 | Step 3276 |  Avg Test Loss: 1.4791 | Test ROC-AUC: 0.8488
DEBUG - 07/09/25 17:35:42 - 0:26:31 - Epoch 78
INFO - 07/09/25 17:36:01 - 0:26:50 - Epoch 79/200 | Step 3318 |  Avg Test Loss: 1.4774 | Test ROC-AUC: 0.8379
DEBUG - 07/09/25 17:36:02 - 0:26:51 - Epoch 79
INFO - 07/09/25 17:36:22 - 0:27:11 - Epoch 80/200 | Step 3360 |  Avg Test Loss: 1.4468 | Test ROC-AUC: 0.8454
DEBUG - 07/09/25 17:36:22 - 0:27:11 - Epoch 80
INFO - 07/09/25 17:36:42 - 0:27:31 - Epoch 81/200 | Step 3402 |  Avg Test Loss: 1.5099 | Test ROC-AUC: 0.8396
DEBUG - 07/09/25 17:36:42 - 0:27:31 - Epoch 81
INFO - 07/09/25 17:37:02 - 0:27:51 - Epoch 82/200 | Step 3444 |  Avg Test Loss: 1.4739 | Test ROC-AUC: 0.8474
DEBUG - 07/09/25 17:37:02 - 0:27:51 - Epoch 82
INFO - 07/09/25 17:37:22 - 0:28:11 - Epoch 83/200 | Step 3486 |  Avg Test Loss: 1.4738 | Test ROC-AUC: 0.8400
DEBUG - 07/09/25 17:37:22 - 0:28:11 - Epoch 83
INFO - 07/09/25 17:37:43 - 0:28:32 - Epoch 84/200 | Step 3528 |  Avg Test Loss: 1.4841 | Test ROC-AUC: 0.8510
DEBUG - 07/09/25 17:37:43 - 0:28:32 - Epoch 84
INFO - 07/09/25 17:38:03 - 0:28:52 - Epoch 85/200 | Step 3570 |  Avg Test Loss: 1.4585 | Test ROC-AUC: 0.8523
DEBUG - 07/09/25 17:38:03 - 0:28:52 - Epoch 85
INFO - 07/09/25 17:38:24 - 0:29:13 - Epoch 86/200 | Step 3612 |  Avg Test Loss: 1.4534 | Test ROC-AUC: 0.8554
DEBUG - 07/09/25 17:38:24 - 0:29:13 - Epoch 86
INFO - 07/09/25 17:38:45 - 0:29:34 - Epoch 87/200 | Step 3654 |  Avg Test Loss: 1.4815 | Test ROC-AUC: 0.8479
DEBUG - 07/09/25 17:38:45 - 0:29:34 - Epoch 87
INFO - 07/09/25 17:39:05 - 0:29:54 - Epoch 88/200 | Step 3696 |  Avg Test Loss: 1.4769 | Test ROC-AUC: 0.8493
DEBUG - 07/09/25 17:39:05 - 0:29:54 - Epoch 88
INFO - 07/09/25 17:39:25 - 0:30:14 - Epoch 89/200 | Step 3738 |  Avg Test Loss: 1.4756 | Test ROC-AUC: 0.8447
DEBUG - 07/09/25 17:39:25 - 0:30:14 - Epoch 89
INFO - 07/09/25 17:39:46 - 0:30:35 - Epoch 90/200 | Step 3780 |  Avg Test Loss: 1.4749 | Test ROC-AUC: 0.8479
DEBUG - 07/09/25 17:39:46 - 0:30:35 - Epoch 90
INFO - 07/09/25 17:40:06 - 0:30:55 - Epoch 91/200 | Step 3822 |  Avg Test Loss: 1.4611 | Test ROC-AUC: 0.8479
DEBUG - 07/09/25 17:40:06 - 0:30:55 - Epoch 91
INFO - 07/09/25 17:40:26 - 0:31:15 - Epoch 92/200 | Step 3864 |  Avg Test Loss: 1.4893 | Test ROC-AUC: 0.8464
DEBUG - 07/09/25 17:40:26 - 0:31:15 - Epoch 92
INFO - 07/09/25 17:40:46 - 0:31:35 - Epoch 93/200 | Step 3906 |  Avg Test Loss: 1.4697 | Test ROC-AUC: 0.8476
DEBUG - 07/09/25 17:40:46 - 0:31:35 - Epoch 93
INFO - 07/09/25 17:41:07 - 0:31:56 - Epoch 94/200 | Step 3948 |  Avg Test Loss: 1.4789 | Test ROC-AUC: 0.8505
DEBUG - 07/09/25 17:41:07 - 0:31:56 - Epoch 94
INFO - 07/09/25 17:41:27 - 0:32:16 - Epoch 95/200 | Step 3990 |  Avg Test Loss: 1.5307 | Test ROC-AUC: 0.8425
DEBUG - 07/09/25 17:41:27 - 0:32:16 - Epoch 95
INFO - 07/09/25 17:41:48 - 0:32:37 - Epoch 96/200 | Step 4032 |  Avg Test Loss: 1.4728 | Test ROC-AUC: 0.8527
DEBUG - 07/09/25 17:41:48 - 0:32:37 - Epoch 96
INFO - 07/09/25 17:42:08 - 0:32:57 - Epoch 97/200 | Step 4074 |  Avg Test Loss: 1.4843 | Test ROC-AUC: 0.8457
DEBUG - 07/09/25 17:42:08 - 0:32:57 - Epoch 97
INFO - 07/09/25 17:42:28 - 0:33:17 - Epoch 98/200 | Step 4116 |  Avg Test Loss: 1.4875 | Test ROC-AUC: 0.8369
DEBUG - 07/09/25 17:42:28 - 0:33:17 - Epoch 98
INFO - 07/09/25 17:42:49 - 0:33:38 - Epoch 99/200 | Step 4158 |  Avg Test Loss: 1.4854 | Test ROC-AUC: 0.8486
DEBUG - 07/09/25 17:42:49 - 0:33:38 - Epoch 99
INFO - 07/09/25 17:43:09 - 0:33:58 - Epoch 100/200 | Step 4200 |  Avg Test Loss: 1.4707 | Test ROC-AUC: 0.8486
DEBUG - 07/09/25 17:43:09 - 0:33:58 - Epoch 100
INFO - 07/09/25 17:43:29 - 0:34:18 - Epoch 101/200 | Step 4242 |  Avg Test Loss: 1.5278 | Test ROC-AUC: 0.8310
DEBUG - 07/09/25 17:43:29 - 0:34:18 - Epoch 101
INFO - 07/09/25 17:43:50 - 0:34:39 - Epoch 102/200 | Step 4284 |  Avg Test Loss: 1.4928 | Test ROC-AUC: 0.8444
DEBUG - 07/09/25 17:43:50 - 0:34:39 - Epoch 102
INFO - 07/09/25 17:44:09 - 0:34:58 - Epoch 103/200 | Step 4326 |  Avg Test Loss: 1.4785 | Test ROC-AUC: 0.8493
DEBUG - 07/09/25 17:44:10 - 0:34:59 - Epoch 103
INFO - 07/09/25 17:44:29 - 0:35:18 - Epoch 104/200 | Step 4368 |  Avg Test Loss: 1.4670 | Test ROC-AUC: 0.8530
DEBUG - 07/09/25 17:44:29 - 0:35:18 - Epoch 104
INFO - 07/09/25 17:44:48 - 0:35:37 - Epoch 105/200 | Step 4410 |  Avg Test Loss: 1.4761 | Test ROC-AUC: 0.8403
DEBUG - 07/09/25 17:44:48 - 0:35:37 - Epoch 105
INFO - 07/09/25 17:45:08 - 0:35:57 - Epoch 106/200 | Step 4452 |  Avg Test Loss: 1.4839 | Test ROC-AUC: 0.8435
DEBUG - 07/09/25 17:45:08 - 0:35:57 - Epoch 106
INFO - 07/09/25 17:45:29 - 0:36:18 - Epoch 107/200 | Step 4494 |  Avg Test Loss: 1.4672 | Test ROC-AUC: 0.8549
DEBUG - 07/09/25 17:45:29 - 0:36:18 - Epoch 107
INFO - 07/09/25 17:45:49 - 0:36:38 - Epoch 108/200 | Step 4536 |  Avg Test Loss: 1.4521 | Test ROC-AUC: 0.8576
DEBUG - 07/09/25 17:45:49 - 0:36:38 - Epoch 108
INFO - 07/09/25 17:46:10 - 0:36:59 - Epoch 109/200 | Step 4578 |  Avg Test Loss: 1.4810 | Test ROC-AUC: 0.8496
DEBUG - 07/09/25 17:46:10 - 0:36:59 - Epoch 109
INFO - 07/09/25 17:46:30 - 0:37:19 - Epoch 110/200 | Step 4620 |  Avg Test Loss: 1.4867 | Test ROC-AUC: 0.8442
DEBUG - 07/09/25 17:46:30 - 0:37:19 - Epoch 110
INFO - 07/09/25 17:46:50 - 0:37:39 - Epoch 111/200 | Step 4662 |  Avg Test Loss: 1.4875 | Test ROC-AUC: 0.8510
DEBUG - 07/09/25 17:46:50 - 0:37:39 - Epoch 111
INFO - 07/09/25 17:47:11 - 0:38:00 - Epoch 112/200 | Step 4704 |  Avg Test Loss: 1.4958 | Test ROC-AUC: 0.8474
DEBUG - 07/09/25 17:47:11 - 0:38:00 - Epoch 112
INFO - 07/09/25 17:47:31 - 0:38:20 - Epoch 113/200 | Step 4746 |  Avg Test Loss: 1.4697 | Test ROC-AUC: 0.8520
DEBUG - 07/09/25 17:47:31 - 0:38:20 - Epoch 113
INFO - 07/09/25 17:47:51 - 0:38:40 - Epoch 114/200 | Step 4788 |  Avg Test Loss: 1.4952 | Test ROC-AUC: 0.8481
DEBUG - 07/09/25 17:47:51 - 0:38:40 - Epoch 114
INFO - 07/09/25 17:48:11 - 0:39:00 - Epoch 115/200 | Step 4830 |  Avg Test Loss: 1.4636 | Test ROC-AUC: 0.8527
DEBUG - 07/09/25 17:48:12 - 0:39:01 - Epoch 115
INFO - 07/09/25 17:48:32 - 0:39:21 - Epoch 116/200 | Step 4872 |  Avg Test Loss: 1.5187 | Test ROC-AUC: 0.8330
DEBUG - 07/09/25 17:48:32 - 0:39:21 - Epoch 116
INFO - 07/09/25 17:48:52 - 0:39:41 - Epoch 117/200 | Step 4914 |  Avg Test Loss: 1.4789 | Test ROC-AUC: 0.8471
DEBUG - 07/09/25 17:48:52 - 0:39:41 - Epoch 117
INFO - 07/09/25 17:49:12 - 0:40:01 - Epoch 118/200 | Step 4956 |  Avg Test Loss: 1.5282 | Test ROC-AUC: 0.8335
DEBUG - 07/09/25 17:49:12 - 0:40:01 - Epoch 118
INFO - 07/09/25 17:49:32 - 0:40:21 - Epoch 119/200 | Step 4998 |  Avg Test Loss: 1.4670 | Test ROC-AUC: 0.8496
DEBUG - 07/09/25 17:49:32 - 0:40:21 - Epoch 119
INFO - 07/09/25 17:49:53 - 0:40:42 - Epoch 120/200 | Step 5040 |  Avg Test Loss: 1.4850 | Test ROC-AUC: 0.8486
DEBUG - 07/09/25 17:49:53 - 0:40:42 - Epoch 120
INFO - 07/09/25 17:50:14 - 0:41:03 - Epoch 121/200 | Step 5082 |  Avg Test Loss: 1.4822 | Test ROC-AUC: 0.8523
DEBUG - 07/09/25 17:50:14 - 0:41:03 - Epoch 121
INFO - 07/09/25 17:50:34 - 0:41:23 - Epoch 122/200 | Step 5124 |  Avg Test Loss: 1.5111 | Test ROC-AUC: 0.8405
DEBUG - 07/09/25 17:50:34 - 0:41:23 - Epoch 122
INFO - 07/09/25 17:50:54 - 0:41:43 - Epoch 123/200 | Step 5166 |  Avg Test Loss: 1.4668 | Test ROC-AUC: 0.8564
DEBUG - 07/09/25 17:50:54 - 0:41:43 - Epoch 123
INFO - 07/09/25 17:51:14 - 0:42:03 - Epoch 124/200 | Step 5208 |  Avg Test Loss: 1.4863 | Test ROC-AUC: 0.8488
DEBUG - 07/09/25 17:51:14 - 0:42:03 - Epoch 124
INFO - 07/09/25 17:51:34 - 0:42:23 - Epoch 125/200 | Step 5250 |  Avg Test Loss: 1.5040 | Test ROC-AUC: 0.8432
DEBUG - 07/09/25 17:51:34 - 0:42:23 - Epoch 125
INFO - 07/09/25 17:51:55 - 0:42:44 - Epoch 126/200 | Step 5292 |  Avg Test Loss: 1.4899 | Test ROC-AUC: 0.8508
DEBUG - 07/09/25 17:51:55 - 0:42:44 - Epoch 126
INFO - 07/09/25 17:52:16 - 0:43:05 - Epoch 127/200 | Step 5334 |  Avg Test Loss: 1.4862 | Test ROC-AUC: 0.8540
DEBUG - 07/09/25 17:52:16 - 0:43:05 - Epoch 127
INFO - 07/09/25 17:52:36 - 0:43:25 - Epoch 128/200 | Step 5376 |  Avg Test Loss: 1.4832 | Test ROC-AUC: 0.8569
DEBUG - 07/09/25 17:52:36 - 0:43:25 - Epoch 128
INFO - 07/09/25 17:52:56 - 0:43:45 - Epoch 129/200 | Step 5418 |  Avg Test Loss: 1.5015 | Test ROC-AUC: 0.8457
DEBUG - 07/09/25 17:52:56 - 0:43:45 - Epoch 129
INFO - 07/09/25 17:53:17 - 0:44:06 - Epoch 130/200 | Step 5460 |  Avg Test Loss: 1.4839 | Test ROC-AUC: 0.8554
DEBUG - 07/09/25 17:53:17 - 0:44:06 - Epoch 130
INFO - 07/09/25 17:53:37 - 0:44:26 - Epoch 131/200 | Step 5502 |  Avg Test Loss: 1.5153 | Test ROC-AUC: 0.8462
DEBUG - 07/09/25 17:53:37 - 0:44:26 - Epoch 131
INFO - 07/09/25 17:53:57 - 0:44:46 - Epoch 132/200 | Step 5544 |  Avg Test Loss: 1.4224 | Test ROC-AUC: 0.8716
DEBUG - 07/09/25 17:53:57 - 0:44:46 - Epoch 132
INFO - 07/09/25 17:54:18 - 0:45:07 - Epoch 133/200 | Step 5586 |  Avg Test Loss: 1.4731 | Test ROC-AUC: 0.8491
DEBUG - 07/09/25 17:54:18 - 0:45:07 - Epoch 133
INFO - 07/09/25 17:54:38 - 0:45:27 - Epoch 134/200 | Step 5628 |  Avg Test Loss: 1.4871 | Test ROC-AUC: 0.8501
DEBUG - 07/09/25 17:54:38 - 0:45:27 - Epoch 134
INFO - 07/09/25 17:54:58 - 0:45:47 - Epoch 135/200 | Step 5670 |  Avg Test Loss: 1.4562 | Test ROC-AUC: 0.8603
DEBUG - 07/09/25 17:54:59 - 0:45:48 - Epoch 135
INFO - 07/09/25 17:55:19 - 0:46:08 - Epoch 136/200 | Step 5712 |  Avg Test Loss: 1.5259 | Test ROC-AUC: 0.8459
DEBUG - 07/09/25 17:55:19 - 0:46:08 - Epoch 136
INFO - 07/09/25 17:55:39 - 0:46:28 - Epoch 137/200 | Step 5754 |  Avg Test Loss: 1.4958 | Test ROC-AUC: 0.8447
DEBUG - 07/09/25 17:55:39 - 0:46:28 - Epoch 137
INFO - 07/09/25 17:56:00 - 0:46:49 - Epoch 138/200 | Step 5796 |  Avg Test Loss: 1.4833 | Test ROC-AUC: 0.8598
DEBUG - 07/09/25 17:56:00 - 0:46:49 - Epoch 138
INFO - 07/09/25 17:56:21 - 0:47:10 - Epoch 139/200 | Step 5838 |  Avg Test Loss: 1.5056 | Test ROC-AUC: 0.8642
DEBUG - 07/09/25 17:56:21 - 0:47:10 - Epoch 139
INFO - 07/09/25 17:56:41 - 0:47:30 - Epoch 140/200 | Step 5880 |  Avg Test Loss: 1.4882 | Test ROC-AUC: 0.8383
DEBUG - 07/09/25 17:56:42 - 0:47:31 - Epoch 140
INFO - 07/09/25 17:57:02 - 0:47:51 - Epoch 141/200 | Step 5922 |  Avg Test Loss: 1.4633 | Test ROC-AUC: 0.8659
DEBUG - 07/09/25 17:57:02 - 0:47:51 - Epoch 141
INFO - 07/09/25 17:57:23 - 0:48:12 - Epoch 142/200 | Step 5964 |  Avg Test Loss: 1.4868 | Test ROC-AUC: 0.8618
DEBUG - 07/09/25 17:57:23 - 0:48:12 - Epoch 142
INFO - 07/09/25 17:57:43 - 0:48:32 - Epoch 143/200 | Step 6006 |  Avg Test Loss: 1.5438 | Test ROC-AUC: 0.8418
DEBUG - 07/09/25 17:57:44 - 0:48:33 - Epoch 143
INFO - 07/09/25 17:58:04 - 0:48:53 - Epoch 144/200 | Step 6048 |  Avg Test Loss: 1.4818 | Test ROC-AUC: 0.8654
DEBUG - 07/09/25 17:58:04 - 0:48:53 - Epoch 144
INFO - 07/09/25 17:58:25 - 0:49:14 - Epoch 145/200 | Step 6090 |  Avg Test Loss: 1.4888 | Test ROC-AUC: 0.8552
DEBUG - 07/09/25 17:58:25 - 0:49:14 - Epoch 145
INFO - 07/09/25 17:58:46 - 0:49:35 - Epoch 146/200 | Step 6132 |  Avg Test Loss: 1.4841 | Test ROC-AUC: 0.8540
DEBUG - 07/09/25 17:58:46 - 0:49:35 - Epoch 146
INFO - 07/09/25 17:59:06 - 0:49:55 - Epoch 147/200 | Step 6174 |  Avg Test Loss: 1.4921 | Test ROC-AUC: 0.8520
DEBUG - 07/09/25 17:59:06 - 0:49:55 - Epoch 147
INFO - 07/09/25 17:59:27 - 0:50:16 - Epoch 148/200 | Step 6216 |  Avg Test Loss: 1.4945 | Test ROC-AUC: 0.8501
DEBUG - 07/09/25 17:59:27 - 0:50:16 - Epoch 148
INFO - 07/09/25 17:59:47 - 0:50:36 - Epoch 149/200 | Step 6258 |  Avg Test Loss: 1.5118 | Test ROC-AUC: 0.8493
DEBUG - 07/09/25 17:59:47 - 0:50:36 - Epoch 149
INFO - 07/09/25 18:00:07 - 0:50:56 - Epoch 150/200 | Step 6300 |  Avg Test Loss: 1.4915 | Test ROC-AUC: 0.8523
DEBUG - 07/09/25 18:00:07 - 0:50:56 - Epoch 150
INFO - 07/09/25 18:00:27 - 0:51:16 - Epoch 151/200 | Step 6342 |  Avg Test Loss: 1.4824 | Test ROC-AUC: 0.8486
DEBUG - 07/09/25 18:00:27 - 0:51:16 - Epoch 151
INFO - 07/09/25 18:00:48 - 0:51:37 - Epoch 152/200 | Step 6384 |  Avg Test Loss: 1.5509 | Test ROC-AUC: 0.8462
DEBUG - 07/09/25 18:00:48 - 0:51:37 - Epoch 152
INFO - 07/09/25 18:01:09 - 0:51:58 - Epoch 153/200 | Step 6426 |  Avg Test Loss: 1.5093 | Test ROC-AUC: 0.8459
DEBUG - 07/09/25 18:01:09 - 0:51:58 - Epoch 153
INFO - 07/09/25 18:01:29 - 0:52:18 - Epoch 154/200 | Step 6468 |  Avg Test Loss: 1.4729 | Test ROC-AUC: 0.8586
DEBUG - 07/09/25 18:01:29 - 0:52:18 - Epoch 154
INFO - 07/09/25 18:01:49 - 0:52:38 - Epoch 155/200 | Step 6510 |  Avg Test Loss: 1.4896 | Test ROC-AUC: 0.8613
DEBUG - 07/09/25 18:01:49 - 0:52:38 - Epoch 155
INFO - 07/09/25 18:02:10 - 0:52:59 - Epoch 156/200 | Step 6552 |  Avg Test Loss: 1.5089 | Test ROC-AUC: 0.8557
DEBUG - 07/09/25 18:02:10 - 0:52:59 - Epoch 156
INFO - 07/09/25 18:02:30 - 0:53:19 - Epoch 157/200 | Step 6594 |  Avg Test Loss: 1.5023 | Test ROC-AUC: 0.8579
DEBUG - 07/09/25 18:02:31 - 0:53:20 - Epoch 157
INFO - 07/09/25 18:02:51 - 0:53:40 - Epoch 158/200 | Step 6636 |  Avg Test Loss: 1.5067 | Test ROC-AUC: 0.8449
DEBUG - 07/09/25 18:02:51 - 0:53:40 - Epoch 158
INFO - 07/09/25 18:03:11 - 0:54:00 - Epoch 159/200 | Step 6678 |  Avg Test Loss: 1.4688 | Test ROC-AUC: 0.8606
DEBUG - 07/09/25 18:03:11 - 0:54:00 - Epoch 159
INFO - 07/09/25 18:03:31 - 0:54:20 - Epoch 160/200 | Step 6720 |  Avg Test Loss: 1.5047 | Test ROC-AUC: 0.8535
DEBUG - 07/09/25 18:03:31 - 0:54:20 - Epoch 160
INFO - 07/09/25 18:03:50 - 0:54:39 - Epoch 161/200 | Step 6762 |  Avg Test Loss: 1.4753 | Test ROC-AUC: 0.8740
DEBUG - 07/09/25 18:03:50 - 0:54:39 - Epoch 161
INFO - 07/09/25 18:04:09 - 0:54:58 - Epoch 162/200 | Step 6804 |  Avg Test Loss: 1.5020 | Test ROC-AUC: 0.8498
DEBUG - 07/09/25 18:04:09 - 0:54:58 - Epoch 162
INFO - 07/09/25 18:04:28 - 0:55:17 - Epoch 163/200 | Step 6846 |  Avg Test Loss: 1.4816 | Test ROC-AUC: 0.8537
DEBUG - 07/09/25 18:04:29 - 0:55:18 - Epoch 163
INFO - 07/09/25 18:04:47 - 0:55:36 - Epoch 164/200 | Step 6888 |  Avg Test Loss: 1.5621 | Test ROC-AUC: 0.8442
DEBUG - 07/09/25 18:04:48 - 0:55:37 - Epoch 164
INFO - 07/09/25 18:05:07 - 0:55:56 - Epoch 165/200 | Step 6930 |  Avg Test Loss: 1.4724 | Test ROC-AUC: 0.8662
DEBUG - 07/09/25 18:05:07 - 0:55:56 - Epoch 165
INFO - 07/09/25 18:05:26 - 0:56:15 - Epoch 166/200 | Step 6972 |  Avg Test Loss: 1.4758 | Test ROC-AUC: 0.8518
DEBUG - 07/09/25 18:05:26 - 0:56:15 - Epoch 166
INFO - 07/09/25 18:05:45 - 0:56:34 - Epoch 167/200 | Step 7014 |  Avg Test Loss: 1.5193 | Test ROC-AUC: 0.8471
DEBUG - 07/09/25 18:05:45 - 0:56:34 - Epoch 167
INFO - 07/09/25 18:06:04 - 0:56:53 - Epoch 168/200 | Step 7056 |  Avg Test Loss: 1.4684 | Test ROC-AUC: 0.8581
DEBUG - 07/09/25 18:06:04 - 0:56:53 - Epoch 168
INFO - 07/09/25 18:06:23 - 0:57:12 - Epoch 169/200 | Step 7098 |  Avg Test Loss: 1.4929 | Test ROC-AUC: 0.8554
DEBUG - 07/09/25 18:06:23 - 0:57:12 - Epoch 169
INFO - 07/09/25 18:06:42 - 0:57:31 - Epoch 170/200 | Step 7140 |  Avg Test Loss: 1.5701 | Test ROC-AUC: 0.8422
DEBUG - 07/09/25 18:06:42 - 0:57:31 - Epoch 170
INFO - 07/09/25 18:07:02 - 0:57:51 - Epoch 171/200 | Step 7182 |  Avg Test Loss: 1.4817 | Test ROC-AUC: 0.8581
DEBUG - 07/09/25 18:07:02 - 0:57:51 - Epoch 171
INFO - 07/09/25 18:07:21 - 0:58:10 - Epoch 172/200 | Step 7224 |  Avg Test Loss: 1.4865 | Test ROC-AUC: 0.8611
DEBUG - 07/09/25 18:07:21 - 0:58:10 - Epoch 172
INFO - 07/09/25 18:07:40 - 0:58:29 - Epoch 173/200 | Step 7266 |  Avg Test Loss: 1.5066 | Test ROC-AUC: 0.8542
DEBUG - 07/09/25 18:07:40 - 0:58:29 - Epoch 173
INFO - 07/09/25 18:07:59 - 0:58:48 - Epoch 174/200 | Step 7308 |  Avg Test Loss: 1.5252 | Test ROC-AUC: 0.8513
DEBUG - 07/09/25 18:07:59 - 0:58:48 - Epoch 174
INFO - 07/09/25 18:08:19 - 0:59:08 - Epoch 175/200 | Step 7350 |  Avg Test Loss: 1.4642 | Test ROC-AUC: 0.8591
DEBUG - 07/09/25 18:08:19 - 0:59:08 - Epoch 175
INFO - 07/09/25 18:08:38 - 0:59:27 - Epoch 176/200 | Step 7392 |  Avg Test Loss: 1.5573 | Test ROC-AUC: 0.8452
DEBUG - 07/09/25 18:08:38 - 0:59:27 - Epoch 176
INFO - 07/09/25 18:08:57 - 0:59:46 - Epoch 177/200 | Step 7434 |  Avg Test Loss: 1.5281 | Test ROC-AUC: 0.8474
DEBUG - 07/09/25 18:08:57 - 0:59:46 - Epoch 177
INFO - 07/09/25 18:09:16 - 1:00:05 - Epoch 178/200 | Step 7476 |  Avg Test Loss: 1.4799 | Test ROC-AUC: 0.8581
DEBUG - 07/09/25 18:09:16 - 1:00:05 - Epoch 178
INFO - 07/09/25 18:09:36 - 1:00:25 - Epoch 179/200 | Step 7518 |  Avg Test Loss: 1.5023 | Test ROC-AUC: 0.8574
DEBUG - 07/09/25 18:09:36 - 1:00:25 - Epoch 179
INFO - 07/09/25 18:09:55 - 1:00:44 - Epoch 180/200 | Step 7560 |  Avg Test Loss: 1.5042 | Test ROC-AUC: 0.8545
DEBUG - 07/09/25 18:09:55 - 1:00:44 - Epoch 180
INFO - 07/09/25 18:10:15 - 1:01:04 - Epoch 181/200 | Step 7602 |  Avg Test Loss: 1.4903 | Test ROC-AUC: 0.8552
DEBUG - 07/09/25 18:10:15 - 1:01:04 - Epoch 181
INFO - 07/09/25 18:10:36 - 1:01:25 - Epoch 182/200 | Step 7644 |  Avg Test Loss: 1.4948 | Test ROC-AUC: 0.8537
DEBUG - 07/09/25 18:10:36 - 1:01:25 - Epoch 182
INFO - 07/09/25 18:10:56 - 1:01:45 - Epoch 183/200 | Step 7686 |  Avg Test Loss: 1.5001 | Test ROC-AUC: 0.8466
DEBUG - 07/09/25 18:10:56 - 1:01:45 - Epoch 183
INFO - 07/09/25 18:11:16 - 1:02:05 - Epoch 184/200 | Step 7728 |  Avg Test Loss: 1.5244 | Test ROC-AUC: 0.8527
DEBUG - 07/09/25 18:11:17 - 1:02:06 - Epoch 184
INFO - 07/09/25 18:11:37 - 1:02:26 - Epoch 185/200 | Step 7770 |  Avg Test Loss: 1.5288 | Test ROC-AUC: 0.8481
DEBUG - 07/09/25 18:11:37 - 1:02:26 - Epoch 185
INFO - 07/09/25 18:11:58 - 1:02:47 - Epoch 186/200 | Step 7812 |  Avg Test Loss: 1.4898 | Test ROC-AUC: 0.8574
DEBUG - 07/09/25 18:11:58 - 1:02:47 - Epoch 186
INFO - 07/09/25 18:12:18 - 1:03:07 - Epoch 187/200 | Step 7854 |  Avg Test Loss: 1.4856 | Test ROC-AUC: 0.8601
DEBUG - 07/09/25 18:12:18 - 1:03:07 - Epoch 187
INFO - 07/09/25 18:12:38 - 1:03:27 - Epoch 188/200 | Step 7896 |  Avg Test Loss: 1.4374 | Test ROC-AUC: 0.8716
DEBUG - 07/09/25 18:12:38 - 1:03:27 - Epoch 188
INFO - 07/09/25 18:12:59 - 1:03:48 - Epoch 189/200 | Step 7938 |  Avg Test Loss: 1.5211 | Test ROC-AUC: 0.8540
DEBUG - 07/09/25 18:12:59 - 1:03:48 - Epoch 189
INFO - 07/09/25 18:13:18 - 1:04:07 - Epoch 190/200 | Step 7980 |  Avg Test Loss: 1.5151 | Test ROC-AUC: 0.8510
DEBUG - 07/09/25 18:13:18 - 1:04:07 - Epoch 190
INFO - 07/09/25 18:13:38 - 1:04:27 - Epoch 191/200 | Step 8022 |  Avg Test Loss: 1.4945 | Test ROC-AUC: 0.8520
DEBUG - 07/09/25 18:13:38 - 1:04:27 - Epoch 191
INFO - 07/09/25 18:13:57 - 1:04:46 - Epoch 192/200 | Step 8064 |  Avg Test Loss: 1.5306 | Test ROC-AUC: 0.8427
DEBUG - 07/09/25 18:13:57 - 1:04:46 - Epoch 192
INFO - 07/09/25 18:14:16 - 1:05:05 - Epoch 193/200 | Step 8106 |  Avg Test Loss: 1.5464 | Test ROC-AUC: 0.8410
DEBUG - 07/09/25 18:14:16 - 1:05:05 - Epoch 193
INFO - 07/09/25 18:14:37 - 1:05:26 - Epoch 194/200 | Step 8148 |  Avg Test Loss: 1.5301 | Test ROC-AUC: 0.8442
DEBUG - 07/09/25 18:14:37 - 1:05:26 - Epoch 194
INFO - 07/09/25 18:14:57 - 1:05:46 - Epoch 195/200 | Step 8190 |  Avg Test Loss: 1.5433 | Test ROC-AUC: 0.8408
DEBUG - 07/09/25 18:14:57 - 1:05:46 - Epoch 195
INFO - 07/09/25 18:15:17 - 1:06:06 - Epoch 196/200 | Step 8232 |  Avg Test Loss: 1.4667 | Test ROC-AUC: 0.8549
DEBUG - 07/09/25 18:15:18 - 1:06:07 - Epoch 196
INFO - 07/09/25 18:15:38 - 1:06:27 - Epoch 197/200 | Step 8274 |  Avg Test Loss: 1.5144 | Test ROC-AUC: 0.8449
DEBUG - 07/09/25 18:15:38 - 1:06:27 - Epoch 197
INFO - 07/09/25 18:15:58 - 1:06:47 - Epoch 198/200 | Step 8316 |  Avg Test Loss: 1.4964 | Test ROC-AUC: 0.8554
DEBUG - 07/09/25 18:15:58 - 1:06:47 - Epoch 198
INFO - 07/09/25 18:16:18 - 1:07:07 - Epoch 199/200 | Step 8358 |  Avg Test Loss: 1.5618 | Test ROC-AUC: 0.8464
DEBUG - 07/09/25 18:16:19 - 1:07:08 - Epoch 199
INFO - 07/09/25 18:16:39 - 1:07:28 - Epoch 200/200 | Step 8400 |  Avg Test Loss: 1.5119 | Test ROC-AUC: 0.8564
INFO - 07/09/25 19:02:11 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 19:02:11 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: None
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: scaffold_balanced
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: None
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     warmup_epochs: 2.0
INFO - 07/09/25 19:02:11 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 19:02:11 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 19:02:11 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 19:02:11 - 0:00:00 - Loading data
DEBUG - 07/09/25 19:02:11 - 0:00:01 - Total scaffolds = 671 | train scaffolds = 558 | val scaffolds = 65 | test scaffolds = 48
DEBUG - 07/09/25 19:02:11 - 0:00:01 - Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([1])), (array([0.]), array([2])), (array([1.]), array([2])), (array([1.]), array([1])), (array([0.]), array([1])), (array([1.]), array([1])), (array([1.]), array([1]))]
INFO - 07/09/25 19:03:50 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 19:03:50 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: /home/cassie/macfrag/data/bace/bace-scaffold-0.npy
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.8, 0.1, 0.1]
                                     split_type: predetermined
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: 0
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     valid_fold_index: 1
                                     warmup_epochs: 2.0
INFO - 07/09/25 19:03:50 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 19:03:50 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 19:03:50 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 19:03:50 - 0:00:00 - Loading data
INFO - 07/09/25 19:05:06 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 19:05:06 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: /home/cassie/macfrag/data/bace/bace-scaffold-0.npy
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.9, 0.1, 0.0]
                                     split_type: predetermined
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: 0
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     valid_fold_index: 1
                                     warmup_epochs: 2.0
INFO - 07/09/25 19:05:06 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 19:05:06 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 19:05:06 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 19:05:06 - 0:00:00 - Loading data
INFO - 07/09/25 19:06:53 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 19:06:53 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: /home/cassie/macfrag/data/bace/bace-scaffold-0.npy
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.9, 0.1, 0.0]
                                     split_type: predetermined
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: 0
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     valid_fold_index: 1
                                     warmup_epochs: 2.0
INFO - 07/09/25 19:06:53 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 19:06:53 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 19:06:53 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 19:06:53 - 0:00:00 - Loading data
DEBUG - 07/09/25 19:06:53 - 0:00:00 - Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.4677686]), array([1210])), (array([0.48344371]), array([151])), (array([0.34210526]), array([152]))]
INFO - 07/09/25 19:07:55 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 19:07:55 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: /home/cassie/macfrag/data/bace/bace-scaffold-0.npy
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.9, 0.1, 0.0]
                                     split_type: predetermined
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: 0
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     valid_fold_index: 1
                                     warmup_epochs: 2.0
INFO - 07/09/25 19:07:55 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 19:07:55 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 19:07:55 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 19:07:55 - 0:00:00 - Loading data
DEBUG - 07/09/25 19:07:55 - 0:00:00 - Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.4677686]), array([1210])), (array([0.48344371]), array([151])), (array([0.34210526]), array([152]))]
DEBUG - 07/09/25 19:07:55 - 0:00:00 - Total size = 1513
DEBUG - 07/09/25 19:07:55 - 0:00:00 - Building model 0
DEBUG - 07/09/25 19:07:57 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 19:07:57 - 0:00:02 - Number of M1 parameters = 4,254,754
DEBUG - 07/09/25 19:07:57 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 19:07:57 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 19:07:57 - 0:00:02 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 19:07:57 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 19:07:57 - 0:00:02 - Epoch 0
INFO - 07/09/25 19:08:17 - 0:00:22 - Epoch 1/200 | Step 37 |  Avg Test Loss: 31.0433 | Test ROC-AUC: 0.7495
DEBUG - 07/09/25 19:08:17 - 0:00:22 - Epoch 1
INFO - 07/09/25 19:08:37 - 0:00:42 - Epoch 2/200 | Step 74 |  Avg Test Loss: 24.3488 | Test ROC-AUC: 0.6667
DEBUG - 07/09/25 19:08:38 - 0:00:42 - Epoch 2
INFO - 07/09/25 19:08:58 - 0:01:02 - Epoch 3/200 | Step 111 |  Avg Test Loss: 19.4724 | Test ROC-AUC: 0.7048
DEBUG - 07/09/25 19:08:58 - 0:01:03 - Epoch 3
INFO - 07/09/25 19:09:18 - 0:01:22 - Epoch 4/200 | Step 148 |  Avg Test Loss: 16.2955 | Test ROC-AUC: 0.7158
DEBUG - 07/09/25 19:09:18 - 0:01:23 - Epoch 4
INFO - 07/09/25 19:09:38 - 0:01:43 - Epoch 5/200 | Step 185 |  Avg Test Loss: 14.7157 | Test ROC-AUC: 0.7032
DEBUG - 07/09/25 19:09:38 - 0:01:43 - Epoch 5
INFO - 07/09/25 19:09:58 - 0:02:03 - Epoch 6/200 | Step 222 |  Avg Test Loss: 13.8289 | Test ROC-AUC: 0.7224
DEBUG - 07/09/25 19:09:58 - 0:02:03 - Epoch 6
INFO - 07/09/25 19:10:18 - 0:02:23 - Epoch 7/200 | Step 259 |  Avg Test Loss: 13.5113 | Test ROC-AUC: 0.7526
DEBUG - 07/09/25 19:10:18 - 0:02:23 - Epoch 7
INFO - 07/09/25 19:10:38 - 0:02:43 - Epoch 8/200 | Step 296 |  Avg Test Loss: 13.1632 | Test ROC-AUC: 0.7517
DEBUG - 07/09/25 19:10:38 - 0:02:43 - Epoch 8
INFO - 07/09/25 19:10:58 - 0:03:03 - Epoch 9/200 | Step 333 |  Avg Test Loss: 12.9873 | Test ROC-AUC: 0.7727
DEBUG - 07/09/25 19:10:58 - 0:03:03 - Epoch 9
INFO - 07/09/25 19:11:18 - 0:03:23 - Epoch 10/200 | Step 370 |  Avg Test Loss: 12.7637 | Test ROC-AUC: 0.7632
DEBUG - 07/09/25 19:11:18 - 0:03:23 - Epoch 10
INFO - 07/09/25 19:11:39 - 0:03:44 - Epoch 11/200 | Step 407 |  Avg Test Loss: 12.6746 | Test ROC-AUC: 0.7830
DEBUG - 07/09/25 19:11:39 - 0:03:44 - Epoch 11
INFO - 07/09/25 19:11:59 - 0:04:04 - Epoch 12/200 | Step 444 |  Avg Test Loss: 12.6168 | Test ROC-AUC: 0.8021
DEBUG - 07/09/25 19:11:59 - 0:04:04 - Epoch 12
INFO - 07/09/25 19:12:19 - 0:04:24 - Epoch 13/200 | Step 481 |  Avg Test Loss: 12.5653 | Test ROC-AUC: 0.7846
DEBUG - 07/09/25 19:12:19 - 0:04:24 - Epoch 13
INFO - 07/09/25 19:12:39 - 0:04:44 - Epoch 14/200 | Step 518 |  Avg Test Loss: 12.6429 | Test ROC-AUC: 0.7680
DEBUG - 07/09/25 19:12:39 - 0:04:44 - Epoch 14
INFO - 07/09/25 19:13:00 - 0:05:05 - Epoch 15/200 | Step 555 |  Avg Test Loss: 12.8202 | Test ROC-AUC: 0.8063
DEBUG - 07/09/25 19:13:00 - 0:05:05 - Epoch 15
INFO - 07/09/25 19:13:20 - 0:05:25 - Epoch 16/200 | Step 592 |  Avg Test Loss: 12.4275 | Test ROC-AUC: 0.7922
DEBUG - 07/09/25 19:13:20 - 0:05:25 - Epoch 16
INFO - 07/09/25 19:13:40 - 0:05:45 - Epoch 17/200 | Step 629 |  Avg Test Loss: 12.5077 | Test ROC-AUC: 0.8101
DEBUG - 07/09/25 19:13:40 - 0:05:45 - Epoch 17
INFO - 07/09/25 19:13:59 - 0:06:04 - Epoch 18/200 | Step 666 |  Avg Test Loss: 12.6558 | Test ROC-AUC: 0.7787
DEBUG - 07/09/25 19:13:59 - 0:06:04 - Epoch 18
INFO - 07/09/25 19:14:20 - 0:06:25 - Epoch 19/200 | Step 703 |  Avg Test Loss: 12.2907 | Test ROC-AUC: 0.8143
DEBUG - 07/09/25 19:14:20 - 0:06:25 - Epoch 19
INFO - 07/09/25 19:14:40 - 0:06:45 - Epoch 20/200 | Step 740 |  Avg Test Loss: 12.2376 | Test ROC-AUC: 0.8060
DEBUG - 07/09/25 19:14:40 - 0:06:45 - Epoch 20
INFO - 07/09/25 19:15:00 - 0:07:05 - Epoch 21/200 | Step 777 |  Avg Test Loss: 12.8642 | Test ROC-AUC: 0.7956
DEBUG - 07/09/25 19:15:00 - 0:07:05 - Epoch 21
INFO - 07/09/25 19:15:20 - 0:07:25 - Epoch 22/200 | Step 814 |  Avg Test Loss: 12.2433 | Test ROC-AUC: 0.8209
DEBUG - 07/09/25 19:15:20 - 0:07:25 - Epoch 22
INFO - 07/09/25 19:15:40 - 0:07:45 - Epoch 23/200 | Step 851 |  Avg Test Loss: 12.1082 | Test ROC-AUC: 0.8204
DEBUG - 07/09/25 19:15:40 - 0:07:45 - Epoch 23
INFO - 07/09/25 19:15:59 - 0:08:04 - Epoch 24/200 | Step 888 |  Avg Test Loss: 12.0976 | Test ROC-AUC: 0.8223
DEBUG - 07/09/25 19:15:59 - 0:08:04 - Epoch 24
INFO - 07/09/25 19:16:19 - 0:08:24 - Epoch 25/200 | Step 925 |  Avg Test Loss: 12.3921 | Test ROC-AUC: 0.8323
DEBUG - 07/09/25 19:16:19 - 0:08:24 - Epoch 25
INFO - 07/09/25 19:16:39 - 0:08:44 - Epoch 26/200 | Step 962 |  Avg Test Loss: 12.2182 | Test ROC-AUC: 0.8122
DEBUG - 07/09/25 19:16:39 - 0:08:44 - Epoch 26
INFO - 07/09/25 19:16:59 - 0:09:04 - Epoch 27/200 | Step 999 |  Avg Test Loss: 12.2954 | Test ROC-AUC: 0.8260
DEBUG - 07/09/25 19:16:59 - 0:09:04 - Epoch 27
INFO - 07/09/25 19:17:18 - 0:09:23 - Epoch 28/200 | Step 1036 |  Avg Test Loss: 12.0586 | Test ROC-AUC: 0.8372
DEBUG - 07/09/25 19:17:18 - 0:09:23 - Epoch 28
INFO - 07/09/25 19:17:38 - 0:09:43 - Epoch 29/200 | Step 1073 |  Avg Test Loss: 12.0779 | Test ROC-AUC: 0.8184
DEBUG - 07/09/25 19:17:38 - 0:09:43 - Epoch 29
INFO - 07/09/25 19:17:58 - 0:10:03 - Epoch 30/200 | Step 1110 |  Avg Test Loss: 11.9835 | Test ROC-AUC: 0.8229
DEBUG - 07/09/25 19:17:58 - 0:10:03 - Epoch 30
INFO - 07/09/25 19:18:18 - 0:10:23 - Epoch 31/200 | Step 1147 |  Avg Test Loss: 12.1622 | Test ROC-AUC: 0.8315
DEBUG - 07/09/25 19:18:18 - 0:10:23 - Epoch 31
INFO - 07/09/25 19:18:38 - 0:10:43 - Epoch 32/200 | Step 1184 |  Avg Test Loss: 12.6206 | Test ROC-AUC: 0.8297
DEBUG - 07/09/25 19:18:38 - 0:10:43 - Epoch 32
INFO - 07/09/25 19:18:58 - 0:11:03 - Epoch 33/200 | Step 1221 |  Avg Test Loss: 12.1266 | Test ROC-AUC: 0.8143
DEBUG - 07/09/25 19:18:58 - 0:11:03 - Epoch 33
INFO - 07/09/25 19:19:18 - 0:11:23 - Epoch 34/200 | Step 1258 |  Avg Test Loss: 12.0929 | Test ROC-AUC: 0.8418
DEBUG - 07/09/25 19:19:18 - 0:11:23 - Epoch 34
INFO - 07/09/25 19:19:38 - 0:11:43 - Epoch 35/200 | Step 1295 |  Avg Test Loss: 11.9541 | Test ROC-AUC: 0.8365
DEBUG - 07/09/25 19:19:38 - 0:11:43 - Epoch 35
INFO - 07/09/25 19:19:58 - 0:12:03 - Epoch 36/200 | Step 1332 |  Avg Test Loss: 12.0179 | Test ROC-AUC: 0.8132
DEBUG - 07/09/25 19:19:58 - 0:12:03 - Epoch 36
INFO - 07/09/25 19:20:18 - 0:12:23 - Epoch 37/200 | Step 1369 |  Avg Test Loss: 12.2580 | Test ROC-AUC: 0.8195
DEBUG - 07/09/25 19:20:18 - 0:12:23 - Epoch 37
INFO - 07/09/25 19:20:38 - 0:12:43 - Epoch 38/200 | Step 1406 |  Avg Test Loss: 12.1428 | Test ROC-AUC: 0.8385
DEBUG - 07/09/25 19:20:38 - 0:12:43 - Epoch 38
INFO - 07/09/25 19:20:58 - 0:13:02 - Epoch 39/200 | Step 1443 |  Avg Test Loss: 12.1118 | Test ROC-AUC: 0.8412
DEBUG - 07/09/25 19:20:58 - 0:13:02 - Epoch 39
INFO - 07/09/25 19:21:18 - 0:13:22 - Epoch 40/200 | Step 1480 |  Avg Test Loss: 11.7895 | Test ROC-AUC: 0.8393
DEBUG - 07/09/25 19:21:18 - 0:13:22 - Epoch 40
INFO - 07/09/25 19:21:37 - 0:13:42 - Epoch 41/200 | Step 1517 |  Avg Test Loss: 12.3148 | Test ROC-AUC: 0.8209
DEBUG - 07/09/25 19:21:37 - 0:13:42 - Epoch 41
INFO - 07/09/25 19:21:58 - 0:14:03 - Epoch 42/200 | Step 1554 |  Avg Test Loss: 11.8178 | Test ROC-AUC: 0.8445
DEBUG - 07/09/25 19:21:58 - 0:14:03 - Epoch 42
INFO - 07/09/25 19:22:19 - 0:14:23 - Epoch 43/200 | Step 1591 |  Avg Test Loss: 11.8446 | Test ROC-AUC: 0.8476
DEBUG - 07/09/25 19:22:19 - 0:14:23 - Epoch 43
INFO - 07/09/25 19:22:38 - 0:14:43 - Epoch 44/200 | Step 1628 |  Avg Test Loss: 11.7202 | Test ROC-AUC: 0.8416
DEBUG - 07/09/25 19:22:38 - 0:14:43 - Epoch 44
INFO - 07/09/25 19:22:57 - 0:15:02 - Epoch 45/200 | Step 1665 |  Avg Test Loss: 11.9213 | Test ROC-AUC: 0.8496
DEBUG - 07/09/25 19:22:57 - 0:15:02 - Epoch 45
INFO - 07/09/25 19:23:16 - 0:15:21 - Epoch 46/200 | Step 1702 |  Avg Test Loss: 11.6145 | Test ROC-AUC: 0.8567
DEBUG - 07/09/25 19:23:16 - 0:15:21 - Epoch 46
INFO - 07/09/25 19:23:36 - 0:15:41 - Epoch 47/200 | Step 1739 |  Avg Test Loss: 11.8883 | Test ROC-AUC: 0.8462
DEBUG - 07/09/25 19:23:36 - 0:15:41 - Epoch 47
INFO - 07/09/25 19:23:56 - 0:16:01 - Epoch 48/200 | Step 1776 |  Avg Test Loss: 11.7614 | Test ROC-AUC: 0.8391
DEBUG - 07/09/25 19:23:56 - 0:16:01 - Epoch 48
INFO - 07/09/25 19:24:16 - 0:16:21 - Epoch 49/200 | Step 1813 |  Avg Test Loss: 12.2856 | Test ROC-AUC: 0.8334
DEBUG - 07/09/25 19:24:16 - 0:16:21 - Epoch 49
INFO - 07/09/25 19:24:36 - 0:16:41 - Epoch 50/200 | Step 1850 |  Avg Test Loss: 12.2353 | Test ROC-AUC: 0.8504
DEBUG - 07/09/25 19:24:36 - 0:16:41 - Epoch 50
INFO - 07/09/25 19:24:56 - 0:17:01 - Epoch 51/200 | Step 1887 |  Avg Test Loss: 11.7106 | Test ROC-AUC: 0.8440
DEBUG - 07/09/25 19:24:56 - 0:17:01 - Epoch 51
INFO - 07/09/25 19:25:16 - 0:17:20 - Epoch 52/200 | Step 1924 |  Avg Test Loss: 11.7278 | Test ROC-AUC: 0.8665
DEBUG - 07/09/25 19:25:16 - 0:17:21 - Epoch 52
INFO - 07/09/25 19:25:36 - 0:17:41 - Epoch 53/200 | Step 1961 |  Avg Test Loss: 11.8822 | Test ROC-AUC: 0.8330
DEBUG - 07/09/25 19:25:36 - 0:17:41 - Epoch 53
INFO - 07/09/25 19:25:56 - 0:18:01 - Epoch 54/200 | Step 1998 |  Avg Test Loss: 11.6995 | Test ROC-AUC: 0.8484
DEBUG - 07/09/25 19:25:56 - 0:18:01 - Epoch 54
INFO - 07/09/25 19:26:16 - 0:18:21 - Epoch 55/200 | Step 2035 |  Avg Test Loss: 11.7792 | Test ROC-AUC: 0.8372
DEBUG - 07/09/25 19:26:16 - 0:18:21 - Epoch 55
INFO - 07/09/25 19:26:35 - 0:18:40 - Epoch 56/200 | Step 2072 |  Avg Test Loss: 11.8976 | Test ROC-AUC: 0.8306
DEBUG - 07/09/25 19:26:35 - 0:18:40 - Epoch 56
INFO - 07/09/25 19:26:55 - 0:19:00 - Epoch 57/200 | Step 2109 |  Avg Test Loss: 12.2620 | Test ROC-AUC: 0.8243
DEBUG - 07/09/25 19:26:55 - 0:19:00 - Epoch 57
INFO - 07/09/25 19:27:16 - 0:19:21 - Epoch 58/200 | Step 2146 |  Avg Test Loss: 11.6386 | Test ROC-AUC: 0.8528
DEBUG - 07/09/25 19:27:16 - 0:19:21 - Epoch 58
INFO - 07/09/25 19:27:36 - 0:19:41 - Epoch 59/200 | Step 2183 |  Avg Test Loss: 12.2599 | Test ROC-AUC: 0.8474
DEBUG - 07/09/25 19:27:36 - 0:19:41 - Epoch 59
INFO - 07/09/25 19:27:56 - 0:20:01 - Epoch 60/200 | Step 2220 |  Avg Test Loss: 12.5312 | Test ROC-AUC: 0.8364
DEBUG - 07/09/25 19:27:56 - 0:20:01 - Epoch 60
INFO - 07/09/25 19:28:16 - 0:20:21 - Epoch 61/200 | Step 2257 |  Avg Test Loss: 12.0519 | Test ROC-AUC: 0.8413
DEBUG - 07/09/25 19:28:16 - 0:20:21 - Epoch 61
INFO - 07/09/25 19:28:36 - 0:20:41 - Epoch 62/200 | Step 2294 |  Avg Test Loss: 11.6972 | Test ROC-AUC: 0.8531
DEBUG - 07/09/25 19:28:36 - 0:20:41 - Epoch 62
INFO - 07/09/25 19:28:56 - 0:21:01 - Epoch 63/200 | Step 2331 |  Avg Test Loss: 11.6769 | Test ROC-AUC: 0.8474
DEBUG - 07/09/25 19:28:56 - 0:21:01 - Epoch 63
INFO - 07/09/25 19:29:16 - 0:21:21 - Epoch 64/200 | Step 2368 |  Avg Test Loss: 11.9212 | Test ROC-AUC: 0.8387
DEBUG - 07/09/25 19:29:16 - 0:21:21 - Epoch 64
INFO - 07/09/25 19:29:36 - 0:21:41 - Epoch 65/200 | Step 2405 |  Avg Test Loss: 12.1123 | Test ROC-AUC: 0.8183
DEBUG - 07/09/25 19:29:36 - 0:21:41 - Epoch 65
INFO - 07/09/25 19:29:57 - 0:22:02 - Epoch 66/200 | Step 2442 |  Avg Test Loss: 11.8842 | Test ROC-AUC: 0.8401
DEBUG - 07/09/25 19:29:57 - 0:22:02 - Epoch 66
INFO - 07/09/25 19:30:16 - 0:22:21 - Epoch 67/200 | Step 2479 |  Avg Test Loss: 12.4145 | Test ROC-AUC: 0.8123
DEBUG - 07/09/25 19:30:16 - 0:22:21 - Epoch 67
INFO - 07/09/25 19:30:36 - 0:22:41 - Epoch 68/200 | Step 2516 |  Avg Test Loss: 11.5813 | Test ROC-AUC: 0.8533
DEBUG - 07/09/25 19:30:36 - 0:22:41 - Epoch 68
INFO - 07/09/25 19:30:56 - 0:23:01 - Epoch 69/200 | Step 2553 |  Avg Test Loss: 11.6956 | Test ROC-AUC: 0.8405
DEBUG - 07/09/25 19:30:56 - 0:23:01 - Epoch 69
INFO - 07/09/25 19:31:16 - 0:23:21 - Epoch 70/200 | Step 2590 |  Avg Test Loss: 11.8627 | Test ROC-AUC: 0.8471
DEBUG - 07/09/25 19:31:16 - 0:23:21 - Epoch 70
INFO - 07/09/25 19:31:36 - 0:23:41 - Epoch 71/200 | Step 2627 |  Avg Test Loss: 12.0580 | Test ROC-AUC: 0.8192
DEBUG - 07/09/25 19:31:36 - 0:23:41 - Epoch 71
INFO - 07/09/25 19:31:55 - 0:24:00 - Epoch 72/200 | Step 2664 |  Avg Test Loss: 11.8006 | Test ROC-AUC: 0.8447
DEBUG - 07/09/25 19:31:55 - 0:24:00 - Epoch 72
INFO - 07/09/25 19:32:15 - 0:24:20 - Epoch 73/200 | Step 2701 |  Avg Test Loss: 11.8501 | Test ROC-AUC: 0.8304
DEBUG - 07/09/25 19:32:15 - 0:24:20 - Epoch 73
INFO - 07/09/25 19:32:34 - 0:24:39 - Epoch 74/200 | Step 2738 |  Avg Test Loss: 11.8368 | Test ROC-AUC: 0.8333
DEBUG - 07/09/25 19:32:34 - 0:24:39 - Epoch 74
INFO - 07/09/25 19:32:54 - 0:24:59 - Epoch 75/200 | Step 2775 |  Avg Test Loss: 12.2033 | Test ROC-AUC: 0.8192
DEBUG - 07/09/25 19:32:54 - 0:24:59 - Epoch 75
INFO - 07/09/25 19:33:13 - 0:25:18 - Epoch 76/200 | Step 2812 |  Avg Test Loss: 11.8318 | Test ROC-AUC: 0.8279
DEBUG - 07/09/25 19:33:13 - 0:25:18 - Epoch 76
INFO - 07/09/25 19:33:33 - 0:25:38 - Epoch 77/200 | Step 2849 |  Avg Test Loss: 12.4760 | Test ROC-AUC: 0.8258
DEBUG - 07/09/25 19:33:33 - 0:25:38 - Epoch 77
INFO - 07/09/25 19:33:53 - 0:25:58 - Epoch 78/200 | Step 2886 |  Avg Test Loss: 11.8878 | Test ROC-AUC: 0.8238
DEBUG - 07/09/25 19:33:53 - 0:25:58 - Epoch 78
INFO - 07/09/25 19:34:13 - 0:26:18 - Epoch 79/200 | Step 2923 |  Avg Test Loss: 11.9053 | Test ROC-AUC: 0.8359
DEBUG - 07/09/25 19:34:13 - 0:26:18 - Epoch 79
INFO - 07/09/25 19:34:32 - 0:26:37 - Epoch 80/200 | Step 2960 |  Avg Test Loss: 12.0961 | Test ROC-AUC: 0.8381
DEBUG - 07/09/25 19:34:32 - 0:26:37 - Epoch 80
INFO - 07/09/25 19:34:52 - 0:26:57 - Epoch 81/200 | Step 2997 |  Avg Test Loss: 12.1191 | Test ROC-AUC: 0.8376
DEBUG - 07/09/25 19:34:52 - 0:26:57 - Epoch 81
INFO - 07/09/25 19:35:11 - 0:27:16 - Epoch 82/200 | Step 3034 |  Avg Test Loss: 11.8480 | Test ROC-AUC: 0.8166
DEBUG - 07/09/25 19:35:11 - 0:27:16 - Epoch 82
INFO - 07/09/25 19:35:30 - 0:27:35 - Epoch 83/200 | Step 3071 |  Avg Test Loss: 11.9074 | Test ROC-AUC: 0.8386
DEBUG - 07/09/25 19:35:30 - 0:27:35 - Epoch 83
INFO - 07/09/25 19:35:49 - 0:27:53 - Epoch 84/200 | Step 3108 |  Avg Test Loss: 11.8173 | Test ROC-AUC: 0.8399
DEBUG - 07/09/25 19:35:49 - 0:27:54 - Epoch 84
INFO - 07/09/25 19:36:07 - 0:28:12 - Epoch 85/200 | Step 3145 |  Avg Test Loss: 12.1299 | Test ROC-AUC: 0.8195
DEBUG - 07/09/25 19:36:07 - 0:28:12 - Epoch 85
INFO - 07/09/25 19:36:25 - 0:28:30 - Epoch 86/200 | Step 3182 |  Avg Test Loss: 11.6583 | Test ROC-AUC: 0.8495
DEBUG - 07/09/25 19:36:25 - 0:28:30 - Epoch 86
INFO - 07/09/25 19:38:41 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 19:38:41 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 200
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: /home/cassie/macfrag/data/bace/bace-scaffold-0.npy
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.9, 0.1, 0.0]
                                     split_type: predetermined
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: 0
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     valid_fold_index: 1
                                     warmup_epochs: 2.0
INFO - 07/09/25 19:38:41 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 19:38:41 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 19:38:41 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 19:38:41 - 0:00:00 - Loading data
DEBUG - 07/09/25 19:38:41 - 0:00:00 - Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.4677686]), array([1210])), (array([0.48344371]), array([151])), (array([0.34210526]), array([152]))]
DEBUG - 07/09/25 19:38:41 - 0:00:00 - Total size = 1513
DEBUG - 07/09/25 19:38:41 - 0:00:00 - Building model 0
DEBUG - 07/09/25 19:38:42 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 19:38:42 - 0:00:02 - Number of M1 parameters = 4,254,754
DEBUG - 07/09/25 19:38:42 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 19:38:42 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 19:38:42 - 0:00:02 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 19:38:42 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 19:38:42 - 0:00:02 - Epoch 0
INFO - 07/09/25 19:39:04 - 0:00:23 - Epoch 1/200 | Step 37 |  Avg Test Loss: 20.0893 | Test ROC-AUC: 0.7252
DEBUG - 07/09/25 19:39:04 - 0:00:23 - Epoch 1
INFO - 07/09/25 19:39:24 - 0:00:43 - Epoch 2/200 | Step 74 |  Avg Test Loss: 15.0279 | Test ROC-AUC: 0.6936
DEBUG - 07/09/25 19:39:24 - 0:00:43 - Epoch 2
INFO - 07/09/25 19:39:41 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 19:39:41 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 100
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: /home/cassie/macfrag/data/bace/bace-scaffold-0.npy
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.9, 0.1, 0.0]
                                     split_type: predetermined
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: 0
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     valid_fold_index: 1
                                     warmup_epochs: 2.0
INFO - 07/09/25 19:39:41 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 19:39:41 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 19:39:41 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 19:39:41 - 0:00:00 - Loading data
DEBUG - 07/09/25 19:39:41 - 0:00:00 - Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.4677686]), array([1210])), (array([0.48344371]), array([151])), (array([0.34210526]), array([152]))]
DEBUG - 07/09/25 19:39:41 - 0:00:00 - Total size = 1513
DEBUG - 07/09/25 19:39:41 - 0:00:00 - Building model 0
DEBUG - 07/09/25 19:39:43 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 19:39:43 - 0:00:02 - Number of M1 parameters = 4,254,754
DEBUG - 07/09/25 19:39:43 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 19:39:43 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 19:39:43 - 0:00:02 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 19:39:43 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 19:39:43 - 0:00:02 - Epoch 0
INFO - 07/09/25 19:40:04 - 0:00:23 - Epoch 1/100 | Step 37 |  Avg Test Loss: 20.0922 | Test ROC-AUC: 0.7262
DEBUG - 07/09/25 19:40:04 - 0:00:23 - Epoch 1
INFO - 07/09/25 19:40:24 - 0:00:43 - Epoch 2/100 | Step 74 |  Avg Test Loss: 15.0282 | Test ROC-AUC: 0.6927
DEBUG - 07/09/25 19:40:24 - 0:00:43 - Epoch 2
INFO - 07/09/25 19:40:44 - 0:01:03 - Epoch 3/100 | Step 111 |  Avg Test Loss: 13.7765 | Test ROC-AUC: 0.6699
DEBUG - 07/09/25 19:40:44 - 0:01:03 - Epoch 3
INFO - 07/09/25 19:41:03 - 0:01:22 - Epoch 4/100 | Step 148 |  Avg Test Loss: 13.0700 | Test ROC-AUC: 0.7030
DEBUG - 07/09/25 19:41:03 - 0:01:22 - Epoch 4
INFO - 07/09/25 19:41:23 - 0:01:42 - Epoch 5/100 | Step 185 |  Avg Test Loss: 12.5716 | Test ROC-AUC: 0.7155
DEBUG - 07/09/25 19:41:23 - 0:01:42 - Epoch 5
INFO - 07/09/25 19:41:43 - 0:02:02 - Epoch 6/100 | Step 222 |  Avg Test Loss: 12.0928 | Test ROC-AUC: 0.7313
DEBUG - 07/09/25 19:41:43 - 0:02:02 - Epoch 6
INFO - 07/09/25 19:42:03 - 0:02:22 - Epoch 7/100 | Step 259 |  Avg Test Loss: 11.6259 | Test ROC-AUC: 0.7278
DEBUG - 07/09/25 19:42:03 - 0:02:22 - Epoch 7
INFO - 07/09/25 19:42:22 - 0:02:41 - Epoch 8/100 | Step 296 |  Avg Test Loss: 11.2982 | Test ROC-AUC: 0.7222
DEBUG - 07/09/25 19:42:22 - 0:02:41 - Epoch 8
INFO - 07/09/25 19:42:42 - 0:03:01 - Epoch 9/100 | Step 333 |  Avg Test Loss: 10.8836 | Test ROC-AUC: 0.7479
DEBUG - 07/09/25 19:42:42 - 0:03:01 - Epoch 9
INFO - 07/09/25 19:43:02 - 0:03:21 - Epoch 10/100 | Step 370 |  Avg Test Loss: 10.1228 | Test ROC-AUC: 0.7632
DEBUG - 07/09/25 19:43:03 - 0:03:22 - Epoch 10
INFO - 07/09/25 19:43:22 - 0:03:41 - Epoch 11/100 | Step 407 |  Avg Test Loss: 9.9646 | Test ROC-AUC: 0.7653
DEBUG - 07/09/25 19:43:22 - 0:03:41 - Epoch 11
INFO - 07/09/25 19:43:42 - 0:04:01 - Epoch 12/100 | Step 444 |  Avg Test Loss: 9.5170 | Test ROC-AUC: 0.7729
DEBUG - 07/09/25 19:43:42 - 0:04:01 - Epoch 12
INFO - 07/09/25 19:44:02 - 0:04:21 - Epoch 13/100 | Step 481 |  Avg Test Loss: 8.7477 | Test ROC-AUC: 0.7642
DEBUG - 07/09/25 19:44:02 - 0:04:21 - Epoch 13
INFO - 07/09/25 19:44:22 - 0:04:41 - Epoch 14/100 | Step 518 |  Avg Test Loss: 8.1067 | Test ROC-AUC: 0.7714
DEBUG - 07/09/25 19:44:22 - 0:04:41 - Epoch 14
INFO - 07/09/25 19:44:42 - 0:05:01 - Epoch 15/100 | Step 555 |  Avg Test Loss: 8.0895 | Test ROC-AUC: 0.7732
DEBUG - 07/09/25 19:44:42 - 0:05:01 - Epoch 15
INFO - 07/09/25 19:45:02 - 0:05:21 - Epoch 16/100 | Step 592 |  Avg Test Loss: 7.5083 | Test ROC-AUC: 0.7656
DEBUG - 07/09/25 19:45:02 - 0:05:21 - Epoch 16
INFO - 07/09/25 19:45:21 - 0:05:40 - Epoch 17/100 | Step 629 |  Avg Test Loss: 7.7070 | Test ROC-AUC: 0.7660
DEBUG - 07/09/25 19:45:21 - 0:05:40 - Epoch 17
INFO - 07/09/25 19:45:42 - 0:06:01 - Epoch 18/100 | Step 666 |  Avg Test Loss: 7.1410 | Test ROC-AUC: 0.7831
DEBUG - 07/09/25 19:45:42 - 0:06:01 - Epoch 18
INFO - 07/09/25 19:46:02 - 0:06:21 - Epoch 19/100 | Step 703 |  Avg Test Loss: 7.0386 | Test ROC-AUC: 0.7720
DEBUG - 07/09/25 19:46:02 - 0:06:21 - Epoch 19
INFO - 07/09/25 19:46:22 - 0:06:41 - Epoch 20/100 | Step 740 |  Avg Test Loss: 6.5846 | Test ROC-AUC: 0.7795
DEBUG - 07/09/25 19:46:22 - 0:06:41 - Epoch 20
INFO - 07/09/25 19:46:42 - 0:07:01 - Epoch 21/100 | Step 777 |  Avg Test Loss: 6.7523 | Test ROC-AUC: 0.7863
DEBUG - 07/09/25 19:46:42 - 0:07:01 - Epoch 21
INFO - 07/09/25 19:47:01 - 0:07:20 - Epoch 22/100 | Step 814 |  Avg Test Loss: 6.5189 | Test ROC-AUC: 0.7940
DEBUG - 07/09/25 19:47:01 - 0:07:20 - Epoch 22
INFO - 07/09/25 19:47:21 - 0:07:40 - Epoch 23/100 | Step 851 |  Avg Test Loss: 6.3280 | Test ROC-AUC: 0.7887
DEBUG - 07/09/25 19:47:21 - 0:07:40 - Epoch 23
INFO - 07/09/25 19:47:41 - 0:08:00 - Epoch 24/100 | Step 888 |  Avg Test Loss: 6.5050 | Test ROC-AUC: 0.7950
DEBUG - 07/09/25 19:47:41 - 0:08:00 - Epoch 24
INFO - 07/09/25 19:48:00 - 0:08:19 - Epoch 25/100 | Step 925 |  Avg Test Loss: 6.7532 | Test ROC-AUC: 0.8020
DEBUG - 07/09/25 19:48:00 - 0:08:19 - Epoch 25
INFO - 07/09/25 19:48:20 - 0:08:39 - Epoch 26/100 | Step 962 |  Avg Test Loss: 6.3424 | Test ROC-AUC: 0.7987
DEBUG - 07/09/25 19:48:20 - 0:08:39 - Epoch 26
INFO - 07/09/25 19:48:40 - 0:08:59 - Epoch 27/100 | Step 999 |  Avg Test Loss: 6.5582 | Test ROC-AUC: 0.8016
DEBUG - 07/09/25 19:48:40 - 0:08:59 - Epoch 27
INFO - 07/09/25 19:48:59 - 0:09:18 - Epoch 28/100 | Step 1036 |  Avg Test Loss: 6.0148 | Test ROC-AUC: 0.8088
DEBUG - 07/09/25 19:48:59 - 0:09:18 - Epoch 28
INFO - 07/09/25 19:49:19 - 0:09:38 - Epoch 29/100 | Step 1073 |  Avg Test Loss: 6.2343 | Test ROC-AUC: 0.8189
DEBUG - 07/09/25 19:49:19 - 0:09:38 - Epoch 29
INFO - 07/09/25 19:49:39 - 0:09:58 - Epoch 30/100 | Step 1110 |  Avg Test Loss: 6.1514 | Test ROC-AUC: 0.8160
DEBUG - 07/09/25 19:49:39 - 0:09:58 - Epoch 30
INFO - 07/09/25 19:49:58 - 0:10:17 - Epoch 31/100 | Step 1147 |  Avg Test Loss: 5.7422 | Test ROC-AUC: 0.8227
DEBUG - 07/09/25 19:49:58 - 0:10:17 - Epoch 31
INFO - 07/09/25 19:50:18 - 0:10:37 - Epoch 32/100 | Step 1184 |  Avg Test Loss: 6.1144 | Test ROC-AUC: 0.8324
DEBUG - 07/09/25 19:50:18 - 0:10:37 - Epoch 32
INFO - 07/09/25 19:50:38 - 0:10:57 - Epoch 33/100 | Step 1221 |  Avg Test Loss: 5.9191 | Test ROC-AUC: 0.8316
DEBUG - 07/09/25 19:50:38 - 0:10:57 - Epoch 33
INFO - 07/09/25 19:50:58 - 0:11:17 - Epoch 34/100 | Step 1258 |  Avg Test Loss: 6.0562 | Test ROC-AUC: 0.8298
DEBUG - 07/09/25 19:50:58 - 0:11:17 - Epoch 34
INFO - 07/09/25 19:51:18 - 0:11:37 - Epoch 35/100 | Step 1295 |  Avg Test Loss: 5.7301 | Test ROC-AUC: 0.8317
DEBUG - 07/09/25 19:51:18 - 0:11:37 - Epoch 35
INFO - 07/09/25 19:51:38 - 0:11:57 - Epoch 36/100 | Step 1332 |  Avg Test Loss: 5.7284 | Test ROC-AUC: 0.8300
DEBUG - 07/09/25 19:51:38 - 0:11:57 - Epoch 36
INFO - 07/09/25 19:51:57 - 0:12:16 - Epoch 37/100 | Step 1369 |  Avg Test Loss: 6.4523 | Test ROC-AUC: 0.8336
DEBUG - 07/09/25 19:51:57 - 0:12:16 - Epoch 37
INFO - 07/09/25 19:52:17 - 0:12:36 - Epoch 38/100 | Step 1406 |  Avg Test Loss: 6.0673 | Test ROC-AUC: 0.8443
DEBUG - 07/09/25 19:52:17 - 0:12:36 - Epoch 38
INFO - 07/09/25 19:52:37 - 0:12:56 - Epoch 39/100 | Step 1443 |  Avg Test Loss: 5.4729 | Test ROC-AUC: 0.8294
DEBUG - 07/09/25 19:52:37 - 0:12:56 - Epoch 39
INFO - 07/09/25 19:52:57 - 0:13:16 - Epoch 40/100 | Step 1480 |  Avg Test Loss: 5.6203 | Test ROC-AUC: 0.8438
DEBUG - 07/09/25 19:52:57 - 0:13:16 - Epoch 40
INFO - 07/09/25 19:53:17 - 0:13:36 - Epoch 41/100 | Step 1517 |  Avg Test Loss: 5.6171 | Test ROC-AUC: 0.8499
DEBUG - 07/09/25 19:53:17 - 0:13:36 - Epoch 41
INFO - 07/09/25 19:53:37 - 0:13:56 - Epoch 42/100 | Step 1554 |  Avg Test Loss: 5.8335 | Test ROC-AUC: 0.8477
DEBUG - 07/09/25 19:53:37 - 0:13:56 - Epoch 42
INFO - 07/09/25 19:53:57 - 0:14:16 - Epoch 43/100 | Step 1591 |  Avg Test Loss: 5.6691 | Test ROC-AUC: 0.8491
DEBUG - 07/09/25 19:53:57 - 0:14:16 - Epoch 43
INFO - 07/09/25 19:54:17 - 0:14:36 - Epoch 44/100 | Step 1628 |  Avg Test Loss: 5.7719 | Test ROC-AUC: 0.8500
DEBUG - 07/09/25 19:54:17 - 0:14:36 - Epoch 44
INFO - 07/09/25 19:54:36 - 0:14:55 - Epoch 45/100 | Step 1665 |  Avg Test Loss: 6.4175 | Test ROC-AUC: 0.8524
DEBUG - 07/09/25 19:54:37 - 0:14:56 - Epoch 45
INFO - 07/09/25 19:54:57 - 0:15:16 - Epoch 46/100 | Step 1702 |  Avg Test Loss: 5.6933 | Test ROC-AUC: 0.8439
DEBUG - 07/09/25 19:54:57 - 0:15:16 - Epoch 46
INFO - 07/09/25 19:55:16 - 0:15:35 - Epoch 47/100 | Step 1739 |  Avg Test Loss: 5.5060 | Test ROC-AUC: 0.8544
DEBUG - 07/09/25 19:55:17 - 0:15:36 - Epoch 47
INFO - 07/09/25 19:55:36 - 0:15:55 - Epoch 48/100 | Step 1776 |  Avg Test Loss: 5.2438 | Test ROC-AUC: 0.8425
DEBUG - 07/09/25 19:55:36 - 0:15:55 - Epoch 48
INFO - 07/09/25 19:55:56 - 0:16:15 - Epoch 49/100 | Step 1813 |  Avg Test Loss: 5.2756 | Test ROC-AUC: 0.8538
DEBUG - 07/09/25 19:55:56 - 0:16:15 - Epoch 49
INFO - 07/09/25 19:56:16 - 0:16:35 - Epoch 50/100 | Step 1850 |  Avg Test Loss: 6.0132 | Test ROC-AUC: 0.8554
DEBUG - 07/09/25 19:56:16 - 0:16:35 - Epoch 50
INFO - 07/09/25 19:56:36 - 0:16:55 - Epoch 51/100 | Step 1887 |  Avg Test Loss: 5.5931 | Test ROC-AUC: 0.8471
DEBUG - 07/09/25 19:56:36 - 0:16:55 - Epoch 51
INFO - 07/09/25 19:56:56 - 0:17:15 - Epoch 52/100 | Step 1924 |  Avg Test Loss: 5.1722 | Test ROC-AUC: 0.8523
DEBUG - 07/09/25 19:56:56 - 0:17:15 - Epoch 52
INFO - 07/09/25 19:57:15 - 0:17:34 - Epoch 53/100 | Step 1961 |  Avg Test Loss: 5.4268 | Test ROC-AUC: 0.8428
DEBUG - 07/09/25 19:57:15 - 0:17:34 - Epoch 53
INFO - 07/09/25 19:57:35 - 0:17:54 - Epoch 54/100 | Step 1998 |  Avg Test Loss: 5.2628 | Test ROC-AUC: 0.8549
DEBUG - 07/09/25 19:57:35 - 0:17:54 - Epoch 54
INFO - 07/09/25 19:57:55 - 0:18:14 - Epoch 55/100 | Step 2035 |  Avg Test Loss: 5.1777 | Test ROC-AUC: 0.8489
DEBUG - 07/09/25 19:57:55 - 0:18:14 - Epoch 55
INFO - 07/09/25 19:58:15 - 0:18:34 - Epoch 56/100 | Step 2072 |  Avg Test Loss: 5.1025 | Test ROC-AUC: 0.8604
DEBUG - 07/09/25 19:58:15 - 0:18:34 - Epoch 56
INFO - 07/09/25 19:58:34 - 0:18:53 - Epoch 57/100 | Step 2109 |  Avg Test Loss: 5.3538 | Test ROC-AUC: 0.8570
DEBUG - 07/09/25 19:58:34 - 0:18:53 - Epoch 57
INFO - 07/09/25 19:58:54 - 0:19:13 - Epoch 58/100 | Step 2146 |  Avg Test Loss: 5.7399 | Test ROC-AUC: 0.8701
DEBUG - 07/09/25 19:58:54 - 0:19:13 - Epoch 58
INFO - 07/09/25 19:59:14 - 0:19:33 - Epoch 59/100 | Step 2183 |  Avg Test Loss: 5.8016 | Test ROC-AUC: 0.8577
DEBUG - 07/09/25 19:59:14 - 0:19:33 - Epoch 59
INFO - 07/09/25 19:59:34 - 0:19:53 - Epoch 60/100 | Step 2220 |  Avg Test Loss: 5.5640 | Test ROC-AUC: 0.8500
DEBUG - 07/09/25 19:59:34 - 0:19:53 - Epoch 60
INFO - 07/09/25 19:59:54 - 0:20:13 - Epoch 61/100 | Step 2257 |  Avg Test Loss: 5.7690 | Test ROC-AUC: 0.8584
DEBUG - 07/09/25 19:59:54 - 0:20:13 - Epoch 61
INFO - 07/09/25 20:00:13 - 0:20:32 - Epoch 62/100 | Step 2294 |  Avg Test Loss: 5.1757 | Test ROC-AUC: 0.8602
DEBUG - 07/09/25 20:00:13 - 0:20:32 - Epoch 62
INFO - 07/09/25 20:00:33 - 0:20:52 - Epoch 63/100 | Step 2331 |  Avg Test Loss: 4.9067 | Test ROC-AUC: 0.8549
DEBUG - 07/09/25 20:00:33 - 0:20:52 - Epoch 63
INFO - 07/09/25 20:00:53 - 0:21:12 - Epoch 64/100 | Step 2368 |  Avg Test Loss: 4.9445 | Test ROC-AUC: 0.8649
DEBUG - 07/09/25 20:00:53 - 0:21:12 - Epoch 64
INFO - 07/09/25 20:01:13 - 0:21:32 - Epoch 65/100 | Step 2405 |  Avg Test Loss: 5.3076 | Test ROC-AUC: 0.8687
DEBUG - 07/09/25 20:01:13 - 0:21:32 - Epoch 65
INFO - 07/09/25 20:01:33 - 0:21:52 - Epoch 66/100 | Step 2442 |  Avg Test Loss: 5.8125 | Test ROC-AUC: 0.8643
DEBUG - 07/09/25 20:01:33 - 0:21:52 - Epoch 66
INFO - 07/09/25 20:01:53 - 0:22:12 - Epoch 67/100 | Step 2479 |  Avg Test Loss: 5.1602 | Test ROC-AUC: 0.8565
DEBUG - 07/09/25 20:01:53 - 0:22:12 - Epoch 67
INFO - 07/09/25 20:02:14 - 0:22:33 - Epoch 68/100 | Step 2516 |  Avg Test Loss: 4.9959 | Test ROC-AUC: 0.8613
DEBUG - 07/09/25 20:02:14 - 0:22:33 - Epoch 68
INFO - 07/09/25 20:02:33 - 0:22:52 - Epoch 69/100 | Step 2553 |  Avg Test Loss: 5.1305 | Test ROC-AUC: 0.8567
DEBUG - 07/09/25 20:02:33 - 0:22:52 - Epoch 69
INFO - 07/09/25 20:02:53 - 0:23:12 - Epoch 70/100 | Step 2590 |  Avg Test Loss: 4.8733 | Test ROC-AUC: 0.8717
DEBUG - 07/09/25 20:02:53 - 0:23:12 - Epoch 70
INFO - 07/09/25 20:03:14 - 0:23:33 - Epoch 71/100 | Step 2627 |  Avg Test Loss: 4.7364 | Test ROC-AUC: 0.8642
DEBUG - 07/09/25 20:03:14 - 0:23:33 - Epoch 71
INFO - 07/09/25 20:03:33 - 0:23:52 - Epoch 72/100 | Step 2664 |  Avg Test Loss: 4.8906 | Test ROC-AUC: 0.8604
DEBUG - 07/09/25 20:03:33 - 0:23:52 - Epoch 72
INFO - 07/09/25 20:03:53 - 0:24:12 - Epoch 73/100 | Step 2701 |  Avg Test Loss: 5.3038 | Test ROC-AUC: 0.8630
DEBUG - 07/09/25 20:03:54 - 0:24:13 - Epoch 73
INFO - 07/09/25 20:04:13 - 0:24:32 - Epoch 74/100 | Step 2738 |  Avg Test Loss: 4.9323 | Test ROC-AUC: 0.8708
DEBUG - 07/09/25 20:04:13 - 0:24:32 - Epoch 74
INFO - 07/09/25 20:04:33 - 0:24:52 - Epoch 75/100 | Step 2775 |  Avg Test Loss: 5.3348 | Test ROC-AUC: 0.8667
DEBUG - 07/09/25 20:04:33 - 0:24:52 - Epoch 75
INFO - 07/09/25 20:04:53 - 0:25:12 - Epoch 76/100 | Step 2812 |  Avg Test Loss: 5.9307 | Test ROC-AUC: 0.8543
DEBUG - 07/09/25 20:04:53 - 0:25:12 - Epoch 76
INFO - 07/09/25 20:05:13 - 0:25:32 - Epoch 77/100 | Step 2849 |  Avg Test Loss: 6.4901 | Test ROC-AUC: 0.8705
DEBUG - 07/09/25 20:05:13 - 0:25:32 - Epoch 77
INFO - 07/09/25 20:05:33 - 0:25:52 - Epoch 78/100 | Step 2886 |  Avg Test Loss: 5.1634 | Test ROC-AUC: 0.8705
DEBUG - 07/09/25 20:05:33 - 0:25:52 - Epoch 78
INFO - 07/09/25 20:05:53 - 0:26:12 - Epoch 79/100 | Step 2923 |  Avg Test Loss: 5.1701 | Test ROC-AUC: 0.8696
DEBUG - 07/09/25 20:05:53 - 0:26:12 - Epoch 79
INFO - 07/09/25 20:06:12 - 0:26:31 - Epoch 80/100 | Step 2960 |  Avg Test Loss: 4.9140 | Test ROC-AUC: 0.8708
DEBUG - 07/09/25 20:06:12 - 0:26:31 - Epoch 80
INFO - 07/09/25 20:06:33 - 0:26:52 - Epoch 81/100 | Step 2997 |  Avg Test Loss: 4.9648 | Test ROC-AUC: 0.8676
DEBUG - 07/09/25 20:06:33 - 0:26:52 - Epoch 81
INFO - 07/09/25 20:06:52 - 0:27:11 - Epoch 82/100 | Step 3034 |  Avg Test Loss: 4.6643 | Test ROC-AUC: 0.8613
DEBUG - 07/09/25 20:06:52 - 0:27:11 - Epoch 82
INFO - 07/09/25 20:07:12 - 0:27:31 - Epoch 83/100 | Step 3071 |  Avg Test Loss: 5.2116 | Test ROC-AUC: 0.8618
DEBUG - 07/09/25 20:07:12 - 0:27:31 - Epoch 83
INFO - 07/09/25 20:07:32 - 0:27:51 - Epoch 84/100 | Step 3108 |  Avg Test Loss: 5.0636 | Test ROC-AUC: 0.8683
DEBUG - 07/09/25 20:07:32 - 0:27:51 - Epoch 84
INFO - 07/09/25 20:07:51 - 0:28:10 - Epoch 85/100 | Step 3145 |  Avg Test Loss: 5.3656 | Test ROC-AUC: 0.8678
DEBUG - 07/09/25 20:07:51 - 0:28:10 - Epoch 85
INFO - 07/09/25 20:08:11 - 0:28:30 - Epoch 86/100 | Step 3182 |  Avg Test Loss: 5.1083 | Test ROC-AUC: 0.8618
DEBUG - 07/09/25 20:08:11 - 0:28:30 - Epoch 86
INFO - 07/09/25 20:08:31 - 0:28:50 - Epoch 87/100 | Step 3219 |  Avg Test Loss: 4.7481 | Test ROC-AUC: 0.8604
DEBUG - 07/09/25 20:08:31 - 0:28:50 - Epoch 87
INFO - 07/09/25 20:08:51 - 0:29:10 - Epoch 88/100 | Step 3256 |  Avg Test Loss: 5.0609 | Test ROC-AUC: 0.8644
DEBUG - 07/09/25 20:08:51 - 0:29:10 - Epoch 88
INFO - 07/09/25 20:09:11 - 0:29:30 - Epoch 89/100 | Step 3293 |  Avg Test Loss: 4.7774 | Test ROC-AUC: 0.8690
DEBUG - 07/09/25 20:09:11 - 0:29:30 - Epoch 89
INFO - 07/09/25 20:09:30 - 0:29:49 - Epoch 90/100 | Step 3330 |  Avg Test Loss: 4.6637 | Test ROC-AUC: 0.8674
DEBUG - 07/09/25 20:09:30 - 0:29:49 - Epoch 90
INFO - 07/09/25 20:09:50 - 0:30:09 - Epoch 91/100 | Step 3367 |  Avg Test Loss: 5.3653 | Test ROC-AUC: 0.8557
DEBUG - 07/09/25 20:09:50 - 0:30:09 - Epoch 91
INFO - 07/09/25 20:10:09 - 0:30:28 - Epoch 92/100 | Step 3404 |  Avg Test Loss: 4.8738 | Test ROC-AUC: 0.8715
DEBUG - 07/09/25 20:10:09 - 0:30:28 - Epoch 92
INFO - 07/09/25 20:10:28 - 0:30:47 - Epoch 93/100 | Step 3441 |  Avg Test Loss: 5.4217 | Test ROC-AUC: 0.8717
DEBUG - 07/09/25 20:10:28 - 0:30:47 - Epoch 93
INFO - 07/09/25 20:10:47 - 0:31:06 - Epoch 94/100 | Step 3478 |  Avg Test Loss: 5.3404 | Test ROC-AUC: 0.8668
DEBUG - 07/09/25 20:10:47 - 0:31:06 - Epoch 94
INFO - 07/09/25 20:11:06 - 0:31:25 - Epoch 95/100 | Step 3515 |  Avg Test Loss: 5.5324 | Test ROC-AUC: 0.8689
DEBUG - 07/09/25 20:11:06 - 0:31:25 - Epoch 95
INFO - 07/09/25 20:11:25 - 0:31:44 - Epoch 96/100 | Step 3552 |  Avg Test Loss: 4.9799 | Test ROC-AUC: 0.8719
DEBUG - 07/09/25 20:11:26 - 0:31:45 - Epoch 96
INFO - 07/09/25 20:11:45 - 0:32:04 - Epoch 97/100 | Step 3589 |  Avg Test Loss: 5.1627 | Test ROC-AUC: 0.8640
DEBUG - 07/09/25 20:11:45 - 0:32:04 - Epoch 97
INFO - 07/09/25 20:12:04 - 0:32:23 - Epoch 98/100 | Step 3626 |  Avg Test Loss: 5.0908 | Test ROC-AUC: 0.8619
DEBUG - 07/09/25 20:12:04 - 0:32:23 - Epoch 98
INFO - 07/09/25 20:12:25 - 0:32:44 - Epoch 99/100 | Step 3663 |  Avg Test Loss: 4.9016 | Test ROC-AUC: 0.8736
DEBUG - 07/09/25 20:12:25 - 0:32:44 - Epoch 99
INFO - 07/09/25 20:12:45 - 0:33:04 - Epoch 100/100 | Step 3700 |  Avg Test Loss: 4.7814 | Test ROC-AUC: 0.8706
INFO - 07/09/25 20:15:03 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 20:15:03 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 100
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: /home/cassie/macfrag/data/bace/bace-scaffold-1.npy
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.9, 0.1, 0.0]
                                     split_type: predetermined
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: 0
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     valid_fold_index: 1
                                     warmup_epochs: 2.0
INFO - 07/09/25 20:15:03 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 20:15:03 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 20:15:03 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 20:15:03 - 0:00:00 - Loading data
DEBUG - 07/09/25 20:15:03 - 0:00:00 - Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.44876033]), array([1210])), (array([0.45033113]), array([151])), (array([0.52631579]), array([152]))]
DEBUG - 07/09/25 20:15:03 - 0:00:00 - Total size = 1513
DEBUG - 07/09/25 20:15:03 - 0:00:00 - Building model 0
DEBUG - 07/09/25 20:15:05 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 20:15:05 - 0:00:02 - Number of M1 parameters = 4,254,754
DEBUG - 07/09/25 20:15:05 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 20:15:05 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 20:15:05 - 0:00:02 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 20:15:05 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 20:15:05 - 0:00:02 - Epoch 0
INFO - 07/09/25 20:15:26 - 0:00:23 - Epoch 1/100 | Step 37 |  Avg Test Loss: 19.9960 | Test ROC-AUC: 0.5726
DEBUG - 07/09/25 20:15:26 - 0:00:23 - Epoch 1
INFO - 07/09/25 20:15:46 - 0:00:43 - Epoch 2/100 | Step 74 |  Avg Test Loss: 14.9964 | Test ROC-AUC: 0.6121
DEBUG - 07/09/25 20:15:46 - 0:00:43 - Epoch 2
INFO - 07/09/25 20:16:06 - 0:01:02 - Epoch 3/100 | Step 111 |  Avg Test Loss: 13.6897 | Test ROC-AUC: 0.6301
DEBUG - 07/09/25 20:16:06 - 0:01:02 - Epoch 3
INFO - 07/09/25 20:16:25 - 0:01:22 - Epoch 4/100 | Step 148 |  Avg Test Loss: 13.1181 | Test ROC-AUC: 0.6386
DEBUG - 07/09/25 20:16:25 - 0:01:22 - Epoch 4
INFO - 07/09/25 20:16:45 - 0:01:42 - Epoch 5/100 | Step 185 |  Avg Test Loss: 12.7248 | Test ROC-AUC: 0.6631
DEBUG - 07/09/25 20:16:45 - 0:01:42 - Epoch 5
INFO - 07/09/25 20:17:05 - 0:02:02 - Epoch 6/100 | Step 222 |  Avg Test Loss: 12.3273 | Test ROC-AUC: 0.6841
DEBUG - 07/09/25 20:17:05 - 0:02:02 - Epoch 6
INFO - 07/09/25 20:17:25 - 0:02:22 - Epoch 7/100 | Step 259 |  Avg Test Loss: 12.2891 | Test ROC-AUC: 0.6935
DEBUG - 07/09/25 20:17:25 - 0:02:22 - Epoch 7
INFO - 07/09/25 20:17:46 - 0:02:42 - Epoch 8/100 | Step 296 |  Avg Test Loss: 11.7214 | Test ROC-AUC: 0.6919
DEBUG - 07/09/25 20:17:46 - 0:02:42 - Epoch 8
INFO - 07/09/25 20:18:05 - 0:03:02 - Epoch 9/100 | Step 333 |  Avg Test Loss: 11.2076 | Test ROC-AUC: 0.7322
DEBUG - 07/09/25 20:18:05 - 0:03:02 - Epoch 9
INFO - 07/09/25 20:18:25 - 0:03:22 - Epoch 10/100 | Step 370 |  Avg Test Loss: 10.8073 | Test ROC-AUC: 0.6957
DEBUG - 07/09/25 20:18:25 - 0:03:22 - Epoch 10
INFO - 07/09/25 20:18:45 - 0:03:42 - Epoch 11/100 | Step 407 |  Avg Test Loss: 10.3320 | Test ROC-AUC: 0.7273
DEBUG - 07/09/25 20:18:45 - 0:03:42 - Epoch 11
INFO - 07/09/25 20:19:05 - 0:04:02 - Epoch 12/100 | Step 444 |  Avg Test Loss: 10.2003 | Test ROC-AUC: 0.7358
DEBUG - 07/09/25 20:19:05 - 0:04:02 - Epoch 12
INFO - 07/09/25 20:19:24 - 0:04:21 - Epoch 13/100 | Step 481 |  Avg Test Loss: 9.2801 | Test ROC-AUC: 0.7487
DEBUG - 07/09/25 20:19:25 - 0:04:21 - Epoch 13
INFO - 07/09/25 20:19:44 - 0:04:41 - Epoch 14/100 | Step 518 |  Avg Test Loss: 8.9075 | Test ROC-AUC: 0.7535
DEBUG - 07/09/25 20:19:44 - 0:04:41 - Epoch 14
INFO - 07/09/25 20:20:04 - 0:05:01 - Epoch 15/100 | Step 555 |  Avg Test Loss: 8.3546 | Test ROC-AUC: 0.7627
DEBUG - 07/09/25 20:20:05 - 0:05:01 - Epoch 15
INFO - 07/09/25 20:20:24 - 0:05:21 - Epoch 16/100 | Step 592 |  Avg Test Loss: 8.1761 | Test ROC-AUC: 0.7582
DEBUG - 07/09/25 20:20:24 - 0:05:21 - Epoch 16
INFO - 07/09/25 20:20:44 - 0:05:41 - Epoch 17/100 | Step 629 |  Avg Test Loss: 7.9741 | Test ROC-AUC: 0.7678
DEBUG - 07/09/25 20:20:44 - 0:05:41 - Epoch 17
INFO - 07/09/25 20:21:03 - 0:06:00 - Epoch 18/100 | Step 666 |  Avg Test Loss: 7.4022 | Test ROC-AUC: 0.7676
DEBUG - 07/09/25 20:21:04 - 0:06:00 - Epoch 18
INFO - 07/09/25 20:21:23 - 0:06:20 - Epoch 19/100 | Step 703 |  Avg Test Loss: 7.0651 | Test ROC-AUC: 0.7816
DEBUG - 07/09/25 20:21:23 - 0:06:20 - Epoch 19
INFO - 07/09/25 20:21:42 - 0:06:39 - Epoch 20/100 | Step 740 |  Avg Test Loss: 7.1894 | Test ROC-AUC: 0.7992
DEBUG - 07/09/25 20:21:42 - 0:06:39 - Epoch 20
INFO - 07/09/25 20:22:02 - 0:06:59 - Epoch 21/100 | Step 777 |  Avg Test Loss: 7.4544 | Test ROC-AUC: 0.7868
DEBUG - 07/09/25 20:22:02 - 0:06:59 - Epoch 21
INFO - 07/09/25 20:22:22 - 0:07:18 - Epoch 22/100 | Step 814 |  Avg Test Loss: 6.9199 | Test ROC-AUC: 0.8179
DEBUG - 07/09/25 20:22:22 - 0:07:19 - Epoch 22
INFO - 07/09/25 20:22:42 - 0:07:38 - Epoch 23/100 | Step 851 |  Avg Test Loss: 6.1786 | Test ROC-AUC: 0.8185
DEBUG - 07/09/25 20:22:42 - 0:07:38 - Epoch 23
INFO - 07/09/25 20:23:01 - 0:07:58 - Epoch 24/100 | Step 888 |  Avg Test Loss: 6.3554 | Test ROC-AUC: 0.8230
DEBUG - 07/09/25 20:23:01 - 0:07:58 - Epoch 24
INFO - 07/09/25 20:23:21 - 0:08:18 - Epoch 25/100 | Step 925 |  Avg Test Loss: 6.1087 | Test ROC-AUC: 0.8237
DEBUG - 07/09/25 20:23:21 - 0:08:18 - Epoch 25
INFO - 07/09/25 20:23:41 - 0:08:38 - Epoch 26/100 | Step 962 |  Avg Test Loss: 6.6689 | Test ROC-AUC: 0.8230
DEBUG - 07/09/25 20:23:41 - 0:08:38 - Epoch 26
INFO - 07/09/25 20:24:01 - 0:08:57 - Epoch 27/100 | Step 999 |  Avg Test Loss: 6.0541 | Test ROC-AUC: 0.8369
DEBUG - 07/09/25 20:24:01 - 0:08:57 - Epoch 27
INFO - 07/09/25 20:24:20 - 0:09:17 - Epoch 28/100 | Step 1036 |  Avg Test Loss: 6.0904 | Test ROC-AUC: 0.8288
DEBUG - 07/09/25 20:24:20 - 0:09:17 - Epoch 28
INFO - 07/09/25 20:24:41 - 0:09:37 - Epoch 29/100 | Step 1073 |  Avg Test Loss: 6.1923 | Test ROC-AUC: 0.8324
DEBUG - 07/09/25 20:24:41 - 0:09:38 - Epoch 29
INFO - 07/09/25 20:25:00 - 0:09:57 - Epoch 30/100 | Step 1110 |  Avg Test Loss: 5.9445 | Test ROC-AUC: 0.8370
DEBUG - 07/09/25 20:25:00 - 0:09:57 - Epoch 30
INFO - 07/09/25 20:25:20 - 0:10:17 - Epoch 31/100 | Step 1147 |  Avg Test Loss: 5.5997 | Test ROC-AUC: 0.8490
DEBUG - 07/09/25 20:25:20 - 0:10:17 - Epoch 31
INFO - 07/09/25 20:25:40 - 0:10:37 - Epoch 32/100 | Step 1184 |  Avg Test Loss: 5.6138 | Test ROC-AUC: 0.8414
DEBUG - 07/09/25 20:25:40 - 0:10:37 - Epoch 32
INFO - 07/09/25 20:26:00 - 0:10:56 - Epoch 33/100 | Step 1221 |  Avg Test Loss: 5.5366 | Test ROC-AUC: 0.8474
DEBUG - 07/09/25 20:26:00 - 0:10:56 - Epoch 33
INFO - 07/09/25 20:26:19 - 0:11:16 - Epoch 34/100 | Step 1258 |  Avg Test Loss: 5.5317 | Test ROC-AUC: 0.8471
DEBUG - 07/09/25 20:26:20 - 0:11:16 - Epoch 34
INFO - 07/09/25 20:26:39 - 0:11:36 - Epoch 35/100 | Step 1295 |  Avg Test Loss: 5.6481 | Test ROC-AUC: 0.8436
DEBUG - 07/09/25 20:26:39 - 0:11:36 - Epoch 35
INFO - 07/09/25 20:26:59 - 0:11:56 - Epoch 36/100 | Step 1332 |  Avg Test Loss: 5.4068 | Test ROC-AUC: 0.8471
DEBUG - 07/09/25 20:26:59 - 0:11:56 - Epoch 36
INFO - 07/09/25 20:27:19 - 0:12:16 - Epoch 37/100 | Step 1369 |  Avg Test Loss: 5.5875 | Test ROC-AUC: 0.8405
DEBUG - 07/09/25 20:27:19 - 0:12:16 - Epoch 37
INFO - 07/09/25 20:27:39 - 0:12:36 - Epoch 38/100 | Step 1406 |  Avg Test Loss: 5.4401 | Test ROC-AUC: 0.8390
DEBUG - 07/09/25 20:27:39 - 0:12:36 - Epoch 38
INFO - 07/09/25 20:27:59 - 0:12:56 - Epoch 39/100 | Step 1443 |  Avg Test Loss: 7.2038 | Test ROC-AUC: 0.8456
DEBUG - 07/09/25 20:27:59 - 0:12:56 - Epoch 39
INFO - 07/09/25 20:28:19 - 0:13:16 - Epoch 40/100 | Step 1480 |  Avg Test Loss: 5.5585 | Test ROC-AUC: 0.8555
DEBUG - 07/09/25 20:28:19 - 0:13:16 - Epoch 40
INFO - 07/09/25 20:28:39 - 0:13:36 - Epoch 41/100 | Step 1517 |  Avg Test Loss: 5.5833 | Test ROC-AUC: 0.8442
DEBUG - 07/09/25 20:28:39 - 0:13:36 - Epoch 41
INFO - 07/09/25 20:28:59 - 0:13:56 - Epoch 42/100 | Step 1554 |  Avg Test Loss: 5.5253 | Test ROC-AUC: 0.8469
DEBUG - 07/09/25 20:28:59 - 0:13:56 - Epoch 42
INFO - 07/09/25 20:29:19 - 0:14:16 - Epoch 43/100 | Step 1591 |  Avg Test Loss: 5.7915 | Test ROC-AUC: 0.8512
DEBUG - 07/09/25 20:29:19 - 0:14:16 - Epoch 43
INFO - 07/09/25 20:29:39 - 0:14:36 - Epoch 44/100 | Step 1628 |  Avg Test Loss: 5.0576 | Test ROC-AUC: 0.8545
DEBUG - 07/09/25 20:29:39 - 0:14:36 - Epoch 44
INFO - 07/09/25 20:29:59 - 0:14:55 - Epoch 45/100 | Step 1665 |  Avg Test Loss: 5.1409 | Test ROC-AUC: 0.8512
DEBUG - 07/09/25 20:29:59 - 0:14:55 - Epoch 45
INFO - 07/09/25 20:30:18 - 0:15:15 - Epoch 46/100 | Step 1702 |  Avg Test Loss: 5.4351 | Test ROC-AUC: 0.8581
DEBUG - 07/09/25 20:30:18 - 0:15:15 - Epoch 46
INFO - 07/09/25 20:30:38 - 0:15:35 - Epoch 47/100 | Step 1739 |  Avg Test Loss: 5.1562 | Test ROC-AUC: 0.8518
DEBUG - 07/09/25 20:30:38 - 0:15:35 - Epoch 47
INFO - 07/09/25 20:30:58 - 0:15:55 - Epoch 48/100 | Step 1776 |  Avg Test Loss: 5.0953 | Test ROC-AUC: 0.8521
DEBUG - 07/09/25 20:30:58 - 0:15:55 - Epoch 48
INFO - 07/09/25 20:31:18 - 0:16:15 - Epoch 49/100 | Step 1813 |  Avg Test Loss: 4.9315 | Test ROC-AUC: 0.8567
DEBUG - 07/09/25 20:31:18 - 0:16:15 - Epoch 49
INFO - 07/09/25 20:31:38 - 0:16:35 - Epoch 50/100 | Step 1850 |  Avg Test Loss: 5.2615 | Test ROC-AUC: 0.8493
DEBUG - 07/09/25 20:31:38 - 0:16:35 - Epoch 50
INFO - 07/09/25 20:31:58 - 0:16:54 - Epoch 51/100 | Step 1887 |  Avg Test Loss: 4.9125 | Test ROC-AUC: 0.8504
DEBUG - 07/09/25 20:31:58 - 0:16:54 - Epoch 51
INFO - 07/09/25 20:32:18 - 0:17:14 - Epoch 52/100 | Step 1924 |  Avg Test Loss: 4.8929 | Test ROC-AUC: 0.8594
DEBUG - 07/09/25 20:32:18 - 0:17:14 - Epoch 52
INFO - 07/09/25 20:32:38 - 0:17:34 - Epoch 53/100 | Step 1961 |  Avg Test Loss: 5.3795 | Test ROC-AUC: 0.8562
DEBUG - 07/09/25 20:32:38 - 0:17:35 - Epoch 53
INFO - 07/09/25 20:32:58 - 0:17:55 - Epoch 54/100 | Step 1998 |  Avg Test Loss: 5.8104 | Test ROC-AUC: 0.8309
DEBUG - 07/09/25 20:32:58 - 0:17:55 - Epoch 54
INFO - 07/09/25 20:33:18 - 0:18:15 - Epoch 55/100 | Step 2035 |  Avg Test Loss: 4.9362 | Test ROC-AUC: 0.8591
DEBUG - 07/09/25 20:33:18 - 0:18:15 - Epoch 55
INFO - 07/09/25 20:33:38 - 0:18:34 - Epoch 56/100 | Step 2072 |  Avg Test Loss: 5.8491 | Test ROC-AUC: 0.8374
DEBUG - 07/09/25 20:33:38 - 0:18:34 - Epoch 56
INFO - 07/09/25 20:33:57 - 0:18:54 - Epoch 57/100 | Step 2109 |  Avg Test Loss: 5.3436 | Test ROC-AUC: 0.8460
DEBUG - 07/09/25 20:33:57 - 0:18:54 - Epoch 57
INFO - 07/09/25 20:34:17 - 0:19:14 - Epoch 58/100 | Step 2146 |  Avg Test Loss: 5.4526 | Test ROC-AUC: 0.8473
DEBUG - 07/09/25 20:34:17 - 0:19:14 - Epoch 58
INFO - 07/09/25 20:34:38 - 0:19:35 - Epoch 59/100 | Step 2183 |  Avg Test Loss: 5.4757 | Test ROC-AUC: 0.8297
DEBUG - 07/09/25 20:34:38 - 0:19:35 - Epoch 59
INFO - 07/09/25 20:34:58 - 0:19:54 - Epoch 60/100 | Step 2220 |  Avg Test Loss: 5.4731 | Test ROC-AUC: 0.8375
DEBUG - 07/09/25 20:34:58 - 0:19:55 - Epoch 60
INFO - 07/09/25 20:35:17 - 0:20:14 - Epoch 61/100 | Step 2257 |  Avg Test Loss: 4.7588 | Test ROC-AUC: 0.8592
DEBUG - 07/09/25 20:35:17 - 0:20:14 - Epoch 61
INFO - 07/09/25 20:35:37 - 0:20:34 - Epoch 62/100 | Step 2294 |  Avg Test Loss: 5.2315 | Test ROC-AUC: 0.8433
DEBUG - 07/09/25 20:35:37 - 0:20:34 - Epoch 62
INFO - 07/09/25 20:35:57 - 0:20:54 - Epoch 63/100 | Step 2331 |  Avg Test Loss: 5.1760 | Test ROC-AUC: 0.8584
DEBUG - 07/09/25 20:35:57 - 0:20:54 - Epoch 63
INFO - 07/09/25 20:36:17 - 0:21:14 - Epoch 64/100 | Step 2368 |  Avg Test Loss: 4.9878 | Test ROC-AUC: 0.8437
DEBUG - 07/09/25 20:36:17 - 0:21:14 - Epoch 64
INFO - 07/09/25 20:36:36 - 0:21:33 - Epoch 65/100 | Step 2405 |  Avg Test Loss: 5.5663 | Test ROC-AUC: 0.8526
DEBUG - 07/09/25 20:36:36 - 0:21:33 - Epoch 65
INFO - 07/09/25 20:36:56 - 0:21:53 - Epoch 66/100 | Step 2442 |  Avg Test Loss: 5.1940 | Test ROC-AUC: 0.8432
DEBUG - 07/09/25 20:36:56 - 0:21:53 - Epoch 66
INFO - 07/09/25 20:37:16 - 0:22:13 - Epoch 67/100 | Step 2479 |  Avg Test Loss: 4.7731 | Test ROC-AUC: 0.8596
DEBUG - 07/09/25 20:37:16 - 0:22:13 - Epoch 67
INFO - 07/09/25 20:37:35 - 0:22:32 - Epoch 68/100 | Step 2516 |  Avg Test Loss: 5.1386 | Test ROC-AUC: 0.8473
DEBUG - 07/09/25 20:37:35 - 0:22:32 - Epoch 68
INFO - 07/09/25 20:37:54 - 0:22:51 - Epoch 69/100 | Step 2553 |  Avg Test Loss: 5.8642 | Test ROC-AUC: 0.8347
DEBUG - 07/09/25 20:37:54 - 0:22:51 - Epoch 69
INFO - 07/09/25 20:38:13 - 0:23:10 - Epoch 70/100 | Step 2590 |  Avg Test Loss: 5.4106 | Test ROC-AUC: 0.8488
DEBUG - 07/09/25 20:38:13 - 0:23:10 - Epoch 70
INFO - 07/09/25 20:38:32 - 0:23:29 - Epoch 71/100 | Step 2627 |  Avg Test Loss: 4.9192 | Test ROC-AUC: 0.8568
DEBUG - 07/09/25 20:38:32 - 0:23:29 - Epoch 71
INFO - 07/09/25 20:38:51 - 0:23:48 - Epoch 72/100 | Step 2664 |  Avg Test Loss: 4.7700 | Test ROC-AUC: 0.8561
DEBUG - 07/09/25 20:38:51 - 0:23:48 - Epoch 72
INFO - 07/09/25 20:39:10 - 0:24:07 - Epoch 73/100 | Step 2701 |  Avg Test Loss: 5.2811 | Test ROC-AUC: 0.8572
DEBUG - 07/09/25 20:39:10 - 0:24:07 - Epoch 73
INFO - 07/09/25 20:39:30 - 0:24:26 - Epoch 74/100 | Step 2738 |  Avg Test Loss: 4.9868 | Test ROC-AUC: 0.8482
DEBUG - 07/09/25 20:39:30 - 0:24:26 - Epoch 74
INFO - 07/09/25 20:39:49 - 0:24:45 - Epoch 75/100 | Step 2775 |  Avg Test Loss: 5.8399 | Test ROC-AUC: 0.8346
DEBUG - 07/09/25 20:39:49 - 0:24:45 - Epoch 75
INFO - 07/09/25 20:40:08 - 0:25:04 - Epoch 76/100 | Step 2812 |  Avg Test Loss: 4.9330 | Test ROC-AUC: 0.8418
DEBUG - 07/09/25 20:40:08 - 0:25:05 - Epoch 76
INFO - 07/09/25 20:40:27 - 0:25:23 - Epoch 77/100 | Step 2849 |  Avg Test Loss: 5.3459 | Test ROC-AUC: 0.8443
DEBUG - 07/09/25 20:40:27 - 0:25:24 - Epoch 77
INFO - 07/09/25 20:40:46 - 0:25:43 - Epoch 78/100 | Step 2886 |  Avg Test Loss: 5.6551 | Test ROC-AUC: 0.8514
DEBUG - 07/09/25 20:40:46 - 0:25:43 - Epoch 78
INFO - 07/09/25 20:41:05 - 0:26:02 - Epoch 79/100 | Step 2923 |  Avg Test Loss: 5.1989 | Test ROC-AUC: 0.8598
DEBUG - 07/09/25 20:41:05 - 0:26:02 - Epoch 79
INFO - 07/09/25 20:41:24 - 0:26:21 - Epoch 80/100 | Step 2960 |  Avg Test Loss: 4.8935 | Test ROC-AUC: 0.8540
DEBUG - 07/09/25 20:41:24 - 0:26:21 - Epoch 80
INFO - 07/09/25 20:41:43 - 0:26:40 - Epoch 81/100 | Step 2997 |  Avg Test Loss: 4.7201 | Test ROC-AUC: 0.8460
DEBUG - 07/09/25 20:41:43 - 0:26:40 - Epoch 81
INFO - 07/09/25 20:42:02 - 0:26:59 - Epoch 82/100 | Step 3034 |  Avg Test Loss: 4.8906 | Test ROC-AUC: 0.8591
DEBUG - 07/09/25 20:42:02 - 0:26:59 - Epoch 82
INFO - 07/09/25 20:42:21 - 0:27:18 - Epoch 83/100 | Step 3071 |  Avg Test Loss: 5.8187 | Test ROC-AUC: 0.8394
DEBUG - 07/09/25 20:42:21 - 0:27:18 - Epoch 83
INFO - 07/09/25 20:42:40 - 0:27:37 - Epoch 84/100 | Step 3108 |  Avg Test Loss: 4.9681 | Test ROC-AUC: 0.8625
DEBUG - 07/09/25 20:42:40 - 0:27:37 - Epoch 84
INFO - 07/09/25 20:42:59 - 0:27:56 - Epoch 85/100 | Step 3145 |  Avg Test Loss: 5.0730 | Test ROC-AUC: 0.8593
DEBUG - 07/09/25 20:42:59 - 0:27:56 - Epoch 85
INFO - 07/09/25 20:43:18 - 0:28:15 - Epoch 86/100 | Step 3182 |  Avg Test Loss: 4.9645 | Test ROC-AUC: 0.8413
DEBUG - 07/09/25 20:43:18 - 0:28:15 - Epoch 86
INFO - 07/09/25 20:43:37 - 0:28:34 - Epoch 87/100 | Step 3219 |  Avg Test Loss: 5.9926 | Test ROC-AUC: 0.8371
DEBUG - 07/09/25 20:43:37 - 0:28:34 - Epoch 87
INFO - 07/09/25 20:43:56 - 0:28:53 - Epoch 88/100 | Step 3256 |  Avg Test Loss: 4.7769 | Test ROC-AUC: 0.8539
DEBUG - 07/09/25 20:43:56 - 0:28:53 - Epoch 88
INFO - 07/09/25 20:44:15 - 0:29:12 - Epoch 89/100 | Step 3293 |  Avg Test Loss: 5.7116 | Test ROC-AUC: 0.8543
DEBUG - 07/09/25 20:44:15 - 0:29:12 - Epoch 89
INFO - 07/09/25 20:44:34 - 0:29:31 - Epoch 90/100 | Step 3330 |  Avg Test Loss: 5.1843 | Test ROC-AUC: 0.8506
DEBUG - 07/09/25 20:44:35 - 0:29:31 - Epoch 90
INFO - 07/09/25 20:44:53 - 0:29:50 - Epoch 91/100 | Step 3367 |  Avg Test Loss: 4.5433 | Test ROC-AUC: 0.8614
DEBUG - 07/09/25 20:44:54 - 0:29:50 - Epoch 91
INFO - 07/09/25 20:45:13 - 0:30:09 - Epoch 92/100 | Step 3404 |  Avg Test Loss: 5.6945 | Test ROC-AUC: 0.8444
DEBUG - 07/09/25 20:45:13 - 0:30:09 - Epoch 92
INFO - 07/09/25 20:45:32 - 0:30:28 - Epoch 93/100 | Step 3441 |  Avg Test Loss: 5.2541 | Test ROC-AUC: 0.8520
DEBUG - 07/09/25 20:45:32 - 0:30:29 - Epoch 93
INFO - 07/09/25 20:45:51 - 0:30:47 - Epoch 94/100 | Step 3478 |  Avg Test Loss: 5.0225 | Test ROC-AUC: 0.8490
DEBUG - 07/09/25 20:45:51 - 0:30:48 - Epoch 94
INFO - 07/09/25 20:47:10 - 0:00:00 - ============ Initialized logger ============
INFO - 07/09/25 20:47:10 - 0:00:00 - activation: ReLU
                                     add_step: 
                                     atom_dim: 101
                                     atom_messages: True
                                     batch_size: 32
                                     bias: False
                                     bond_dim: 11
                                     checkpoint_dir: None
                                     checkpoint_path: None
                                     checkpoint_paths: None
                                     command: python pretrain.py --exp_id "pretrain"
                                     config_path: None
                                     crossval_index_dir: None
                                     crossval_index_file: None
                                     cuda: True
                                     data_path: /home/cassie/macfrag/data/bace/bace.csv
                                     dataset_type: classification
                                     depth: 3
                                     device: cuda:1
                                     dropout: 0
                                     dump_path: dumped
                                     early_stop: True
                                     encoder_drop_out: 0.1
                                     encoder_head: 4
                                     encoder_name: CMPNN
                                     end_epochs: 100
                                     ensemble_size: 1
                                     epochs: 30
                                     exp_id: pretrain
                                     exp_name: finetune
                                     features_generator: None
                                     features_only: False
                                     features_path: None
                                     features_scaling: True
                                     ffn_drop_out: 0.1
                                     ffn_hidden_size: 500
                                     ffn_num_layers: 2
                                     fg_dim: 73
                                     fg_edge_dim: 101
                                     final_lr: 0.0001
                                     folds_file: /home/cassie/macfrag/data/bace/bace-scaffold-2.npy
                                     gnn_type: gin
                                     gpu: 1
                                     graph_pooling: mean
                                     gru_head: 6
                                     hidden_size: 500
                                     init_lr: 0.0001
                                     latent_dim: 500
                                     log_frequency: 10
                                     logger: True
                                     max_data_size: None
                                     max_lr: 0.001
                                     metric: auc
                                     minimize_score: False
                                     multiclass_num_classes: 3
                                     no_cache: False
                                     num_layers: 3
                                     num_lrs: 1
                                     num_runs: 1
                                     num_tasks: 1
                                     path: /home/cassie/macfrag/data/bace
                                     pretrain: True
                                     quiet: False
                                     runs: 1
                                     save_BRICS_f: False
                                     save_dir: ./ckpt
                                     save_smiles_splits: False
                                     seed: 1
                                     separate_test_features_path: None
                                     separate_test_path: None
                                     separate_train_path: None
                                     separate_val_features_path: None
                                     separate_val_path: None
                                     show_individual_scores: False
                                     split_sizes: [0.9, 0.1, 0.0]
                                     split_type: predetermined
                                     start_epochs: 0
                                     step: 
                                     temperature: 0.1
                                     test: False
                                     test_fold_index: 0
                                     undirected: False
                                     use_compound_names: False
                                     use_input_features: None
                                     val_fold_index: None
                                     valid_fold_index: 1
                                     warmup_epochs: 2.0
INFO - 07/09/25 20:47:10 - 0:00:00 - ========================
                                     # Git Version: None #
                                     ========================
INFO - 07/09/25 20:47:10 - 0:00:00 - The experiment will be stored in dumped/0709-finetune/pretrain
                                     
INFO - 07/09/25 20:47:10 - 0:00:00 - Running command: python pretrain.py

DEBUG - 07/09/25 20:47:10 - 0:00:00 - Loading data
DEBUG - 07/09/25 20:47:11 - 0:00:00 - Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.45041322]), array([1210])), (array([0.54966887]), array([151])), (array([0.41447368]), array([152]))]
DEBUG - 07/09/25 20:47:11 - 0:00:00 - Total size = 1513
DEBUG - 07/09/25 20:47:11 - 0:00:00 - Building model 0
DEBUG - 07/09/25 20:47:12 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): Predictor(
                                          (encoder): HierGnnEncoder(
                                            (graph_gnn): GNN_mol(
                                              (gnns): ModuleList(
                                                (0-2): 3 x GINConv()
                                              )
                                              (norms): ModuleList(
                                                (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              )
                                            )
                                            (fc_gat): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                            )
                                            (fpn): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.2, inplace=False)
                                            )
                                            (attr_embed): Sequential(
                                              (0): Linear(in_features=270, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Dropout(p=0.1, inplace=False)
                                            )
                                            (node_embed): Sequential(
                                              (0): Linear(in_features=210, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (mol_embed): Sequential(
                                              (0): Linear(in_features=1000, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Dropout(p=0, inplace=False)
                                            )
                                            (graph_pred_linear): Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                              (3): Linear(in_features=500, out_features=1, bias=True)
                                            )
                                            (fusion_proj): Linear(in_features=1000, out_features=500, bias=True)
                                            (empty_fusion_proj): Linear(in_features=500, out_features=1000, bias=True)
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 20:47:12 - 0:00:02 - Number of M1 parameters = 4,254,754
DEBUG - 07/09/25 20:47:12 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 20:47:12 - 0:00:02 - MoleculeModel(
                                        (sigmoid): Sigmoid()
                                        (encoder): FragmentGNNEncoder(
                                          (fragment_gnn): FragmentGNN(
                                            (convs): ModuleList(
                                              (0): GATConv(101, 125, heads=4)
                                              (1-2): 2 x GATConv(500, 125, heads=4)
                                            )
                                          )
                                          (encoder): SerGINE(
                                            (fragment_gnn): FragmentGNN(
                                              (convs): ModuleList(
                                                (0): GATConv(101, 125, heads=4)
                                                (1-2): 2 x GATConv(500, 125, heads=4)
                                              )
                                            )
                                            (atom_embedding): Linear(in_features=101, out_features=500, bias=True)
                                            (fg_embedding): Linear(in_features=73, out_features=500, bias=True)
                                            (bond_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=11, out_features=500, bias=True)
                                            )
                                            (fg_edge_embedding): ModuleList(
                                              (0-2): 3 x Linear(in_features=101, out_features=500, bias=True)
                                            )
                                            (atom_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                                (2): ReLU()
                                                (3): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (atom_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (fg_gin): ModuleList(
                                              (0-2): 3 x GINEConv(nn=Sequential(
                                                (0): Linear(in_features=500, out_features=1000, bias=True)
                                                (1): ReLU()
                                                (2): Linear(in_features=1000, out_features=500, bias=True)
                                              ))
                                            )
                                            (fg_bn): ModuleList(
                                              (0-2): 3 x BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                                            )
                                            (atom2fg_lin): Linear(in_features=500, out_features=500, bias=True)
                                            (att_pool): GlobalAttention(gate_nn=Sequential(
                                              (0): Linear(in_features=500, out_features=500, bias=True)
                                              (1): ReLU()
                                              (2): Linear(in_features=500, out_features=1, bias=True)
                                            ), nn=None)
                                            (relu): ReLU()
                                            (dropout): Dropout(p=0, inplace=False)
                                            (fg_fusion): FGAttentionFusion(
                                              (query): Linear(in_features=500, out_features=500, bias=True)
                                              (key): Linear(in_features=500, out_features=500, bias=True)
                                              (value): Linear(in_features=500, out_features=500, bias=True)
                                              (softmax): Softmax(dim=1)
                                            )
                                          )
                                        )
                                        (ffn): Sequential(
                                          (0): Dropout(p=0, inplace=False)
                                          (1): Linear(in_features=500, out_features=250, bias=True)
                                          (2): ReLU()
                                          (3): Dropout(p=0, inplace=False)
                                          (4): Linear(in_features=250, out_features=500, bias=True)
                                        )
                                      )
DEBUG - 07/09/25 20:47:12 - 0:00:02 - Number of M2 parameters = 9,090,251
DEBUG - 07/09/25 20:47:12 - 0:00:02 - Moving model to cuda
DEBUG - 07/09/25 20:47:12 - 0:00:02 - Epoch 0
INFO - 07/09/25 20:47:33 - 0:00:23 - Epoch 1/100 | Step 37 |  Avg Test Loss: 19.9941 | Test ROC-AUC: 0.6510
DEBUG - 07/09/25 20:47:33 - 0:00:23 - Epoch 1
INFO - 07/09/25 20:47:52 - 0:00:42 - Epoch 2/100 | Step 74 |  Avg Test Loss: 14.9965 | Test ROC-AUC: 0.6542
DEBUG - 07/09/25 20:47:52 - 0:00:42 - Epoch 2
INFO - 07/09/25 20:48:12 - 0:01:01 - Epoch 3/100 | Step 111 |  Avg Test Loss: 13.7493 | Test ROC-AUC: 0.6377
DEBUG - 07/09/25 20:48:12 - 0:01:01 - Epoch 3
INFO - 07/09/25 20:48:31 - 0:01:20 - Epoch 4/100 | Step 148 |  Avg Test Loss: 13.0965 | Test ROC-AUC: 0.6607
DEBUG - 07/09/25 20:48:31 - 0:01:21 - Epoch 4
INFO - 07/09/25 20:48:50 - 0:01:40 - Epoch 5/100 | Step 185 |  Avg Test Loss: 12.7687 | Test ROC-AUC: 0.6564
DEBUG - 07/09/25 20:48:50 - 0:01:40 - Epoch 5
INFO - 07/09/25 20:49:09 - 0:01:59 - Epoch 6/100 | Step 222 |  Avg Test Loss: 12.2361 | Test ROC-AUC: 0.7280
DEBUG - 07/09/25 20:49:09 - 0:01:59 - Epoch 6
INFO - 07/09/25 20:49:29 - 0:02:18 - Epoch 7/100 | Step 259 |  Avg Test Loss: 11.7382 | Test ROC-AUC: 0.7383
DEBUG - 07/09/25 20:49:29 - 0:02:18 - Epoch 7
INFO - 07/09/25 20:49:48 - 0:02:37 - Epoch 8/100 | Step 296 |  Avg Test Loss: 11.3553 | Test ROC-AUC: 0.7529
DEBUG - 07/09/25 20:49:48 - 0:02:38 - Epoch 8
INFO - 07/09/25 20:50:07 - 0:02:57 - Epoch 9/100 | Step 333 |  Avg Test Loss: 10.7716 | Test ROC-AUC: 0.7551
DEBUG - 07/09/25 20:50:07 - 0:02:57 - Epoch 9
INFO - 07/09/25 20:50:26 - 0:03:16 - Epoch 10/100 | Step 370 |  Avg Test Loss: 10.3691 | Test ROC-AUC: 0.7381
DEBUG - 07/09/25 20:50:26 - 0:03:16 - Epoch 10
INFO - 07/09/25 20:50:46 - 0:03:35 - Epoch 11/100 | Step 407 |  Avg Test Loss: 9.8482 | Test ROC-AUC: 0.7529
DEBUG - 07/09/25 20:50:46 - 0:03:35 - Epoch 11
INFO - 07/09/25 20:51:05 - 0:03:54 - Epoch 12/100 | Step 444 |  Avg Test Loss: 9.2948 | Test ROC-AUC: 0.7371
DEBUG - 07/09/25 20:51:05 - 0:03:54 - Epoch 12
INFO - 07/09/25 20:51:24 - 0:04:14 - Epoch 13/100 | Step 481 |  Avg Test Loss: 8.9890 | Test ROC-AUC: 0.7488
DEBUG - 07/09/25 20:51:24 - 0:04:14 - Epoch 13
INFO - 07/09/25 20:51:43 - 0:04:33 - Epoch 14/100 | Step 518 |  Avg Test Loss: 8.2419 | Test ROC-AUC: 0.7423
DEBUG - 07/09/25 20:51:43 - 0:04:33 - Epoch 14
INFO - 07/09/25 20:52:03 - 0:04:52 - Epoch 15/100 | Step 555 |  Avg Test Loss: 7.9435 | Test ROC-AUC: 0.7366
DEBUG - 07/09/25 20:52:03 - 0:04:52 - Epoch 15
INFO - 07/09/25 20:52:22 - 0:05:12 - Epoch 16/100 | Step 592 |  Avg Test Loss: 7.8005 | Test ROC-AUC: 0.7487
DEBUG - 07/09/25 20:52:22 - 0:05:12 - Epoch 16
INFO - 07/09/25 20:52:41 - 0:05:31 - Epoch 17/100 | Step 629 |  Avg Test Loss: 7.0951 | Test ROC-AUC: 0.7411
DEBUG - 07/09/25 20:52:41 - 0:05:31 - Epoch 17
INFO - 07/09/25 20:53:01 - 0:05:50 - Epoch 18/100 | Step 666 |  Avg Test Loss: 6.8908 | Test ROC-AUC: 0.7485
DEBUG - 07/09/25 20:53:01 - 0:05:50 - Epoch 18
INFO - 07/09/25 20:53:20 - 0:06:09 - Epoch 19/100 | Step 703 |  Avg Test Loss: 6.7274 | Test ROC-AUC: 0.7557
DEBUG - 07/09/25 20:53:20 - 0:06:09 - Epoch 19
INFO - 07/09/25 20:53:39 - 0:06:29 - Epoch 20/100 | Step 740 |  Avg Test Loss: 6.4486 | Test ROC-AUC: 0.7539
DEBUG - 07/09/25 20:53:39 - 0:06:29 - Epoch 20
INFO - 07/09/25 20:53:58 - 0:06:48 - Epoch 21/100 | Step 777 |  Avg Test Loss: 6.4476 | Test ROC-AUC: 0.7668
DEBUG - 07/09/25 20:53:58 - 0:06:48 - Epoch 21
INFO - 07/09/25 20:54:18 - 0:07:07 - Epoch 22/100 | Step 814 |  Avg Test Loss: 6.4383 | Test ROC-AUC: 0.7613
DEBUG - 07/09/25 20:54:18 - 0:07:07 - Epoch 22
INFO - 07/09/25 20:54:37 - 0:07:26 - Epoch 23/100 | Step 851 |  Avg Test Loss: 6.3488 | Test ROC-AUC: 0.7686
DEBUG - 07/09/25 20:54:37 - 0:07:27 - Epoch 23
INFO - 07/09/25 20:54:56 - 0:07:46 - Epoch 24/100 | Step 888 |  Avg Test Loss: 6.2104 | Test ROC-AUC: 0.7752
DEBUG - 07/09/25 20:54:56 - 0:07:46 - Epoch 24
INFO - 07/09/25 20:55:15 - 0:08:05 - Epoch 25/100 | Step 925 |  Avg Test Loss: 6.1883 | Test ROC-AUC: 0.7884
DEBUG - 07/09/25 20:55:16 - 0:08:05 - Epoch 25
INFO - 07/09/25 20:55:35 - 0:08:24 - Epoch 26/100 | Step 962 |  Avg Test Loss: 6.0213 | Test ROC-AUC: 0.7903
DEBUG - 07/09/25 20:55:35 - 0:08:24 - Epoch 26
INFO - 07/09/25 20:55:54 - 0:08:44 - Epoch 27/100 | Step 999 |  Avg Test Loss: 6.0943 | Test ROC-AUC: 0.7907
DEBUG - 07/09/25 20:55:54 - 0:08:44 - Epoch 27
INFO - 07/09/25 20:56:13 - 0:09:03 - Epoch 28/100 | Step 1036 |  Avg Test Loss: 6.3119 | Test ROC-AUC: 0.7929
DEBUG - 07/09/25 20:56:13 - 0:09:03 - Epoch 28
INFO - 07/09/25 20:56:32 - 0:09:22 - Epoch 29/100 | Step 1073 |  Avg Test Loss: 6.3673 | Test ROC-AUC: 0.7873
DEBUG - 07/09/25 20:56:33 - 0:09:22 - Epoch 29
INFO - 07/09/25 20:56:52 - 0:09:41 - Epoch 30/100 | Step 1110 |  Avg Test Loss: 5.9400 | Test ROC-AUC: 0.8049
DEBUG - 07/09/25 20:56:52 - 0:09:41 - Epoch 30
INFO - 07/09/25 20:57:11 - 0:10:01 - Epoch 31/100 | Step 1147 |  Avg Test Loss: 6.0192 | Test ROC-AUC: 0.8041
DEBUG - 07/09/25 20:57:11 - 0:10:01 - Epoch 31
INFO - 07/09/25 20:57:30 - 0:10:20 - Epoch 32/100 | Step 1184 |  Avg Test Loss: 5.7452 | Test ROC-AUC: 0.7995
DEBUG - 07/09/25 20:57:30 - 0:10:20 - Epoch 32
INFO - 07/09/25 20:57:49 - 0:10:39 - Epoch 33/100 | Step 1221 |  Avg Test Loss: 5.5733 | Test ROC-AUC: 0.8026
DEBUG - 07/09/25 20:57:50 - 0:10:39 - Epoch 33
INFO - 07/09/25 20:58:09 - 0:10:58 - Epoch 34/100 | Step 1258 |  Avg Test Loss: 6.0364 | Test ROC-AUC: 0.8198
DEBUG - 07/09/25 20:58:09 - 0:10:58 - Epoch 34
INFO - 07/09/25 20:58:28 - 0:11:18 - Epoch 35/100 | Step 1295 |  Avg Test Loss: 5.9195 | Test ROC-AUC: 0.8067
DEBUG - 07/09/25 20:58:28 - 0:11:18 - Epoch 35
INFO - 07/09/25 20:58:47 - 0:11:37 - Epoch 36/100 | Step 1332 |  Avg Test Loss: 5.1976 | Test ROC-AUC: 0.8055
DEBUG - 07/09/25 20:58:47 - 0:11:37 - Epoch 36
INFO - 07/09/25 20:59:07 - 0:11:56 - Epoch 37/100 | Step 1369 |  Avg Test Loss: 5.2482 | Test ROC-AUC: 0.8199
DEBUG - 07/09/25 20:59:07 - 0:11:56 - Epoch 37
INFO - 07/09/25 20:59:26 - 0:12:15 - Epoch 38/100 | Step 1406 |  Avg Test Loss: 5.5295 | Test ROC-AUC: 0.8237
DEBUG - 07/09/25 20:59:26 - 0:12:15 - Epoch 38
INFO - 07/09/25 20:59:45 - 0:12:35 - Epoch 39/100 | Step 1443 |  Avg Test Loss: 5.2762 | Test ROC-AUC: 0.8305
DEBUG - 07/09/25 20:59:45 - 0:12:35 - Epoch 39
INFO - 07/09/25 21:00:04 - 0:12:54 - Epoch 40/100 | Step 1480 |  Avg Test Loss: 5.3141 | Test ROC-AUC: 0.8295
DEBUG - 07/09/25 21:00:04 - 0:12:54 - Epoch 40
INFO - 07/09/25 21:00:24 - 0:13:13 - Epoch 41/100 | Step 1517 |  Avg Test Loss: 5.4956 | Test ROC-AUC: 0.8133
DEBUG - 07/09/25 21:00:24 - 0:13:13 - Epoch 41
INFO - 07/09/25 21:00:43 - 0:13:32 - Epoch 42/100 | Step 1554 |  Avg Test Loss: 5.0566 | Test ROC-AUC: 0.8248
DEBUG - 07/09/25 21:00:43 - 0:13:32 - Epoch 42
INFO - 07/09/25 21:01:02 - 0:13:52 - Epoch 43/100 | Step 1591 |  Avg Test Loss: 5.2892 | Test ROC-AUC: 0.8299
DEBUG - 07/09/25 21:01:02 - 0:13:52 - Epoch 43
INFO - 07/09/25 21:01:21 - 0:14:11 - Epoch 44/100 | Step 1628 |  Avg Test Loss: 4.9283 | Test ROC-AUC: 0.8352
DEBUG - 07/09/25 21:01:21 - 0:14:11 - Epoch 44
INFO - 07/09/25 21:01:41 - 0:14:30 - Epoch 45/100 | Step 1665 |  Avg Test Loss: 4.9026 | Test ROC-AUC: 0.8345
DEBUG - 07/09/25 21:01:41 - 0:14:30 - Epoch 45
INFO - 07/09/25 21:02:00 - 0:14:49 - Epoch 46/100 | Step 1702 |  Avg Test Loss: 5.0502 | Test ROC-AUC: 0.8307
DEBUG - 07/09/25 21:02:00 - 0:14:49 - Epoch 46
INFO - 07/09/25 21:02:19 - 0:15:09 - Epoch 47/100 | Step 1739 |  Avg Test Loss: 5.1095 | Test ROC-AUC: 0.8337
DEBUG - 07/09/25 21:02:19 - 0:15:09 - Epoch 47
INFO - 07/09/25 21:02:38 - 0:15:28 - Epoch 48/100 | Step 1776 |  Avg Test Loss: 5.0318 | Test ROC-AUC: 0.8394
DEBUG - 07/09/25 21:02:38 - 0:15:28 - Epoch 48
INFO - 07/09/25 21:02:58 - 0:15:47 - Epoch 49/100 | Step 1813 |  Avg Test Loss: 4.8549 | Test ROC-AUC: 0.8380
DEBUG - 07/09/25 21:02:58 - 0:15:47 - Epoch 49
INFO - 07/09/25 21:03:17 - 0:16:06 - Epoch 50/100 | Step 1850 |  Avg Test Loss: 4.7038 | Test ROC-AUC: 0.8473
DEBUG - 07/09/25 21:03:17 - 0:16:06 - Epoch 50
INFO - 07/09/25 21:03:36 - 0:16:26 - Epoch 51/100 | Step 1887 |  Avg Test Loss: 4.8227 | Test ROC-AUC: 0.8369
DEBUG - 07/09/25 21:03:36 - 0:16:26 - Epoch 51
INFO - 07/09/25 21:03:55 - 0:16:45 - Epoch 52/100 | Step 1924 |  Avg Test Loss: 4.9546 | Test ROC-AUC: 0.8482
DEBUG - 07/09/25 21:03:55 - 0:16:45 - Epoch 52
INFO - 07/09/25 21:04:15 - 0:17:04 - Epoch 53/100 | Step 1961 |  Avg Test Loss: 5.0240 | Test ROC-AUC: 0.8422
DEBUG - 07/09/25 21:04:15 - 0:17:04 - Epoch 53
INFO - 07/09/25 21:04:34 - 0:17:23 - Epoch 54/100 | Step 1998 |  Avg Test Loss: 4.6421 | Test ROC-AUC: 0.8453
DEBUG - 07/09/25 21:04:34 - 0:17:24 - Epoch 54
INFO - 07/09/25 21:04:53 - 0:17:43 - Epoch 55/100 | Step 2035 |  Avg Test Loss: 5.2643 | Test ROC-AUC: 0.8545
DEBUG - 07/09/25 21:04:53 - 0:17:43 - Epoch 55
INFO - 07/09/25 21:05:12 - 0:18:02 - Epoch 56/100 | Step 2072 |  Avg Test Loss: 4.7144 | Test ROC-AUC: 0.8468
DEBUG - 07/09/25 21:05:13 - 0:18:02 - Epoch 56
INFO - 07/09/25 21:05:32 - 0:18:21 - Epoch 57/100 | Step 2109 |  Avg Test Loss: 5.6047 | Test ROC-AUC: 0.8501
DEBUG - 07/09/25 21:05:32 - 0:18:21 - Epoch 57
INFO - 07/09/25 21:05:51 - 0:18:40 - Epoch 58/100 | Step 2146 |  Avg Test Loss: 4.8950 | Test ROC-AUC: 0.8508
DEBUG - 07/09/25 21:05:51 - 0:18:41 - Epoch 58
INFO - 07/09/25 21:06:10 - 0:19:00 - Epoch 59/100 | Step 2183 |  Avg Test Loss: 4.8998 | Test ROC-AUC: 0.8397
DEBUG - 07/09/25 21:06:10 - 0:19:00 - Epoch 59
INFO - 07/09/25 21:06:30 - 0:19:19 - Epoch 60/100 | Step 2220 |  Avg Test Loss: 5.0597 | Test ROC-AUC: 0.8501
DEBUG - 07/09/25 21:06:30 - 0:19:19 - Epoch 60
INFO - 07/09/25 21:06:49 - 0:19:38 - Epoch 61/100 | Step 2257 |  Avg Test Loss: 4.5467 | Test ROC-AUC: 0.8460
DEBUG - 07/09/25 21:06:49 - 0:19:38 - Epoch 61
INFO - 07/09/25 21:07:08 - 0:19:58 - Epoch 62/100 | Step 2294 |  Avg Test Loss: 4.4306 | Test ROC-AUC: 0.8563
DEBUG - 07/09/25 21:07:08 - 0:19:58 - Epoch 62
INFO - 07/09/25 21:07:27 - 0:20:17 - Epoch 63/100 | Step 2331 |  Avg Test Loss: 4.3738 | Test ROC-AUC: 0.8545
DEBUG - 07/09/25 21:07:27 - 0:20:17 - Epoch 63
INFO - 07/09/25 21:07:47 - 0:20:36 - Epoch 64/100 | Step 2368 |  Avg Test Loss: 4.3856 | Test ROC-AUC: 0.8542
DEBUG - 07/09/25 21:07:47 - 0:20:36 - Epoch 64
INFO - 07/09/25 21:08:06 - 0:20:55 - Epoch 65/100 | Step 2405 |  Avg Test Loss: 4.6973 | Test ROC-AUC: 0.8498
DEBUG - 07/09/25 21:08:06 - 0:20:56 - Epoch 65
INFO - 07/09/25 21:08:25 - 0:21:15 - Epoch 66/100 | Step 2442 |  Avg Test Loss: 4.9694 | Test ROC-AUC: 0.8581
DEBUG - 07/09/25 21:08:25 - 0:21:15 - Epoch 66
INFO - 07/09/25 21:08:44 - 0:21:34 - Epoch 67/100 | Step 2479 |  Avg Test Loss: 5.7660 | Test ROC-AUC: 0.8548
DEBUG - 07/09/25 21:08:44 - 0:21:34 - Epoch 67
INFO - 07/09/25 21:09:04 - 0:21:53 - Epoch 68/100 | Step 2516 |  Avg Test Loss: 4.9715 | Test ROC-AUC: 0.8475
DEBUG - 07/09/25 21:09:04 - 0:21:53 - Epoch 68
INFO - 07/09/25 21:09:23 - 0:22:13 - Epoch 69/100 | Step 2553 |  Avg Test Loss: 5.0414 | Test ROC-AUC: 0.8588
DEBUG - 07/09/25 21:09:23 - 0:22:13 - Epoch 69
INFO - 07/09/25 21:09:42 - 0:22:32 - Epoch 70/100 | Step 2590 |  Avg Test Loss: 5.2375 | Test ROC-AUC: 0.8511
DEBUG - 07/09/25 21:09:42 - 0:22:32 - Epoch 70
INFO - 07/09/25 21:10:01 - 0:22:51 - Epoch 71/100 | Step 2627 |  Avg Test Loss: 4.8643 | Test ROC-AUC: 0.8466
DEBUG - 07/09/25 21:10:02 - 0:22:51 - Epoch 71
INFO - 07/09/25 21:10:21 - 0:23:10 - Epoch 72/100 | Step 2664 |  Avg Test Loss: 4.7829 | Test ROC-AUC: 0.8583
DEBUG - 07/09/25 21:10:21 - 0:23:10 - Epoch 72
INFO - 07/09/25 21:10:40 - 0:23:30 - Epoch 73/100 | Step 2701 |  Avg Test Loss: 4.5893 | Test ROC-AUC: 0.8570
DEBUG - 07/09/25 21:10:40 - 0:23:30 - Epoch 73
INFO - 07/09/25 21:10:59 - 0:23:49 - Epoch 74/100 | Step 2738 |  Avg Test Loss: 4.5668 | Test ROC-AUC: 0.8614
DEBUG - 07/09/25 21:10:59 - 0:23:49 - Epoch 74
INFO - 07/09/25 21:11:18 - 0:24:08 - Epoch 75/100 | Step 2775 |  Avg Test Loss: 4.6257 | Test ROC-AUC: 0.8611
DEBUG - 07/09/25 21:11:19 - 0:24:08 - Epoch 75
INFO - 07/09/25 21:11:38 - 0:24:27 - Epoch 76/100 | Step 2812 |  Avg Test Loss: 4.4906 | Test ROC-AUC: 0.8538
DEBUG - 07/09/25 21:11:38 - 0:24:27 - Epoch 76
INFO - 07/09/25 21:11:57 - 0:24:47 - Epoch 77/100 | Step 2849 |  Avg Test Loss: 4.6212 | Test ROC-AUC: 0.8658
DEBUG - 07/09/25 21:11:57 - 0:24:47 - Epoch 77
INFO - 07/09/25 21:12:16 - 0:25:06 - Epoch 78/100 | Step 2886 |  Avg Test Loss: 5.1936 | Test ROC-AUC: 0.8503
DEBUG - 07/09/25 21:12:16 - 0:25:06 - Epoch 78
INFO - 07/09/25 21:12:36 - 0:25:25 - Epoch 79/100 | Step 2923 |  Avg Test Loss: 4.9145 | Test ROC-AUC: 0.8589
DEBUG - 07/09/25 21:12:36 - 0:25:25 - Epoch 79
INFO - 07/09/25 21:12:55 - 0:25:44 - Epoch 80/100 | Step 2960 |  Avg Test Loss: 4.6936 | Test ROC-AUC: 0.8533
DEBUG - 07/09/25 21:12:55 - 0:25:45 - Epoch 80
INFO - 07/09/25 21:13:14 - 0:26:04 - Epoch 81/100 | Step 2997 |  Avg Test Loss: 4.6183 | Test ROC-AUC: 0.8569
DEBUG - 07/09/25 21:13:14 - 0:26:04 - Epoch 81
INFO - 07/09/25 21:13:34 - 0:26:23 - Epoch 82/100 | Step 3034 |  Avg Test Loss: 4.5230 | Test ROC-AUC: 0.8512
DEBUG - 07/09/25 21:13:34 - 0:26:23 - Epoch 82
INFO - 07/09/25 21:13:53 - 0:26:42 - Epoch 83/100 | Step 3071 |  Avg Test Loss: 4.3853 | Test ROC-AUC: 0.8610
DEBUG - 07/09/25 21:13:53 - 0:26:42 - Epoch 83
INFO - 07/09/25 21:14:12 - 0:27:02 - Epoch 84/100 | Step 3108 |  Avg Test Loss: 4.6219 | Test ROC-AUC: 0.8517
DEBUG - 07/09/25 21:14:12 - 0:27:02 - Epoch 84
INFO - 07/09/25 21:14:31 - 0:27:21 - Epoch 85/100 | Step 3145 |  Avg Test Loss: 4.2112 | Test ROC-AUC: 0.8658
DEBUG - 07/09/25 21:14:31 - 0:27:21 - Epoch 85
INFO - 07/09/25 21:14:51 - 0:27:40 - Epoch 86/100 | Step 3182 |  Avg Test Loss: 5.1985 | Test ROC-AUC: 0.8522
DEBUG - 07/09/25 21:14:51 - 0:27:40 - Epoch 86
INFO - 07/09/25 21:15:10 - 0:27:59 - Epoch 87/100 | Step 3219 |  Avg Test Loss: 4.5021 | Test ROC-AUC: 0.8574
DEBUG - 07/09/25 21:15:10 - 0:27:59 - Epoch 87
INFO - 07/09/25 21:15:29 - 0:28:19 - Epoch 88/100 | Step 3256 |  Avg Test Loss: 4.4308 | Test ROC-AUC: 0.8486
DEBUG - 07/09/25 21:15:29 - 0:28:19 - Epoch 88
INFO - 07/09/25 21:15:48 - 0:28:38 - Epoch 89/100 | Step 3293 |  Avg Test Loss: 4.6180 | Test ROC-AUC: 0.8611
DEBUG - 07/09/25 21:15:48 - 0:28:38 - Epoch 89
INFO - 07/09/25 21:16:08 - 0:28:57 - Epoch 90/100 | Step 3330 |  Avg Test Loss: 4.4589 | Test ROC-AUC: 0.8597
DEBUG - 07/09/25 21:16:08 - 0:28:57 - Epoch 90
